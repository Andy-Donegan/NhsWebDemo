"use strict";import DataTable from"./DataTable.js";import U from"../Core/Utilities.js";var defined=U.defined,uniqueKey=U.uniqueKey,DataSeriesConverter=function(){function e(e,t){void 0===e&&(e=new DataTable),void 0===t&&(t={}),this.table=e,this.options=t,this.seriesIdMap={},this.seriesMeta=[]}return e.prototype.getSeriesData=function(e){var t,i=this.table,s=[];if(e)for(var r=this.seriesIdMap[e].pointArrayMap||["y"],o=0,a=i.getRowCount();o<a;o++){for(var n=!1,d={x:i.getCellAsNumber("x",o,!0)},p=0,f=r.length;p<f;p++)t=r[p]+"_"+e,void 0!==i.getCell(t,o)&&(n=!0,d[r[p]]=i.getCellAsNumber(t,o));n&&s.push(d)}return s},e.prototype.getAllSeriesData=function(){for(var e,t=this,i=[],s=0,r=t.seriesMeta.length;s<r;s++)e=t.seriesMeta[s].id,i.push({id:e,data:t.getSeriesData(e)});return i},e.prototype.updateTable=function(e,t){var i,s,r,o,a,n,d,p,f,l,h,u,y,x,g,v=this.table;if(e&&e.length){this.options.seriesOptions=[],this.seriesMeta=[],this.seriesIdMap={};for(var M=0,b=e.length;M<b;M++){(s=e[M]).id=defined(s.id)?s.id:uniqueKey(),x="_"+s.id,a=(o=s.pointArrayMap||["y"]).length,n=s.options.keys,d=s.options.data||[],r={id:s.id,pointArrayMap:o,options:s.options},this.options.seriesOptions.push(s.options),this.seriesMeta.push(r),this.seriesIdMap[s.id]=r;for(var c=0,O=d.length;c<O;c++){if(f="y"+x,i={},l=1<a,"number"==typeof(p=d[c]))i[f]=p,i.x=c;else if(p instanceof Array){if(g=n&&-1<n.indexOf("x")?n.indexOf("x"):0,h=n&&-1<n.indexOf("y")?n.indexOf("y"):1,l)for(var C=0;C<a;C++)y=n&&-1<n.indexOf(o[C])?n.indexOf(o[C]):C+p.length-a,i[(u=o[C])+x]=p[y];else i[f]=p[h];i.x=0<p.length-a?p[g]:c}else if(p instanceof Object){if(l)for(var D=p,C=0;C<a;C++)i[(u=o[C])+x]=D[u];else i[f]=p.y;i.x=p.x||c}g=""+i.x,(l=v.getRowIndexBy("id",g))?i[f]&&v.setCell(f,l,i[f],t):(i.id=g,v.setRows([i],void 0,t))}}}},e}();export default DataSeriesConverter;