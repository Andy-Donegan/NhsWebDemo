"use strict";import DataPromise from"../DataPromise.js";import U from"../../Core/Utilities.js";var addEvent=U.addEvent,fireEvent=U.fireEvent,merge=U.merge,DataModifier=function(){function i(){}return i.addModifier=function(t){var e=i.getName(t),r=i.registry;return void 0!==e&&!r[e]&&(r[e]=t,!0)},i.getAllModifierNames=function(){return Object.keys(i.registry)},i.getAllModifiers=function(){return merge(i.registry)},i.getModifier=function(t){return i.registry[t]},i.getName=function(t){return(t.toString().match(i.nameRegExp)||["",""])[1]},i.prototype.benchmark=function(t,e){function r(){n.modifyTable(t),n.emit({type:"afterBenchmarkIteration"})}var i=[],n=this,o=merge({iterations:1},e).iterations;n.on("afterBenchmarkIteration",function(){i.length!==o?r():n.emit({type:"afterBenchmark",results:i})});var a={startTime:0,endTime:0};return n.on("modify",function(){a.startTime=window.performance.now()}),n.on("afterModify",function(){a.endTime=window.performance.now(),i.push(a.endTime-a.startTime)}),r(),i},i.prototype.emit=function(t){fireEvent(this,t.type,t)},i.prototype.modify=function(r,i){var n=this;return new DataPromise(function(t,e){r.modified===r&&(r.modified=r.clone(!1,i));try{t(n.modifyTable(r,i))}catch(t){n.emit({type:"error",detail:i,table:r}),e(t)}})},i.prototype.modifyCell=function(t,e,r,i,n){return this.modifyTable(t)},i.prototype.modifyColumns=function(t,e,r,i){return this.modifyTable(t)},i.prototype.modifyRows=function(t,e,r,i){return this.modifyTable(t)},i.prototype.on=function(t,e){return addEvent(this,t,e)},i.nameRegExp=/^function\s+(\w*?)(?:Data)?(?:Modifier)?\s*\(/,i.registry={},i}();export default DataModifier;