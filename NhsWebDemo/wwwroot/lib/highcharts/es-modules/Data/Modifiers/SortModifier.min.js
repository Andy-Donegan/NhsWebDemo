"use strict";var __extends=this&&this.__extends||function(){var n=function(o,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,e){o.__proto__=e}||function(o,e){for(var t in e)e.hasOwnProperty(t)&&(o[t]=e[t])})(o,e)};return function(o,e){function t(){this.constructor=o}n(o,e),o.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}();import DataModifier from"./DataModifier.js";import DataTable from"../DataTable.js";import U from"../../Core/Utilities.js";var merge=U.merge,SortModifier=function(t){function p(o){var e=t.call(this)||this;return e.options=merge(p.defaultOptions,o),e}return __extends(p,t),p.ascending=function(o,e){return(o||0)<(e||0)?-1:(e||0)<(o||0)?1:0},p.descending=function(o,e){return(e||0)<(o||0)?-1:(o||0)<(e||0)?1:0},p.prototype.modifyCell=function(o,e,t,n,r){var i=this,d=i.options,f=d.orderByColumn,d=d.orderInColumn;return e===f&&(d?(o.modified.setCell(e,t,n),o.modified.setColumn(d,i.modifyTable(new DataTable(o.getColumns([f,d]))).modified.getColumn(d))):i.modifyTable(o,r)),o},p.prototype.modifyColumns=function(o,e,t,n){var r=this,i=r.options,d=i.orderByColumn,f=i.orderInColumn,i=Object.keys(e);return-1<i.indexOf(d)&&(f&&e[i[0]].length?(o.modified.setColumns(e,t),o.modified.setColumn(f,r.modifyTable(new DataTable(o.getColumns([d,f]))).modified.getColumn(f))):r.modifyTable(o,n)),o},p.prototype.modifyRows=function(o,e,t,n){var r=this,i=r.options,d=i.orderByColumn,i=i.orderInColumn;return i&&e.length?(o.modified.setRows(e,t),o.modified.setColumn(i,r.modifyTable(new DataTable(o.getColumns([d,i]))).modified.getColumn(i))):r.modifyTable(o,n),o},p.prototype.modifyTable=function(o,e){var t=this;t.emit({type:"modify",detail:e,table:o});var n=o.getColumnNames(),r=o.getRowCount(),i=o.getRows().map(function(o,e){return{index:e,row:o}}),d=t.options,f=d.direction,a=d.orderByColumn,d=d.orderInColumn,s="asc"===f?p.ascending:p.descending,u=n.indexOf(a),n=o.modified;if(-1!==u&&i.sort(function(o,e){return s(o.row[u],e.row[u])}),d){for(var m=[],l=0;l<r;++l)m[i[l].index]=l;n.setColumns(((a={})[d]=m,a))}else{for(var c=[],l=0;l<r;++l)c.push(i[l].row);n.setRows(c,0)}return t.emit({type:"afterModify",detail:e,table:o}),o},p.defaultOptions={modifier:"Order",direction:"desc",orderByColumn:"y"},p}(DataModifier);export default SortModifier;