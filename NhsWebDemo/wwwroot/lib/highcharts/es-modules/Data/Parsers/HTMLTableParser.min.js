"use strict";var __extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};import DataParser from"./DataParser.js";import DataConverter from"../DataConverter.js";import U from"../../Core/Utilities.js";var merge=U.merge,HTMLTableParser=function(n){function s(e,t,r){void 0===t&&(t=null);var a=n.call(this)||this;return a.columns=[],a.headers=[],a.options=merge(s.defaultOptions,e),a.converter=r||new DataConverter,t?(a.tableElement=t,a.tableElementID=t.id):e&&e.tableHTML&&(a.tableElement=e.tableHTML,a.tableElementID=e.tableHTML.id),a}return __extends(s,n),s.prototype.parse=function(e,t){var r=this,a=this.converter,n=[],s=[],o=merge(r.options,e),i=o.endRow,l=o.startColumn,m=o.endColumn,u=o.firstRowAsNames,e=o.tableHTML||this.tableElement;if(e instanceof HTMLElement){r.tableElement=this.tableElement,r.tableElementID=e.id,this.emit({type:"parse",columns:r.columns,detail:t,headers:r.headers});var c=e.getElementsByTagName("tr"),f=c.length,p=0,h=o.startRow;if(u&&f){for(var d=c[0].children,g=d.length,T=l;T<g&&!(m<T);T++)"TD"!==(y=d[T]).tagName&&"TH"!==y.tagName||s.push(y.innerHTML);h++}for(;p<f;){if(h<=p&&p<=i)for(var _=c[p].children,b=_.length,v=0;v<b;){var y,D=v-l,H=n[D];if(("TD"===(y=_[v]).tagName||"TH"===y.tagName)&&l<=v&&v<=m){n[D]||(n[D]=[]);var E=a.asGuessedType(y.innerHTML);E instanceof Date&&(E=E.getTime()),n[D][p-h]=E;for(T=1;T<=p-h&&void 0===H[p-h-T];)H[p-h-T]=null,T++}v++}p++}this.columns=n,this.headers=s,this.emit({type:"afterParse",columns:n,detail:t,headers:s})}else r.emit({type:"parseError",columns:n,detail:t,headers:s,error:"Not a valid HTML Table"})},s.prototype.getTable=function(){return DataParser.getTableFromColumns(this.columns,this.headers)},s.defaultOptions=__assign({},DataParser.defaultOptions),s}(DataParser);export default HTMLTableParser;