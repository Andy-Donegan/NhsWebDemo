"use strict";var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();import AST from"./AST.js";import SVGElement from"../SVG/SVGElement.js";import SVGRenderer from"../SVG/SVGRenderer.js";import U from"../../Utilities.js";var attr=U.attr,createElement=U.createElement,extend=U.extend,pick=U.pick,HTMLRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.compose=function(t){return-1===e.composedClasses.indexOf(t)&&(e.composedClasses.push(t),t.prototype.html=e.prototype.html),t},e.prototype.html=function(t,e,r){function p(s,i){["opacity","visibility"].forEach(function(o){s[o+"Setter"]=function(t,e,r){var n=s.div?s.div.style:i;SVGElement.prototype[o+"Setter"].call(this,t,e,r),n&&(n[e]=t)}}),s.addedSetters=!0}var d=this.createElement("span"),n=d.element,o=d.renderer,s=o.isSVG;return d.textSetter=function(t){t!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,AST.setElementHTML(this.element,pick(t,"")),this.textStr=t,d.doTransform=!0)},s&&p(d,d.element.style),d.xSetter=d.ySetter=d.alignSetter=d.rotationSetter=function(t,e){"align"===e?d.alignValue=d.textAlign=t:d[e]=t,d.doTransform=!0},d.afterSetters=function(){this.doTransform&&(this.htmlUpdateTransform(),this.doTransform=!1)},d.attr({text:t,x:Math.round(e),y:Math.round(r)}).css({position:"absolute"}),o.styledMode||d.css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),n.style.whiteSpace="nowrap",d.css=d.htmlCss,s&&(d.add=function(t){var i,e,a=o.box.parentNode,l=[];if(this.parentGroup=t){if(!(i=t.div)){for(e=t;e;)l.push(e),e=e.parentGroup;l.reverse().forEach(function(r){var t=attr(r.element,"class");function e(t,e){r[e]=t,"translateX"===e?s.left=t+"px":s.top=t+"px",r.doTransform=!0}var n,o=r.styles||{},s=(i=r.div=r.div||createElement("div",t?{className:t}:void 0,{position:"absolute",left:(r.translateX||0)+"px",top:(r.translateY||0)+"px",display:r.display,opacity:r.opacity,cursor:o.cursor,pointerEvents:o.pointerEvents,visibility:r.visibility},i||a)).style;extend(r,{classSetter:(n=i,function(t){this.element.setAttribute("class",t),n.className=t}),on:function(){return l[0].div&&d.on.apply({element:l[0].div,onEvents:r.onEvents},arguments),r},translateXSetter:e,translateYSetter:e}),r.addedSetters||p(r)})}}else i=a;return i.appendChild(n),d.added=!0,d.alignOnAdd&&d.htmlUpdateTransform(),d}),d},e.composedClasses=[],e}(SVGRenderer);export default HTMLRenderer;