"use strict";var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();import H from"../../Globals.js";var isFirefox=H.isFirefox,isMS=H.isMS,isWebKit=H.isWebKit,win=H.win;import SVGElement from"../SVG/SVGElement.js";import U from"../../Utilities.js";var css=U.css,defined=U.defined,extend=U.extend,pick=U.pick,pInt=U.pInt,HTMLElement=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.compose=function(t){var e,o;return-1===n.composedClasses.indexOf(t)&&(n.composedClasses.push(t),(o=t.prototype).getSpanCorrection=(e=n.prototype).getSpanCorrection,o.htmlCss=e.htmlCss,o.htmlGetBBox=e.htmlGetBBox,o.htmlUpdateTransform=e.htmlUpdateTransform,o.setSpanRotation=e.setSpanRotation),t},n.prototype.getSpanCorrection=function(t,e,o){this.xCorr=-t*o,this.yCorr=-e},n.prototype.htmlCss=function(t){var e,o=this,n="SPAN"===o.element.tagName&&t&&"width"in t,i=pick(n&&t.width,void 0);return n&&(delete t.width,o.textWidth=i,e=!0),t&&"ellipsis"===t.textOverflow&&(t.whiteSpace="nowrap",t.overflow="hidden"),o.styles=extend(o.styles,t),css(o.element,t),e&&o.htmlUpdateTransform(),o},n.prototype.htmlGetBBox=function(){var t=this.element;return{x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}},n.prototype.htmlUpdateTransform=function(){var t,e,o,n,i,r,s,a,d,p,l,f,h,c,m,x;this.added?(e=(t=this).renderer,o=t.element,n=t.translateX||0,i=t.translateY||0,r=t.x||0,s=t.y||0,d={left:0,center:.5,right:1}[a=t.textAlign||"left"],x=t.styles,p=x&&x.whiteSpace,css(o,{marginLeft:n,marginTop:i}),!e.styledMode&&t.shadows&&t.shadows.forEach(function(t){css(t,{marginLeft:n+1,marginTop:i+1})}),t.inverted&&[].forEach.call(o.childNodes,function(t){e.invertChild(t,o)}),"SPAN"===o.tagName&&(l=t.rotation,f=t.textWidth&&pInt(t.textWidth),h=[l,a,o.innerHTML,t.textWidth,t.textAlign].join(","),c=void 0,m=!1,f!==t.oldTextWidth&&(x=t.textPxLength||(css(o,{width:"",whiteSpace:p||"nowrap"}),o.offsetWidth),(f>t.oldTextWidth||f<x)&&(/[ \-]/.test(o.textContent||o.innerText)||"ellipsis"===o.style.textOverflow)&&(css(o,{width:f<x||l?f+"px":"auto",display:"block",whiteSpace:p||"normal"}),t.oldTextWidth=f,m=!0)),t.hasBoxWidthChanged=m,h!==t.cTT&&(c=e.fontMetrics(o.style.fontSize,o).b,!defined(l)||l===(t.oldRotation||0)&&a===t.oldAlign||t.setSpanRotation(l,d,c),t.getSpanCorrection(!defined(l)&&t.textPxLength||o.offsetWidth,c,d,l,a)),css(o,{left:r+(t.xCorr||0)+"px",top:s+(t.yCorr||0)+"px"}),t.cTT=h,t.oldRotation=l,t.oldAlign=a)):this.alignOnAdd=!0},n.prototype.setSpanRotation=function(t,e,o){var n={},i=isMS&&!/Edge/.test(win.navigator.userAgent)?"-ms-transform":isWebKit?"-webkit-transform":isFirefox?"MozTransform":win.opera?"-o-transform":void 0;i&&(n[i]=n.transform="rotate("+t+"deg)",n[i+(isFirefox?"Origin":"-origin")]=n.transformOrigin=100*e+"% "+o+"px",css(this.element,n))},n.composedClasses=[],n}(SVGElement);export default HTMLElement;