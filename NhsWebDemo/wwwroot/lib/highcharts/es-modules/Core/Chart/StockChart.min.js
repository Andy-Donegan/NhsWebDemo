"use strict";var __extends=this&&this.__extends||function(){var s=function(t,i){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)};return function(t,i){function e(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}();import A from"../Animation/AnimationUtilities.js";var animObject=A.animObject;import Axis from"../Axis/Axis.js";import Chart from"../Chart/Chart.js";import F from"../../Core/FormatUtilities.js";var format=F.format;import D from"../DefaultOptions.js";var getOptions=D.getOptions;import Series from"../Series/Series.js";import SVGRenderer from"../Renderer/SVG/SVGRenderer.js";import U from"../Utilities.js";var addEvent=U.addEvent,clamp=U.clamp,defined=U.defined,extend=U.extend,find=U.find,isNumber=U.isNumber,isString=U.isString,merge=U.merge,pick=U.pick,splat=U.splat;import"../Pointer.js";import"../Navigator.js";import"../Scrollbar.js";import"../../Extensions/RangeSelector.js";var StockChart=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.init=function(e,t){var s=getOptions(),i=e.xAxis,r=e.yAxis,o=pick(e.navigator&&e.navigator.enabled,s.navigator.enabled,!0);e.xAxis=e.yAxis=void 0;o=merge({chart:{panning:{enabled:!0,type:"x"},pinchType:"x"},navigator:{enabled:o},scrollbar:{enabled:pick(s.scrollbar&&s.scrollbar.enabled,!0)},rangeSelector:{enabled:pick(s.rangeSelector.enabled,!0)},title:{text:null},tooltip:{split:pick(s.tooltip.split,!0),crosshairs:!0},legend:{enabled:!1}},e,{isStock:!0});e.xAxis=i,e.yAxis=r,o.xAxis=splat(e.xAxis||{}).map(function(t,i){return merge(getDefaultAxisOptions("xAxis",t),s.xAxis,s.xAxis&&s.xAxis[i],t,getForcedAxisOptions("xAxis",e))}),o.yAxis=splat(e.yAxis||{}).map(function(t,i){return merge(getDefaultAxisOptions("yAxis",t),s.yAxis,s.yAxis&&s.yAxis[i],t)}),n.prototype.init.call(this,o,t)},t.prototype.createAxis=function(t,i){return i.axis=merge(getDefaultAxisOptions(t,i.axis),i.axis,getForcedAxisOptions(t,this.userOptions)),n.prototype.createAxis.call(this,t,i)},t}(Chart);function getDefaultAxisOptions(t,i){return"xAxis"===t?{minPadding:0,maxPadding:0,overscroll:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0}:"yAxis"===t?{labels:{y:-2},opposite:pick(i.opposite,!0),showLastLabel:!(!i.categories&&"category"!==i.type),title:{text:null}}:{}}function getForcedAxisOptions(t,i){if("xAxis"!==t)return{};var e=getOptions(),t={type:"datetime",categories:void 0};return pick(i.navigator&&i.navigator.enabled,e.navigator.enabled,!0)&&(t.startOnTick=!1,t.endOnTick=!1),t}!function(s){s.stockChart=function(t,i,e){return new s(t,i,e)}}(StockChart=StockChart||{}),addEvent(Series,"setOptions",function(t){var i;this.chart.options.isStock&&(this.is("column")||this.is("columnrange")?i={borderWidth:0,shadow:!1}:this.is("scatter")||this.is("sma")||(i={marker:{enabled:!1,radius:2}}),i&&(t.plotOptions[this.type]=merge(t.plotOptions[this.type],i)))}),addEvent(Axis,"autoLabelAlign",function(t){var i,e=this.chart,s=this.options,r=e._labelPanes=e._labelPanes||{},e=this.options.labels;this.chart.options.isStock&&"yAxis"===this.coll&&!r[i=s.top+","+s.height]&&e.enabled&&(15===e.x&&(e.x=0),void 0===e.align&&(e.align="right"),r[i]=this,t.align="right",t.preventDefault())}),addEvent(Axis,"destroy",function(){var t=this.chart,i=this.options&&this.options.top+","+this.options.height;i&&t._labelPanes&&t._labelPanes[i]===this&&delete t._labelPanes[i]}),addEvent(Axis,"getPlotLinePath",function(t){var e,s,r,o,n,a,i,l,h=this,c=(this.isLinked&&!this.series?this.linkedParent:this).series,p=h.chart,d=p.renderer,x=h.left,u=h.top,f=[],g=[],b=t.translatedValue,m=t.value,A=t.force;(p.options.isStock&&!1!==t.acrossPanes&&"xAxis"===h.coll||"yAxis"===h.coll)&&(t.preventDefault(),i=h.coll,l="xAxis"===i?"yAxis":"xAxis",i=h.options[l],g=isNumber(i)?[p[l][i]]:isString(i)?[p.get(i)]:c.map(function(t){return t[l]}),(h.isXAxis?p.yAxis:p.xAxis).forEach(function(t){var i;defined(t.options.id)&&-1!==t.options.id.indexOf("navigator")||(i=t.isXAxis?"yAxis":"xAxis",i=defined(t.options[i])?p[i][t.options[i]]:p[i][0],h===i&&g.push(t))}),n=g.length?[]:[(h.isXAxis?p.yAxis:p.xAxis)[0]],g.forEach(function(i){-1!==n.indexOf(i)||find(n,function(t){return t.pos===i.pos&&t.len===i.len})||n.push(i)}),a=pick(b,h.translate(m,null,null,t.old)),isNumber(a)&&(h.horiz?n.forEach(function(t){var i;s=t.pos,o=s+t.len,e=r=Math.round(a+h.transB),"pass"!==A&&(e<x||e>x+h.width)&&(A?e=r=clamp(e,x,x+h.width):i=!0),i||f.push(["M",e,s],["L",r,o])}):n.forEach(function(t){var i;e=t.pos,r=e+t.len,s=o=Math.round(u+h.height-a),"pass"!==A&&(s<u||s>u+h.height)&&(A?s=o=clamp(s,u,u+h.height):i=!0),i||f.push(["M",e,s],["L",r,o])})),t.path=0<f.length?d.crispPolyLine(f,t.lineWidth||1):null)}),SVGRenderer.prototype.crispPolyLine=function(t,i){for(var e=0;e<t.length;e+=2){var s=t[e],r=t[e+1];s[1]===r[1]&&(s[1]=r[1]=Math.round(s[1])-i%2/2),s[2]===r[2]&&(s[2]=r[2]=Math.round(s[2])+i%2/2)}return t},addEvent(Axis,"afterHideCrosshair",function(){this.crossLabel&&(this.crossLabel=this.crossLabel.hide())}),addEvent(Axis,"afterDrawCrosshair",function(t){var i,e,s,r,o,n,a,l,h,c,p,d,x,u,f,g,b;this.crosshair&&this.crosshair.label&&this.crosshair.label.enabled&&this.cross&&isNumber(this.min)&&isNumber(this.max)&&(i=this.chart,p=this.logarithmic,e=this.crosshair.label,s=this.horiz,r=this.opposite,c=this.left,a=this.top,o=this.crossLabel,l=e.format,h="",d="inside"===this.options.tickPosition,x=!1!==this.crosshair.snap,u=0,g=t.e||this.cross&&this.cross.e,f=t.point,b=this.min,t=this.max,p&&(b=p.lin2log(b),t=p.lin2log(t)),p=s?"center":r?"right"===this.labelAlign?"right":"left":"left"===this.labelAlign?"left":"center",o||(o=this.crossLabel=i.renderer.label("",0,void 0,e.shape||"callout").addClass("highcharts-crosshair-label highcharts-color-"+(f?f.series.colorIndex:this.series[0]&&this.series[0].colorIndex)).attr({align:e.align||p,padding:pick(e.padding,8),r:pick(e.borderRadius,3),zIndex:2}).add(this.labelGroup),i.styledMode||o.attr({fill:e.backgroundColor||f&&f.series&&f.series.color||"#666666",stroke:e.borderColor||"","stroke-width":e.borderWidth||0}).css(extend({color:"#ffffff",fontWeight:"normal",fontSize:"11px",textAlign:"center"},e.style||{}))),a=s?(n=x?(f.plotX||0)+c:g.chartX,a+(r?0:this.height)):(n=r?this.width+c:0,x?(f.plotY||0)+a:g.chartY),l||e.formatter||(l="{value"+((h=this.dateTime?"%b %d, %Y":h)?":"+h:"")+"}"),g=x?this.isXAxis?f.x:f.y:this.toValue(s?g.chartX:g.chartY),b=f?f.series.isPointInside(f):isNumber(g)&&b<g&&g<t,t="",l?t=format(l,{value:g},i):e.formatter&&isNumber(g)&&(t=e.formatter.call(this,g)),o.attr({text:t,x:n,y:a,visibility:b?"visible":"hidden"}),b=o.getBBox(),isNumber(o.y)&&(s?(d&&!r||!d&&r)&&(a=o.y-b.height):a=o.y-b.height/2),c=s?{left:c-b.x,right:c+this.width-b.x}:{left:"left"===this.labelAlign?c:0,right:"right"===this.labelAlign?c+this.width:i.chartWidth},o.translateX<c.left&&(u=c.left-o.translateX),o.translateX+b.width>=c.right&&(u=-(o.translateX+b.width-c.right)),o.attr({x:n+u,y:a,anchorX:s?n:this.opposite?0:i.chartWidth,anchorY:s?this.opposite?i.chartHeight:0:a+b.height/2}))}),Series.prototype.forceCropping=function(){var t=this.chart,i=this.options.dataGrouping;return!1!==this.allowDG&&i&&pick(i.enabled,t.options.isStock)},addEvent(Chart,"update",function(t){t=t.options;"scrollbar"in t&&this.navigator&&(merge(!0,this.options.scrollbar,t.scrollbar),this.navigator.update({},!1),delete t.scrollbar)});export default StockChart;