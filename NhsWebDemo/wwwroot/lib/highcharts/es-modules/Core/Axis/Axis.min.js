"use strict";import A from"../Animation/AnimationUtilities.js";var animObject=A.animObject;import AxisDefaults from"./AxisDefaults.js";import Color from"../Color/Color.js";import D from"../DefaultOptions.js";var defaultOptions=D.defaultOptions;import F from"../Foundation.js";var registerEventOptions=F.registerEventOptions;import H from"../Globals.js";var deg2rad=H.deg2rad;import Tick from"./Tick.js";import U from"../Utilities.js";var arrayMax=U.arrayMax,arrayMin=U.arrayMin,clamp=U.clamp,correctFloat=U.correctFloat,defined=U.defined,destroyObjectProperties=U.destroyObjectProperties,erase=U.erase,error=U.error,extend=U.extend,fireEvent=U.fireEvent,getMagnitude=U.getMagnitude,isArray=U.isArray,isNumber=U.isNumber,isString=U.isString,merge=U.merge,normalizeTickInterval=U.normalizeTickInterval,objectEach=U.objectEach,pick=U.pick,relativeLength=U.relativeLength,removeEvent=U.removeEvent,splat=U.splat,syncTimeout=U.syncTimeout,Axis=function(){function i(i,t){this.alternateBands=void 0,this.bottom=void 0,this.categories=void 0,this.chart=void 0,this.closestPointRange=void 0,this.coll=void 0,this.eventOptions=void 0,this.hasNames=void 0,this.hasVisibleSeries=void 0,this.height=void 0,this.isLinked=void 0,this.labelEdge=void 0,this.labelFormatter=void 0,this.left=void 0,this.len=void 0,this.max=void 0,this.maxLabelLength=void 0,this.min=void 0,this.minorTickInterval=void 0,this.minorTicks=void 0,this.minPixelPadding=void 0,this.names=void 0,this.offset=void 0,this.options=void 0,this.overlap=void 0,this.paddedTicks=void 0,this.plotLinesAndBands=void 0,this.plotLinesAndBandsGroups=void 0,this.pointRange=void 0,this.pointRangePadding=void 0,this.pos=void 0,this.positiveValuesOnly=void 0,this.right=void 0,this.series=void 0,this.side=void 0,this.tickAmount=void 0,this.tickInterval=void 0,this.tickmarkOffset=void 0,this.tickPositions=void 0,this.tickRotCorr=void 0,this.ticks=void 0,this.top=void 0,this.transA=void 0,this.transB=void 0,this.translationSlope=void 0,this.userOptions=void 0,this.visible=void 0,this.width=void 0,this.zoomEnabled=void 0,this.init(i,t)}return i.prototype.init=function(i,t){var e=t.isX,s=this;s.chart=i,s.horiz=i.inverted&&!s.isZAxis?!e:e,s.isXAxis=e,s.coll=s.coll||(e?"xAxis":"yAxis"),fireEvent(this,"init",{userOptions:t}),s.opposite=pick(t.opposite,s.opposite),s.side=pick(t.side,s.side,s.horiz?s.opposite?0:2:s.opposite?1:3),s.setOptions(t);var n=this.options,a=n.labels,o=n.type;s.userOptions=t,s.minPixelPadding=0,s.reversed=pick(n.reversed,s.reversed),s.visible=n.visible,s.zoomEnabled=n.zoomEnabled,s.hasNames="category"===o||!0===n.categories,s.categories=n.categories||s.hasNames,s.names||(s.names=[],s.names.keys={}),s.plotLinesAndBandsGroups={},s.positiveValuesOnly=!!s.logarithmic,s.isLinked=defined(n.linkedTo),s.ticks={},s.labelEdge=[],s.minorTicks={},s.plotLinesAndBands=[],s.alternateBands={},s.len=0,s.minRange=s.userMinRange=n.minRange||n.maxZoom,s.range=n.range,s.offset=n.offset||0,s.max=null,s.min=null;o=pick(n.crosshair,splat(i.options.tooltip.crosshairs)[e?0:1]);s.crosshair=!0===o?{}:o,-1===i.axes.indexOf(s)&&(e?i.axes.splice(i.xAxis.length,0,s):i.axes.push(s),i[s.coll].push(s)),s.series=s.series||[],i.inverted&&!s.isZAxis&&e&&void 0===s.reversed&&(s.reversed=!0),s.labelRotation=isNumber(a.rotation)?a.rotation:void 0,registerEventOptions(s,n),fireEvent(this,"afterInit")},i.prototype.setOptions=function(i){this.options=merge(AxisDefaults.defaultXAxisOptions,"yAxis"===this.coll&&AxisDefaults.defaultYAxisOptions,[AxisDefaults.defaultTopAxisOptions,AxisDefaults.defaultRightAxisOptions,AxisDefaults.defaultBottomAxisOptions,AxisDefaults.defaultLeftAxisOptions][this.side],merge(defaultOptions[this.coll],i)),fireEvent(this,"afterSetOptions",{userOptions:i})},i.prototype.defaultLabelFormatter=function(i){var t,e,s=this.axis,n=this.chart.numberFormatter,a=isNumber(this.value)?this.value:NaN,o=s.chart.time,r=s.categories,h=this.dateTimeLabelFormat,l=defaultOptions.lang,c=l.numericSymbols,d=l.numericSymbolMagnitude||1e3,m=s.logarithmic?Math.abs(a):s.tickInterval,p=c&&c.length;if(r)e=""+this.value;else if(h)e=o.dateFormat(h,a);else if(p&&1e3<=m)for(;p--&&void 0===e;)(t=Math.pow(d,p+1))<=m&&10*a%t==0&&null!==c[p]&&0!==a&&(e=n(a/t,-1)+c[p]);return e=void 0===e?1e4<=Math.abs(a)?n(a,-1):n(a,-1,void 0,""):e},i.prototype.getSeriesExtremes=function(){var o,r=this,h=r.chart;fireEvent(this,"getSeriesExtremes",null,function(){r.hasVisibleSeries=!1,r.dataMin=r.dataMax=r.threshold=null,r.softThreshold=!r.isXAxis,r.stacking&&r.stacking.buildStacks(),r.series.forEach(function(i){var t,e,s,n,a;!i.visible&&h.options.chart.ignoreHiddenSeries||(e=(t=i.options).threshold,r.hasVisibleSeries=!(a=n=s=void 0),r.positiveValuesOnly&&e<=0&&(e=null),r.isXAxis?(s=i.xData).length&&(s=r.logarithmic?s.filter(r.validatePositiveValue):s,n=(o=i.getXExtremes(s)).min,a=o.max,isNumber(n)||n instanceof Date||(s=s.filter(isNumber),n=(o=i.getXExtremes(s)).min,a=o.max),s.length&&(r.dataMin=Math.min(pick(r.dataMin,n),n),r.dataMax=Math.max(pick(r.dataMax,a),a))):(i=i.applyExtremes(),isNumber(i.dataMin)&&(n=i.dataMin,r.dataMin=Math.min(pick(r.dataMin,n),n)),isNumber(i.dataMax)&&(a=i.dataMax,r.dataMax=Math.max(pick(r.dataMax,a),a)),defined(e)&&(r.threshold=e),t.softThreshold&&!r.positiveValuesOnly||(r.softThreshold=!1)))})}),fireEvent(this,"afterGetSeriesExtremes")},i.prototype.translate=function(i,t,e,s,n,a){var o=this.linkedParent||this,r=(s&&o.old?o.old:o).min,h=o.minPixelPadding,l=(o.isOrdinal||o.brokenAxis&&o.brokenAxis.hasBreaks||o.logarithmic&&n)&&o.lin2val,c=1,d=0,n=0,s=(s=(s&&o.old?o.old:o).transA)||o.transA;return e&&(c*=-1,d=o.len),o.reversed&&(d-=(c*=-1)*(o.sector||o.len)),t?(i=i*c+d,n=(i-=h)/s+r,l&&(n=o.lin2val(n))):(l&&(i=o.val2lin(i)),n=isNumber(r)?c*(i-r)*s+d+c*h+(isNumber(a)?s*a:0):void 0),n},i.prototype.toPixels=function(i,t){return this.translate(i,!1,!this.horiz,null,!0)+(t?0:this.pos)},i.prototype.toValue=function(i,t){return this.translate(i-(t?0:this.pos),!0,!this.horiz,null,!0)},i.prototype.getPlotLinePath=function(i){var t,e,s,n,a,o=this,r=o.chart,h=o.left,l=o.top,c=i.old,d=i.value,m=i.lineWidth,p=c&&r.oldChartHeight||r.chartHeight,f=c&&r.oldChartWidth||r.chartWidth,u=o.transB,g=i.translatedValue,x=i.force;function v(i,t,e){return("pass"!==x&&i<t||e<i)&&(x?i=clamp(i,t,e):a=!0),i}i={value:d,lineWidth:m,old:c,force:x,acrossPanes:i.acrossPanes,translatedValue:g};return fireEvent(this,"getPlotLinePath",i,function(i){g=pick(g,o.translate(d,null,null,c)),g=clamp(g,-1e5,1e5),t=s=Math.round(g+u),e=n=Math.round(p-g-u),isNumber(g)?o.horiz?(e=l,n=p-o.bottom,t=s=v(t,h,h+o.width)):(t=h,s=f-o.right,e=n=v(e,l,l+o.height)):x=!(a=!0),i.path=a&&!x?null:r.renderer.crispLine([["M",t,e],["L",s,n]],m||1)}),i.path},i.prototype.getLinearTickPositions=function(i,t,e){var s,n,a,o=correctFloat(Math.floor(t/i)*i),r=correctFloat(Math.ceil(e/i)*i),h=[];if(correctFloat(o+i)===o&&(a=20),this.single)return[t];for(s=o;s<=r&&(h.push(s),(s=correctFloat(s+i,a))!==n);)n=s;return h},i.prototype.getMinorTickInterval=function(){var i=this.options;return!0===i.minorTicks?pick(i.minorTickInterval,"auto"):!1===i.minorTicks?null:i.minorTickInterval},i.prototype.getMinorTickPositions=function(){var i,t=this,e=t.options,s=t.tickPositions,n=t.minorTickInterval,a=t.pointRangePadding||0,o=t.min-a,r=t.max+a,a=r-o,h=[];if(a&&a/n<t.len/3){var l=t.logarithmic;if(l)this.paddedTicks.forEach(function(i,t,e){t&&h.push.apply(h,l.getLogTickPositions(n,e[t-1],e[t],!0))});else if(t.dateTime&&"auto"===this.getMinorTickInterval())h=h.concat(t.getTimeTicks(t.dateTime.normalizeTimeTickInterval(n),o,r,e.startOfWeek));else for(i=o+(s[0]-o)%n;i<=r&&i!==h[0];i+=n)h.push(i)}return 0!==h.length&&t.trimTicks(h),h},i.prototype.adjustForMinRange=function(){var i,t,e,s,n,a,o,r,h=this,l=h.options,c=h.logarithmic,d=h.min,m=h.max,p=0;h.isXAxis&&void 0===h.minRange&&!c&&(defined(l.min)||defined(l.max)||defined(l.floor)||defined(l.ceiling)?h.minRange=null:(h.series.forEach(function(i){if(s=i.xData,n=i.xIncrement?1:s.length-1,1<s.length)for(t=n;0<t;t--)e=s[t]-s[t-1],(!p||e<p)&&(p=e)}),h.minRange=Math.min(5*p,h.dataMax-h.dataMin))),m-d<h.minRange&&(i=h.dataMax-h.dataMin>=h.minRange,a=[d-(o=((r=h.minRange)-m+d)/2),pick(l.min,d-o)],i&&(a[2]=h.logarithmic?h.logarithmic.log2lin(h.dataMin):h.dataMin),o=[(d=arrayMax(a))+r,pick(l.max,d+r)],i&&(o[2]=c?c.log2lin(h.dataMax):h.dataMax),(m=arrayMin(o))-d<r&&(a[0]=m-r,a[1]=pick(l.min,m-r),d=arrayMax(a))),h.min=d,h.max=m},i.prototype.getClosest=function(){var s;return this.categories?s=1:this.series.forEach(function(i){var t=i.closestPointRange,e=i.visible||!i.chart.options.chart.ignoreHiddenSeries;!i.noSharedTooltip&&defined(t)&&e&&(s=defined(s)?Math.min(s,t):t)}),s},i.prototype.nameToX=function(i){var t,e=isArray(this.categories),s=e?this.categories:this.names,n=i.options.x;return i.series.requireSorting=!1,-1===(n=!defined(n)?this.options.uniqueNames?e?s.indexOf(i.name):pick(s.keys[i.name],-1):i.series.autoIncrement():n)?e||(t=s.length):t=n,void 0!==t&&(this.names[t]=i.name,this.names.keys[i.name]=t),t},i.prototype.updateNames=function(){var n=this,t=this.names;0<t.length&&(Object.keys(t.keys).forEach(function(i){delete t.keys[i]}),t.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(function(s){s.xIncrement=null,s.points&&!s.isDirtyData||(n.max=Math.max(n.max,s.xData.length-1),s.processData(),s.generatePoints()),s.data.forEach(function(i,t){var e;i&&i.options&&void 0!==i.name&&void 0!==(e=n.nameToX(i))&&e!==i.x&&(i.x=e,s.xData[t]=e)})}))},i.prototype.setAxisTranslation=function(){var s,i,n=this,t=n.max-n.min,e=n.linkedParent,a=!!n.categories,o=n.isXAxis,r=n.axisPointRange||0,h=0,l=0;n.transA;(o||a||r)&&(s=n.getClosest(),e?(h=e.minPointOffset,l=e.pointRangePadding):n.series.forEach(function(i){var t=a?1:o?pick(i.options.pointRange,s,0):n.axisPointRange||0,e=i.options.pointPlacement;r=Math.max(r,t),n.single&&!a||(i=i.is("xrange")?!o:o,h=Math.max(h,i&&isString(e)?0:t/2),l=Math.max(l,i&&"on"===e?0:t))}),e=n.ordinal&&n.ordinal.slope&&s?n.ordinal.slope/s:1,n.minPointOffset=h*=e,n.pointRangePadding=l*=e,n.pointRange=Math.min(r,n.single&&a?1:t),o&&(n.closestPointRange=s)),n.translationSlope=n.transA=i=n.staticScale||n.len/(t+l||1),n.transB=n.horiz?n.left:n.bottom,n.minPixelPadding=i*h,fireEvent(this,"afterSetAxisTranslation")},i.prototype.minFromRange=function(){return this.max-this.range},i.prototype.setTickInterval=function(i){var t,e,s,n,a,o,r=this,h=r.chart,l=r.logarithmic,c=r.options,d=r.isXAxis,m=r.isLinked,p=c.tickPixelInterval,f=r.categories,u=r.softThreshold,g=c.maxPadding,x=c.minPadding,v=isNumber(c.tickInterval)&&0<=c.tickInterval?c.tickInterval:void 0,k=isNumber(r.threshold)?r.threshold:null;r.dateTime||f||m||this.getTickAmount(),n=pick(r.userMin,c.min),a=pick(r.userMax,c.max),m?(r.linkedParent=h[r.coll][c.linkedTo],t=r.linkedParent.getExtremes(),r.min=pick(t.min,t.dataMin),r.max=pick(t.max,t.dataMax),c.type!==r.linkedParent.options.type&&error(11,1,h)):(u&&defined(k)&&(r.dataMin>=k?(e=k,x=0):r.dataMax<=k&&(s=k,g=0)),r.min=pick(n,e,r.dataMin),r.max=pick(a,s,r.dataMax)),l&&(r.positiveValuesOnly&&!i&&Math.min(r.min,pick(r.dataMin,r.min))<=0&&error(10,1,h),r.min=correctFloat(l.log2lin(r.min),16),r.max=correctFloat(l.log2lin(r.max),16)),r.range&&defined(r.max)&&(r.userMin=r.min=n=Math.max(r.dataMin,r.minFromRange()),r.userMax=a=r.max,r.range=null),fireEvent(r,"foundExtremes"),r.beforePadding&&r.beforePadding(),r.adjustForMinRange(),f||r.axisPointRange||r.stacking&&r.stacking.usePercentage||m||!defined(r.min)||!defined(r.max)||(l=r.max-r.min)&&(!defined(n)&&x&&(r.min-=l*x),!defined(a)&&g&&(r.max+=l*g)),isNumber(r.userMin)||(isNumber(c.softMin)&&c.softMin<r.min&&(r.min=n=c.softMin),isNumber(c.floor)&&(r.min=Math.max(r.min,c.floor))),isNumber(r.userMax)||(isNumber(c.softMax)&&c.softMax>r.max&&(r.max=a=c.softMax),isNumber(c.ceiling)&&(r.max=Math.min(r.max,c.ceiling))),u&&defined(r.dataMin)&&(k=k||0,!defined(n)&&r.min<k&&r.dataMin>=k?r.min=r.options.minRange?Math.min(k,r.max-r.minRange):k:!defined(a)&&r.max>k&&r.dataMax<=k&&(r.max=r.options.minRange?Math.max(k,r.min+r.minRange):k)),isNumber(r.min)&&isNumber(r.max)&&!this.chart.polar&&r.min>r.max&&(defined(r.options.min)?r.max=r.min:defined(r.options.max)&&(r.min=r.max)),r.min===r.max||void 0===r.min||void 0===r.max?r.tickInterval=1:m&&r.linkedParent&&!v&&p===r.linkedParent.options.tickPixelInterval?r.tickInterval=v=r.linkedParent.tickInterval:r.tickInterval=pick(v,this.tickAmount?(r.max-r.min)/Math.max(this.tickAmount-1,1):void 0,f?1:(r.max-r.min)*p/Math.max(r.len,p)),d&&!i&&(o=r.min!==(r.old&&r.old.min)||r.max!==(r.old&&r.old.max),r.series.forEach(function(i){i.forceCrop=i.forceCropping&&i.forceCropping(),i.processData(o)}),fireEvent(this,"postProcessData",{hasExtemesChanged:o})),r.setAxisTranslation(),fireEvent(this,"initialAxisTranslation"),r.pointRange&&!v&&(r.tickInterval=Math.max(r.pointRange,r.tickInterval));i=pick(c.minTickInterval,r.dateTime&&!r.series.some(function(i){return i.noSharedTooltip})?r.closestPointRange:0);!v&&r.tickInterval<i&&(r.tickInterval=i),r.dateTime||r.logarithmic||v||(r.tickInterval=normalizeTickInterval(r.tickInterval,void 0,getMagnitude(r.tickInterval),pick(c.allowDecimals,r.tickInterval<.5||void 0!==this.tickAmount),!!this.tickAmount)),this.tickAmount||(r.tickInterval=r.unsquish()),this.setTickPositions()},i.prototype.setTickPositions=function(){var i=this,t=this.options,e=t.tickPositions,s=this.getMinorTickInterval(),n=this.hasVerticalPanning(),a="colorAxis"===this.coll,o=(a||!n)&&t.startOnTick,a=(a||!n)&&t.endOnTick,n=t.tickPositioner;this.tickmarkOffset=this.categories&&"between"===t.tickmarkPlacement&&1===this.tickInterval?.5:0,this.minorTickInterval="auto"===s&&this.tickInterval?this.tickInterval/5:s,this.single=this.min===this.max&&defined(this.min)&&!this.tickAmount&&(parseInt(this.min,10)===this.min||!1!==t.allowDecimals),this.tickPositions=s=e&&e.slice(),s||(i.ordinal&&i.ordinal.positions||!((this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))?s=i.dateTime?i.getTimeTicks(i.dateTime.normalizeTimeTickInterval(this.tickInterval,t.units),this.min,this.max,t.startOfWeek,i.ordinal&&i.ordinal.positions,this.closestPointRange,!0):i.logarithmic?i.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max):(s=[this.min,this.max],error(19,!1,this.chart)),s.length>this.len&&(s=[s[0],s.pop()])[0]===s[1]&&(s.length=1),this.tickPositions=s,(n=n&&n.apply(i,[this.min,this.max]))&&(this.tickPositions=s=n)),this.paddedTicks=s.slice(0),this.trimTicks(s,o,a),this.isLinked||(this.single&&s.length<2&&!this.categories&&!this.series.some(function(i){return i.is("heatmap")&&"between"===i.options.pointPlacement})&&(this.min-=.5,this.max+=.5),e||n||this.adjustTickAmount()),fireEvent(this,"afterSetTickPositions")},i.prototype.trimTicks=function(i,t,e){var s=i[0],n=i[i.length-1],a=!this.isOrdinal&&this.minPointOffset||0;if(fireEvent(this,"trimTicks"),!this.isLinked){if(t&&s!==-1/0)this.min=s;else for(;this.min-a>i[0];)i.shift();if(e)this.max=n;else for(;this.max+a<i[i.length-1];)i.pop();0===i.length&&defined(s)&&!this.options.tickPositions&&i.push((n+s)/2)}},i.prototype.alignToOthers=function(){var e,s={},i=this.options;return!1!==this.chart.options.chart.alignTicks&&i.alignTicks&&!1!==i.startOnTick&&!1!==i.endOnTick&&!this.logarithmic&&this.chart[this.coll].forEach(function(i){var t=i.options,t=[i.horiz?t.left:t.top,t.width,t.height,t.pane].join(",");i.series.length&&(s[t]?e=!0:s[t]=1)}),e},i.prototype.getTickAmount=function(){var i=this.options,t=i.tickPixelInterval,e=i.tickAmount;(e=!(e=!defined(i.tickInterval)&&!e&&this.len<t&&!this.isRadial&&!this.logarithmic&&i.startOnTick&&i.endOnTick?2:e)&&this.alignToOthers()?Math.ceil(this.len/t)+1:e)<4&&(this.finalTickAmt=e,e=5),this.tickAmount=e},i.prototype.adjustTickAmount=function(){var i,t,e=this,s=e.options,n=e.tickInterval,a=e.tickPositions,o=e.tickAmount,r=e.finalTickAmt,h=a&&a.length,l=pick(e.threshold,e.softThreshold?0:null);if(e.hasData()&&isNumber(e.min)&&isNumber(e.max)){if(h<o){for(;a.length<o;)a.length%2||e.min===l?a.push(correctFloat(a[a.length-1]+n)):a.unshift(correctFloat(a[0]-n));e.transA*=(h-1)/(o-1),e.min=s.startOnTick?a[0]:Math.min(e.min,a[0]),e.max=s.endOnTick?a[a.length-1]:Math.max(e.max,a[a.length-1])}else o<h&&(e.tickInterval*=2,e.setTickPositions());if(defined(r)){for(t=i=a.length;t--;)(3===r&&t%2==1||r<=2&&0<t&&t<i-1)&&a.splice(t,1);e.finalTickAmt=void 0}}},i.prototype.setScale=function(){var i=this,t=!1,e=!1;i.series.forEach(function(i){t=t||i.isDirtyData||i.isDirty,e=e||i.xAxis&&i.xAxis.isDirty||!1}),i.setAxisSize();var s=i.len!==(i.old&&i.old.len);s||t||e||i.isLinked||i.forceRedraw||i.userMin!==(i.old&&i.old.userMin)||i.userMax!==(i.old&&i.old.userMax)||i.alignToOthers()?(i.stacking&&i.stacking.resetStacks(),i.forceRedraw=!1,i.getSeriesExtremes(),i.setTickInterval(),i.isDirty||(i.isDirty=s||i.min!==(i.old&&i.old.min)||i.max!==(i.old&&i.old.max))):i.stacking&&i.stacking.cleanStacks(),t&&i.panningState&&(i.panningState.isDirty=!0),fireEvent(this,"afterSetScale")},i.prototype.setExtremes=function(i,t,e,s,n){var a=this,o=a.chart;e=pick(e,!0),a.series.forEach(function(i){delete i.kdTree}),n=extend(n,{min:i,max:t}),fireEvent(a,"setExtremes",n,function(){a.userMin=i,a.userMax=t,a.eventArgs=n,e&&o.redraw(s)})},i.prototype.zoom=function(i,t){var s=this,n=this.dataMin,a=this.dataMax,e=this.options,o=Math.min(n,pick(e.min,n)),r=Math.max(a,pick(e.max,a)),t={newMin:i,newMax:t};return fireEvent(this,"zoom",t,function(i){var t=i.newMin,e=i.newMax;t===s.min&&e===s.max||(s.allowZoomOutside||(defined(n)&&r<(t=t<o?o:t)&&(t=r),defined(a)&&r<(e=e<o?o:e)&&(e=r)),s.displayBtn=void 0!==t||void 0!==e,s.setExtremes(t,e,!1,void 0,{trigger:"zoom"})),i.zoomed=!0}),t.zoomed},i.prototype.setAxisSize=function(){var i=this.chart,t=this.options,e=t.offsets||[0,0,0,0],s=this.horiz,n=this.width=Math.round(relativeLength(pick(t.width,i.plotWidth-e[3]+e[1]),i.plotWidth)),a=this.height=Math.round(relativeLength(pick(t.height,i.plotHeight-e[0]+e[2]),i.plotHeight)),o=this.top=Math.round(relativeLength(pick(t.top,i.plotTop+e[0]),i.plotHeight,i.plotTop)),e=this.left=Math.round(relativeLength(pick(t.left,i.plotLeft+e[3]),i.plotWidth,i.plotLeft));this.bottom=i.chartHeight-a-o,this.right=i.chartWidth-n-e,this.len=Math.max(s?n:a,0),this.pos=s?e:o},i.prototype.getExtremes=function(){var i=this,t=i.logarithmic;return{min:t?correctFloat(t.lin2log(i.min)):i.min,max:t?correctFloat(t.lin2log(i.max)):i.max,dataMin:i.dataMin,dataMax:i.dataMax,userMin:i.userMin,userMax:i.userMax}},i.prototype.getThreshold=function(i){var t=this,e=t.logarithmic,s=e?e.lin2log(t.min):t.min,e=e?e.lin2log(t.max):t.max;return null===i||i===-1/0?i=s:i===1/0?i=e:i<s?i=s:e<i&&(i=e),t.translate(i,0,1,0,1)},i.prototype.autoLabelAlign=function(i){var t=(pick(i,0)-90*this.side+720)%360,i={align:"center"};return fireEvent(this,"autoLabelAlign",i,function(i){15<t&&t<165?i.align="right":195<t&&t<345&&(i.align="left")}),i.align},i.prototype.tickSize=function(i){var t=this.options,e=pick(t["tick"===i?"tickWidth":"minorTickWidth"],"tick"===i&&this.isXAxis&&!this.categories?1:0),s=t["tick"===i?"tickLength":"minorTickLength"],n={tickSize:n=e&&s?[s="inside"===t[i+"Position"]?-s:s,e]:n};return fireEvent(this,"afterTickSize",n),n.tickSize},i.prototype.labelMetrics=function(){var i=this.tickPositions&&this.tickPositions[0]||0;return this.chart.renderer.fontMetrics(this.options.labels.style.fontSize,this.ticks[i]&&this.ticks[i].label)},i.prototype.unsquish=function(){function e(i){var t=1<(t=i/(r||1))?Math.ceil(t):1;return c<t*o&&i!==1/0&&r!==1/0&&c&&(t=Math.ceil(c/o)),correctFloat(t*o)}var s,n,i,t=this.options.labels,a=this.horiz,o=this.tickInterval,r=this.len/(((this.categories?1:0)+this.max-this.min)/o),h=t.rotation,l=this.labelMetrics(),c=Math.max(this.max-this.min,0),d=o,m=Number.MAX_VALUE;return a?(t.staggerLines||t.step||(isNumber(h)?i=[h]:r<t.autoRotationLimit&&(i=t.autoRotation)),i&&i.forEach(function(i){var t;(i===h||i&&-90<=i&&i<=90)&&(t=(n=e(Math.abs(l.h/Math.sin(deg2rad*i))))+Math.abs(i/360))<m&&(m=t,s=i,d=n)})):t.step||(d=e(l.h)),this.autoRotation=i,this.labelRotation=pick(s,isNumber(h)?h:0),d},i.prototype.getSlotWidth=function(i){var t=this.chart,e=this.horiz,s=this.options.labels,n=Math.max(this.tickPositions.length-(this.categories?0:1),1),a=t.margin[3];if(i&&isNumber(i.slotWidth))return i.slotWidth;if(e&&s.step<2)return s.rotation?0:(this.staggerLines||1)*this.len/n;if(!e){s=s.style.width;if(void 0!==s)return parseInt(String(s),10);if(a)return a-t.spacing[3]}return.33*t.chartWidth},i.prototype.renderUnsquish=function(){var n,a,i,t,e=this.chart,s=e.renderer,o=this.tickPositions,r=this.ticks,h=this.options.labels,l=h.style,c=this.horiz,d=this.getSlotWidth(),m=Math.max(1,Math.round(d-2*h.padding)),p={},f=this.labelMetrics(),u=l.textOverflow,g=0;if(isString(h.rotation)||(p.rotation=h.rotation||0),o.forEach(function(i){i=r[i];i.movedLabel&&i.replaceMovedLabel(),i&&i.label&&i.label.textPxLength>g&&(g=i.label.textPxLength)}),this.maxLabelLength=g,this.autoRotation)m<g&&g>f.h?p.rotation=this.labelRotation:this.labelRotation=0;else if(d&&(n=m,!u))for(a="clip",i=o.length;!c&&i--;)t=o[i],(t=r[t].label)&&(t.styles&&"ellipsis"===t.styles.textOverflow?t.css({textOverflow:"clip"}):t.textPxLength>d&&t.css({width:d+"px"}),t.getBBox().height>this.len/o.length-(f.h-f.f)&&(t.specificTextOverflow="ellipsis"));p.rotation&&(n=g>.5*e.chartHeight?.33*e.chartHeight:g,u||(a="ellipsis")),this.labelAlign=h.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(p.align=this.labelAlign),o.forEach(function(i){var t=r[i],e=t&&t.label,s=l.width,i={};e&&(e.attr(p),t.shortenLabel?t.shortenLabel():n&&!s&&"nowrap"!==l.whiteSpace&&(n<e.textPxLength||"SPAN"===e.element.tagName)?(i.width=n+"px",u||(i.textOverflow=e.specificTextOverflow||a),e.css(i)):e.styles&&e.styles.width&&!i.width&&!s&&e.css({width:null}),delete e.specificTextOverflow,t.rotation=p.rotation)},this),this.tickRotCorr=s.rotCorr(f.b,this.labelRotation||0,0!==this.side)},i.prototype.hasData=function(){return this.series.some(function(i){return i.hasData()})||this.options.showEmpty&&defined(this.min)&&defined(this.max)},i.prototype.addTitle=function(i){var t,e=this,s=e.chart.renderer,n=e.horiz,a=e.opposite,o=e.options.title,r=e.chart.styledMode;e.axisTitle||(t=(t=o.textAlign)||(n?{low:"left",middle:"center",high:"right"}:{low:a?"right":"left",middle:"center",high:a?"left":"right"})[o.align],e.axisTitle=s.text(o.text||"",0,0,o.useHTML).attr({zIndex:7,rotation:o.rotation,align:t}).addClass("highcharts-axis-title"),r||e.axisTitle.css(merge(o.style)),e.axisTitle.add(e.axisGroup),e.axisTitle.isNew=!0),r||o.style.width||e.isRadial||e.axisTitle.css({width:e.len+"px"}),e.axisTitle[i?"show":"hide"](i)},i.prototype.generateTick=function(i){var t=this.ticks;t[i]?t[i].addLabel():t[i]=new Tick(this,i)},i.prototype.getOffset=function(){var i,t,s=this,e=this,n=e.chart,a=e.horiz,o=e.options,r=e.side,h=e.ticks,l=e.tickPositions,c=e.coll,d=e.axisParent,m=n.renderer,p=n.inverted&&!e.isZAxis?[1,0,3,2][r]:r,f=e.hasData(),u=o.title,g=o.labels,x=n.axisOffset,v=n.clipOffset,k=[-1,1,1,-1][r],M=o.className,y=0,T=0,b=0;e.showAxis=i=f||o.showEmpty,e.staggerLines=e.horiz&&g.staggerLines||void 0,e.axisGroup||(e.gridGroup=(n=function(i,t,e){return m.g(i).attr({zIndex:e}).addClass("highcharts-"+c.toLowerCase()+t+" "+(s.isRadial?"highcharts-radial-axis"+t+" ":"")+(M||"")).add(d)})("grid","-grid",o.gridZIndex),e.axisGroup=n("axis","",o.zIndex),e.labelGroup=n("axis-labels","-labels",g.zIndex)),f||e.isLinked?(l.forEach(function(i){e.generateTick(i)}),e.renderUnsquish(),e.reserveSpaceDefault=0===r||2===r||{1:"left",3:"right"}[r]===e.labelAlign,pick(g.reserveSpace,"center"===e.labelAlign||null,e.reserveSpaceDefault)&&l.forEach(function(i){b=Math.max(h[i].getLabelSize(),b)}),e.staggerLines&&(b*=e.staggerLines),e.labelOffset=b*(e.opposite?-1:1)):objectEach(h,function(i,t){i.destroy(),delete h[t]}),u&&u.text&&!1!==u.enabled&&(e.addTitle(i),i&&!1!==u.reserveSpace&&(e.titleOffset=y=e.axisTitle.getBBox()[a?"height":"width"],t=u.offset,T=defined(t)?0:pick(u.margin,a?5:10))),e.renderLine(),e.offset=k*pick(o.offset,x[r]?x[r]+(o.margin||0):0),e.tickRotCorr=e.tickRotCorr||{x:0,y:0},u=0===r?-e.labelMetrics().h:2===r?e.tickRotCorr.y:0,T=Math.abs(b)+T,b&&(T-=u,T+=k*(a?pick(g.y,e.tickRotCorr.y+8*k):g.x)),e.axisTitleMargin=pick(t,T),e.getMaxLabelDimensions&&(e.maxLabelDimensions=e.getMaxLabelDimensions(h,l)),"colorAxis"!==c&&(t=this.tickSize("tick"),x[r]=Math.max(x[r],(e.axisTitleMargin||0)+y+k*e.offset,T,l&&l.length&&t?t[0]+k*e.offset:0),o=!e.axisLine||o.offset?0:2*Math.floor(e.axisLine.strokeWidth()/2),v[p]=Math.max(v[p],o)),fireEvent(this,"afterGetOffset")},i.prototype.getLinePath=function(i){var t=this.chart,e=this.opposite,s=this.offset,n=this.horiz,a=this.left+(e?this.width:0)+s,s=t.chartHeight-this.bottom-(e?this.height:0)+s;return e&&(i*=-1),t.renderer.crispLine([["M",n?this.left:a,n?s:this.top],["L",n?t.chartWidth-this.right:a,n?s:t.chartHeight-this.bottom]],i)},i.prototype.renderLine=function(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))},i.prototype.getTitlePosition=function(){var i=this.horiz,t=this.left,e=this.top,s=this.len,n=this.options.title,a=i?t:e,o=this.opposite,r=this.offset,h=n.x,l=n.y,c=this.axisTitle,d=this.chart.renderer.fontMetrics(n.style.fontSize,c),c=Math.max(c.getBBox(null,0).height-d.h-1,0),n={low:a+(i?0:s),middle:a+s/2,high:a+(i?s:0)}[n.align],c=(i?e+this.height:t)+(i?1:-1)*(o?-1:1)*this.axisTitleMargin+[-c,c,d.f,-c][this.side],l={x:i?n+h:c+(o?this.width:0)+r+h,y:i?c+l-(o?this.height:0)+r:n+l};return fireEvent(this,"afterGetTitlePosition",{titlePosition:l}),l},i.prototype.renderMinorTick=function(i,t){var e=this.minorTicks;e[i]||(e[i]=new Tick(this,i,"minor")),t&&e[i].isNew&&e[i].render(null,!0),e[i].render(null,!1,1)},i.prototype.renderTick=function(i,t,e){var s=this,n=s.isLinked,a=s.ticks;(!n||i>=s.min&&i<=s.max||s.grid&&s.grid.isColumn)&&(a[i]||(a[i]=new Tick(s,i)),e&&a[i].isNew&&a[i].render(t,!0,-1),a[i].render(t))},i.prototype.render=function(){var e,s,n,a=this,o=a.chart,r=a.logarithmic,i=o.renderer,t=a.options,h=a.isLinked,l=a.tickPositions,c=a.axisTitle,d=a.ticks,m=a.minorTicks,p=a.alternateBands,f=t.stackLabels,u=t.alternateGridColor,g=a.tickmarkOffset,x=a.axisLine,v=a.showAxis,k=animObject(i.globalAnimation);a.labelEdge.length=0,a.overlap=!1,[d,m,p].forEach(function(i){objectEach(i,function(i){i.isActive=!1})}),(a.hasData()||h)&&(n=a.chart.hasRendered&&a.old&&isNumber(a.old.min),a.minorTickInterval&&!a.categories&&a.getMinorTickPositions().forEach(function(i){a.renderMinorTick(i,n)}),l.length&&(l.forEach(function(i,t){a.renderTick(i,t,n)}),g&&(0===a.min||a.single)&&(d[-1]||(d[-1]=new Tick(a,-1,null,!0)),d[-1].render(-1))),u&&l.forEach(function(i,t){s=void 0!==l[t+1]?l[t+1]+g:a.max-g,t%2==0&&i<a.max&&s<=a.max+(o.polar?-g:g)&&(p[i]||(p[i]=new H.PlotLineOrBand(a)),e=i+g,p[i].options={from:r?r.lin2log(e):e,to:r?r.lin2log(s):s,color:u,className:"highcharts-alternate-grid"},p[i].render(),p[i].isActive=!0)}),a._addedPlotLB||(a._addedPlotLB=!0,(t.plotLines||[]).concat(t.plotBands||[]).forEach(function(i){a.addPlotBandOrLine(i)}))),[d,m,p].forEach(function(t){var e=[],i=k.duration;objectEach(t,function(i,t){i.isActive||(i.render(t,!1,0),i.isActive=!1,e.push(t))}),syncTimeout(function(){for(var i=e.length;i--;)t[e[i]]&&!t[e[i]].isActive&&(t[e[i]].destroy(),delete t[e[i]])},t!==p&&o.hasRendered&&i?i:0)}),x&&(x[x.isPlaced?"animate":"attr"]({d:this.getLinePath(x.strokeWidth())}),x.isPlaced=!0,x[v?"show":"hide"](v)),c&&v&&(v=a.getTitlePosition(),isNumber(v.y)?(c[c.isNew?"attr":"animate"](v),c.isNew=!1):(c.attr("y",-9999),c.isNew=!0)),f&&f.enabled&&a.stacking&&a.stacking.renderStackTotals(),a.old={len:a.len,max:a.max,min:a.min,transA:a.transA,userMax:a.userMax,userMin:a.userMin},a.isDirty=!1,fireEvent(this,"afterRender")},i.prototype.redraw=function(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(i){i.render()})),this.series.forEach(function(i){i.isDirty=!0})},i.prototype.getKeepProps=function(){return this.keepProps||i.keepProps},i.prototype.destroy=function(i){var t,e=this,s=e.plotLinesAndBands,n=this.eventOptions;if(fireEvent(this,"destroy",{keepEvents:i}),i||removeEvent(e),[e.ticks,e.minorTicks,e.alternateBands].forEach(function(i){destroyObjectProperties(i)}),s)for(var a=s.length;a--;)s[a].destroy();for(t in["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(i){e[i]&&(e[i]=e[i].destroy())}),e.plotLinesAndBandsGroups)e.plotLinesAndBandsGroups[t]=e.plotLinesAndBandsGroups[t].destroy();objectEach(e,function(i,t){-1===e.getKeepProps().indexOf(t)&&delete e[t]}),this.eventOptions=n},i.prototype.drawCrosshair=function(i,t){var e,s,n,a=this.crosshair,o=pick(a&&a.snap,!0),r=this.chart,h=this.cross;if(fireEvent(this,"drawCrosshair",{e:i,point:t}),i=i||this.cross&&this.cross.e,a&&!1!==(defined(t)||!o)){if(o?defined(t)&&(s=pick("colorAxis"!==this.coll?t.crosshairPos:null,this.isXAxis?t.plotX:this.len-t.plotY)):s=i&&(this.horiz?i.chartX-this.pos:this.len-i.chartY+this.pos),defined(s)&&(n={value:t&&(this.isXAxis?t.x:pick(t.stackY,t.y)),translatedValue:s},r.polar&&extend(n,{isCrosshair:!0,chartX:i&&i.chartX,chartY:i&&i.chartY,point:t}),e=this.getPlotLinePath(n)||null),!defined(e))return void this.hideCrosshair();n=this.categories&&!this.isRadial,h||(this.cross=h=r.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(n?"category ":"thin ")+(a.className||"")).attr({zIndex:pick(a.zIndex,2)}).add(),r.styledMode||(h.attr({stroke:a.color||(n?Color.parse("#ccd6eb").setOpacity(.25).get():"#cccccc"),"stroke-width":pick(a.width,1)}).css({"pointer-events":"none"}),a.dashStyle&&h.attr({dashstyle:a.dashStyle}))),h.show().attr({d:e}),n&&!a.width&&h.attr({"stroke-width":this.transA}),this.cross.e=i}else this.hideCrosshair();fireEvent(this,"afterDrawCrosshair",{e:i,point:t})},i.prototype.hideCrosshair=function(){this.cross&&this.cross.hide(),fireEvent(this,"afterHideCrosshair")},i.prototype.hasVerticalPanning=function(){var i=this.chart.options.chart.panning;return Boolean(i&&i.enabled&&/y/.test(i.type))},i.prototype.validatePositiveValue=function(i){return isNumber(i)&&0<i},i.prototype.update=function(i,t){var e=this.chart;i=merge(this.userOptions,i),this.destroy(!0),this.init(e,i),e.isDirtyBox=!0,pick(t,!0)&&e.redraw()},i.prototype.remove=function(i){for(var t=this.chart,e=this.coll,s=this.series,n=s.length;n--;)s[n]&&s[n].remove(!1);erase(t.axes,this),erase(t[e],this),t[e].forEach(function(i,t){i.options.index=i.userOptions.index=t}),this.destroy(),t.isDirtyBox=!0,pick(i,!0)&&t.redraw()},i.prototype.setTitle=function(i,t){this.update({title:i},t)},i.prototype.setCategories=function(i,t){this.update({categories:i},t)},i.defaultOptions=AxisDefaults.defaultXAxisOptions,i.keepProps=["extKey","hcEvents","names","series","userMax","userMin"],i}();export default Axis;