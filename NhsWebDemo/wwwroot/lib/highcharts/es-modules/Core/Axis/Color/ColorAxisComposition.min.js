"use strict";import Color from"../../Color/Color.js";var color=Color.parse;import U from"../../Utilities.js";var ColorAxisComposition,addEvent=U.addEvent,extend=U.extend,merge=U.merge,pick=U.pick,splat=U.splat;!function(o){var n,l=[];function a(){var i=this,o=this.options;this.colorAxis=[],o.colorAxis&&(o.colorAxis=splat(o.colorAxis),o.colorAxis.forEach(function(o,t){o.index=t,new n(i,o)}))}function c(t){function i(o){-1!==(o=t.allItems.indexOf(o))&&(s.destroyItem(t.allItems[o]),t.allItems.splice(o,1))}var e,o,s=this,r=this.chart.colorAxis||[],n=[];for(r.forEach(function(o){(e=o.options)&&e.showInLegend&&(e.dataClasses&&e.visible?n=n.concat(o.getDataClassLegendSymbols()):e.visible&&n.push(o),o.series.forEach(function(o){o.options.showInLegend&&!e.dataClasses||("point"===o.options.legendType?o.points.forEach(function(o){i(o)}):i(o))}))}),o=n.length;o--;)t.allItems.unshift(n[o])}function h(o){o.visible&&o.item.legendColor&&o.item.legendSymbol.attr({fill:o.item.legendColor})}function p(){var o=this.chart.colorAxis;o&&o.forEach(function(o){o.update({},arguments[2])})}function d(){(this.chart.colorAxis&&this.chart.colorAxis.length||this.colorAttribs)&&this.translateColors()}function f(){var o=this.axisTypes;o?-1===o.indexOf("colorAxis")&&o.push("colorAxis"):this.axisTypes=["colorAxis"]}function x(o){var t=this,i=o?"show":"hide";t.visible=t.options.visible=Boolean(o),["graphic","dataLabel"].forEach(function(o){t[o]&&t[o][i]()}),this.series.buildKDTree()}function u(){var i=this,o=this.data.length?this.data:this.points,e=this.options.nullColor,s=this.colorAxis,r=this.colorKey;o.forEach(function(o){var t=o.getNestedProperty(r),t=o.options.color||(o.isNull||null===o.value?e:s&&void 0!==t?s.toColor(t,o):o.color||i.color);t&&o.color!==t&&(o.color=t,"point"===i.options.legendType&&o.legendItem&&i.chart.legend.colorizeItem(o,o.visible))})}function A(){this.elem.attr("fill",color(this.start).tweenTo(color(this.end),this.pos),void 0,!0)}function m(){this.elem.attr("stroke",color(this.start).tweenTo(color(this.end),this.pos),void 0,!0)}o.compose=function(o,t,i,e,s){var r;n=n||o,-1===l.indexOf(t)&&(l.push(t),(o=t.prototype).collectionsWithUpdate.push("colorAxis"),o.collectionsWithInit.colorAxis=[o.addColorAxis],addEvent(t,"afterGetAxes",a),r=t.prototype.createAxis,t.prototype.createAxis=function(o,t){if("colorAxis"!==o)return r.apply(this,arguments);o=new n(this,merge(t.axis,{index:this[o].length,isX:!1}));return this.isDirtyLegend=!0,this.axes.forEach(function(o){o.series=[]}),this.series.forEach(function(o){o.bindAxes(),o.isDirtyData=!0}),pick(t.redraw,!0)&&this.redraw(t.animation),o}),-1===l.indexOf(i)&&(l.push(i),(i=i.prototype).fillSetter=A,i.strokeSetter=m),-1===l.indexOf(e)&&(l.push(e),addEvent(e,"afterGetAllItems",c),addEvent(e,"afterColorizeItem",h),addEvent(e,"afterUpdate",p)),-1===l.indexOf(s)&&(l.push(s),extend(s.prototype,{optionalAxis:"colorAxis",translateColors:u}),extend(s.prototype.pointClass.prototype,{setVisible:x}),addEvent(s,"afterTranslate",d),addEvent(s,"bindAxes",f))},o.pointSetVisible=x}(ColorAxisComposition=ColorAxisComposition||{});export default ColorAxisComposition;