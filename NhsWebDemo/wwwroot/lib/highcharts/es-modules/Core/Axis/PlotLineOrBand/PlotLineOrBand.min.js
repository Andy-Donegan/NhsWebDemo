"use strict";import PlotLineOrBandAxis from"./PlotLineOrBandAxis.js";import U from"../../Utilities.js";var arrayMax=U.arrayMax,arrayMin=U.arrayMin,defined=U.defined,destroyObjectProperties=U.destroyObjectProperties,erase=U.erase,fireEvent=U.fireEvent,merge=U.merge,objectEach=U.objectEach,pick=U.pick,PlotLineOrBand=function(){function t(e,t){this.axis=e,t&&(this.options=t,this.id=t.id)}return t.compose=function(e){return PlotLineOrBandAxis.compose(t,e)},t.prototype.render=function(){fireEvent(this,"render");var r=this,e=r.axis,t=e.horiz,i=e.logarithmic,a=r.options,n=a.color,o=pick(a.zIndex,0),s=a.events,d={},l=e.chart.renderer,h=a.label,c=r.label,p=a.to,f=a.from,g=a.value,x=r.svgElem,y=[],u=defined(f)&&defined(p),b=defined(g),m=!x,v={class:"highcharts-plot-"+(u?"band ":"line ")+(a.className||"")},L=u?"bands":"lines";if(i&&(f=i.log2lin(f),p=i.log2lin(p),g=i.log2lin(g)),e.chart.styledMode||(b?(v.stroke=n||"#999999",v["stroke-width"]=pick(a.width,1),a.dashStyle&&(v.dashstyle=a.dashStyle)):u&&(v.fill=n||"#e6ebf5",a.borderWidth&&(v.stroke=a.borderColor,v["stroke-width"]=a.borderWidth))),d.zIndex=o,(n=e.plotLinesAndBandsGroups[L+="-"+o])||(e.plotLinesAndBandsGroups[L]=n=l.g("plot-"+L).attr(d).add()),m&&(r.svgElem=x=l.path().attr(v).add(n)),b)y=e.getPlotLinePath({value:g,lineWidth:x.strokeWidth(),acrossPanes:a.acrossPanes});else{if(!u)return;y=e.getPlotBandPath(f,p,a)}return!r.eventsAdded&&s&&(objectEach(s,function(e,t){x.on(t,function(e){s[t].apply(r,[e])})}),r.eventsAdded=!0),(m||!x.d)&&y&&y.length?x.attr({d:y}):x&&(y?(x.show(!0),x.animate({d:y})):x.d&&(x.hide(),c&&(r.label=c=c.destroy()))),h&&(defined(h.text)||defined(h.formatter))&&y&&y.length&&0<e.width&&0<e.height&&!y.isFlat?(h=merge({align:t&&u&&"center",x:t?!u&&4:10,verticalAlign:!t&&u&&"middle",y:t?u?16:10:u?6:-4,rotation:t&&!u&&90},h),this.renderLabel(h,y,u,o)):c&&c.hide(),r},t.prototype.renderLabel=function(e,t,r,i){var a=this,n=a.axis,o=n.chart.renderer,s=a.label;s||(a.label=s=o.text(this.getLabelText(e),0,0,e.useHTML).attr({align:e.textAlign||e.align,rotation:e.rotation,class:"highcharts-plot-"+(r?"band":"line")+"-label "+(e.className||""),zIndex:i}).add(),n.chart.styledMode||s.css(merge({textOverflow:"ellipsis"},e.style)));o=t.xBounds||[t[0][1],t[1][1],(r?t[2]:t[0])[1]],i=t.yBounds||[t[0][2],t[1][2],(r?t[2]:t[0])[2]],r=arrayMin(o),t=arrayMin(i);s.align(e,!1,{x:r,y:t,width:arrayMax(o)-r,height:arrayMax(i)-t}),s.alignValue&&"left"!==s.alignValue||s.css({width:(90===s.rotation?n.height-(s.alignAttr.y-n.top):n.width-(s.alignAttr.x-n.left))+"px"}),s.show(!0)},t.prototype.getLabelText=function(e){return defined(e.formatter)?e.formatter.call(this):e.text},t.prototype.destroy=function(){erase(this.axis.plotLinesAndBands,this),delete this.axis,destroyObjectProperties(this)},t}();export default PlotLineOrBand;