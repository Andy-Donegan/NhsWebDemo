"use strict";import A from"../Animation/AnimationUtilities.js";var getDeferredAnimation=A.getDeferredAnimation;import Axis from"./Axis.js";import U from"../Utilities.js";var StackingAxis,addEvent=U.addEvent,destroyObjectProperties=U.destroyObjectProperties,fireEvent=U.fireEvent,isNumber=U.isNumber,objectEach=U.objectEach;!function(t){var i=[];function e(){var e,t=this.stacking;t&&(e=t.stacks,objectEach(e,function(t,i){destroyObjectProperties(t),e[i]=null}),t&&t.stackTotalGroup&&t.stackTotalGroup.destroy())}function s(){var t=this;t.stacking||(t.stacking=new o(t))}t.compose=function(t){return-1===i.indexOf(t)&&(i.push(t),addEvent(t,"init",s),addEvent(t,"destroy",e)),t};var o=(a.prototype.buildStacks=function(){var t,i,e=this.axis,s=e.series,o=e.options.reversedStacks,a=s.length;if(!e.isXAxis){for(this.usePercentage=!1,i=a;i--;)(t=s[o?i:a-i-1]).setStackedPoints(),t.setGroupedPoints();for(i=0;i<a;i++)s[i].modifyStacks();fireEvent(e,"afterBuildStacks")}},a.prototype.cleanStacks=function(){var t,i=this;i.axis.isXAxis||(i.oldStacks&&(t=i.stacks=i.oldStacks),objectEach(t,function(t){objectEach(t,function(t){t.cumulative=t.total})}))},a.prototype.resetStacks=function(){var s=this,t=s.axis,i=s.stacks;t.isXAxis||objectEach(i,function(e){objectEach(e,function(t,i){isNumber(t.touched)&&t.touched<s.stacksTouched?(t.destroy(),delete e[i]):(t.total=null,t.cumulative=null)})})},a.prototype.renderStackTotals=function(){var t=this,i=t.axis,e=i.chart,s=e.renderer,o=t.stacks,i=i.options.stackLabels&&i.options.stackLabels.animation,i=getDeferredAnimation(e,i||!1),a=t.stackTotalGroup=t.stackTotalGroup||s.g("stack-labels").attr({visibility:"visible",zIndex:6,opacity:0}).add();a.translate(e.plotLeft,e.plotTop),objectEach(o,function(t){objectEach(t,function(t){t.render(a)})}),a.animate({opacity:1},i)},a);function a(t){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=t}t.Additions=o}(StackingAxis=StackingAxis||{});export default StackingAxis;