"use strict";var __extends=this&&this.__extends||function(){var o=function(e,r){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};return function(e,r){function t(){this.constructor=e}o(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();import SeriesRegistry from"../../../Core/Series/SeriesRegistry.js";var SMAIndicator=SeriesRegistry.seriesTypes.sma;import U from"../../../Core/Utilities.js";var error=U.error,isArray=U.isArray,merge=U.merge,VWAPIndicator=function(r){function e(){var e=null!==r&&r.apply(this,arguments)||this;return e.data=void 0,e.points=void 0,e.options=void 0,e}return __extends(e,r),e.prototype.getValues=function(e,r){var t=e.chart,o=e.xData,i=e.yData,s=r.period,a=!0;if(e=t.get(r.volumeSeriesID))return isArray(i[0])||(a=!1),this.calculateVWAPValues(a,o,i,e,s);error("Series "+r.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,t)},e.prototype.calculateVWAPValues=function(e,r,t,o,i){for(var s,a,n=o.yData,u=o.xData.length,o=r.length,p=[],c=[],l=[],d=[],f=[],y=o<=u?o:u,v=0,h=0;v<y;v++)a=e?(t[v][1]+t[v][2]+t[v][3])/3:t[v],a*=n[v],s=h?p[v-1]+a:a,a=h?c[v-1]+n[v]:n[v],p.push(s),c.push(a),f.push([r[v],s/a]),l.push(f[v][0]),d.push(f[v][1]),++h===i&&(h=0);return{values:f,xData:l,yData:d}},e.defaultOptions=merge(SMAIndicator.defaultOptions,{params:{index:void 0,period:30,volumeSeriesID:"volume"}}),e}(SMAIndicator);SeriesRegistry.registerSeriesType("vwap",VWAPIndicator);export default VWAPIndicator;