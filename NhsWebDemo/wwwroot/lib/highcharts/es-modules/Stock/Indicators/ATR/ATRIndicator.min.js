"use strict";var __extends=this&&this.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();import SeriesRegistry from"../../../Core/Series/SeriesRegistry.js";var SMAIndicator=SeriesRegistry.seriesTypes.sma;import U from"../../../Core/Utilities.js";var isArray=U.isArray,merge=U.merge;function accumulateAverage(t,e,r,i){e=e[i],i=r[i];t.push([e,i])}function getTR(t,e){var r=t,i=e,t=r[1]-r[2],e=void 0===i?0:Math.abs(r[1]-i[3]),i=void 0===i?0:Math.abs(r[2]-i[3]);return Math.max(t,e,i)}function populateAverage(t,e,r,i,o,a){return[e[i-1],(a*(o-1)+getTR(r[i-1],r[i-2]))/o]}var ATRIndicator=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=void 0,t.points=void 0,t.options=void 0,t}return __extends(t,e),t.prototype.getValues=function(t,e){var r,i,o=e.period,a=t.xData,n=t.yData,s=n?n.length:0,u=1,p=0,c=0,f=[],d=[],v=[],g=[[a[0],n[0]]];if(!(a.length<=o)&&isArray(n[0])&&4===n[0].length){for(i=1;i<=s;i++)accumulateAverage(g,a,n,i),o<u?(p=(r=populateAverage(g,a,n,i,o,p))[1],f.push(r),d.push(r[0]),v.push(r[1])):(o===u?(f.push([a[i-1],p=c/(i-1)]),d.push(a[i-1]),v.push(p)):c+=getTR(n[i-1],n[i-2]),u++);return{values:f,xData:d,yData:v}}},t.defaultOptions=merge(SMAIndicator.defaultOptions,{params:{index:void 0}}),t}(SMAIndicator);SeriesRegistry.registerSeriesType("atr",ATRIndicator);export default ATRIndicator;