"use strict";var __extends=this&&this.__extends||function(){var r=function(t,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(t,o)};return function(t,o){function e(){this.constructor=t}r(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}();import SeriesRegistry from"../../../Core/Series/SeriesRegistry.js";var SMAIndicator=SeriesRegistry.seriesTypes.sma;import U from"../../../Core/Utilities.js";var extend=U.extend,isArray=U.isArray,merge=U.merge,PriceEnvelopesIndicator=function(o){function t(){var t=null!==o&&o.apply(this,arguments)||this;return t.data=void 0,t.options=void 0,t.points=void 0,t}return __extends(t,o),t.prototype.init=function(){SeriesRegistry.seriesTypes.sma.prototype.init.apply(this,arguments),this.options=merge({topLine:{styles:{lineColor:this.color}},bottomLine:{styles:{lineColor:this.color}}},this.options)},t.prototype.toYData=function(t){return[t.top,t.middle,t.bottom]},t.prototype.translate=function(){var r=this,i=["plotTop","plotMiddle","plotBottom"];SeriesRegistry.seriesTypes.sma.prototype.translate.apply(r),r.points.forEach(function(e){[e.top,e.middle,e.bottom].forEach(function(t,o){null!==t&&(e[i[o]]=r.yAxis.toPixels(t,!0))})})},t.prototype.drawGraph=function(){for(var t,e=this,o=e.points,r=o.length,i=e.options,s=e.graph,p={options:{gapSize:i.gapSize}},n=[[],[]];r--;)t=o[r],n[0].push({plotX:t.plotX,plotY:t.plotTop,isNull:t.isNull}),n[1].push({plotX:t.plotX,plotY:t.plotBottom,isNull:t.isNull});["topLine","bottomLine"].forEach(function(t,o){e.points=n[o],e.options=merge(i[t].styles,p),e.graph=e["graph"+t],SeriesRegistry.seriesTypes.sma.prototype.drawGraph.call(e),e["graph"+t]=e.graph}),e.points=o,e.options=i,e.graph=s,SeriesRegistry.seriesTypes.sma.prototype.drawGraph.call(e)},t.prototype.getValues=function(t,o){var e,r,i,s,p,n=o.period,a=o.topBand,l=o.bottomBand,y=t.xData,d=t.yData,c=d?d.length:0,u=[],m=[],h=[];if(!(y.length<n)&&isArray(d[0])&&4===d[0].length){for(p=n;p<=c;p++)r=y.slice(p-n,p),i=d.slice(p-n,p),e=(s=SeriesRegistry.seriesTypes.sma.prototype.getValues.call(this,{xData:r,yData:i},o)).xData[0],r=s.yData[0],u.push([e,i=r*(1+a),r,s=r*(1-l)]),m.push(e),h.push([i,r,s]);return{values:u,xData:m,yData:h}}},t.defaultOptions=merge(SMAIndicator.defaultOptions,{marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span><b> {series.name}</b><br/>Top: {point.top}<br/>Middle: {point.middle}<br/>Bottom: {point.bottom}<br/>'},params:{period:20,topBand:.1,bottomBand:.1},bottomLine:{styles:{lineWidth:1,lineColor:void 0}},topLine:{styles:{lineWidth:1}},dataGrouping:{approximation:"averages"}}),t}(SMAIndicator);extend(PriceEnvelopesIndicator.prototype,{nameComponents:["period","topBand","bottomBand"],nameBase:"Price envelopes",pointArrayMap:["top","middle","bottom"],parallelArrays:["x","y","top","bottom"],pointValKey:"middle"}),SeriesRegistry.registerSeriesType("priceenvelopes",PriceEnvelopesIndicator);export default PriceEnvelopesIndicator;