"use strict";import H from"../Core/Globals.js";var doc=H.doc;import U from"../Core/Utilities.js";var attr=U.attr,css=U.css,merge=U.merge;import EventProvider from"./Utils/EventProvider.js";import ChartUtilities from"./Utils/ChartUtilities.js";var fireEventOnWrappedOrUnwrappedElement=ChartUtilities.fireEventOnWrappedOrUnwrappedElement;import HTMLUtilities from"./Utils/HTMLUtilities.js";var cloneMouseEvent=HTMLUtilities.cloneMouseEvent,cloneTouchEvent=HTMLUtilities.cloneTouchEvent,getFakeMouseEvent=HTMLUtilities.getFakeMouseEvent,removeElement=HTMLUtilities.removeElement,ProxyElement=function(){function t(t,e,i,o){this.chart=t,this.target=e;var r="ul"===(this.groupType=i);this.eventProvider=new EventProvider;var n=r?doc.createElement("li"):null,i=this.buttonElement=doc.createElement("button");t.styledMode||this.hideButtonVisually(i),n?(r&&!t.styledMode&&(n.style.listStyle="none"),n.appendChild(i),this.element=n):this.element=i,this.updateTarget(e,o)}return t.prototype.click=function(){var t=this.getTargetPosition();t.x+=t.width/2,t.y+=t.height/2;t=getFakeMouseEvent("click",t);fireEventOnWrappedOrUnwrappedElement(this.target.click,t)},t.prototype.updateTarget=function(t,e){this.target=t,this.updateCSSClassName(),attr(this.buttonElement,merge({"aria-label":this.getTargetAttr(t.click,"aria-label")},e)),this.eventProvider.removeAddedEvents(),this.addProxyEventsToButton(this.buttonElement,t.click),this.refreshPosition()},t.prototype.refreshPosition=function(){var t=this.getTargetPosition();css(this.buttonElement,{width:(t.width||1)+"px",height:(t.height||1)+"px",left:(Math.round(t.x)||0)+"px",top:(Math.round(t.y)||0)+"px"})},t.prototype.remove=function(){this.eventProvider.removeAddedEvents(),removeElement(this.element)},t.prototype.updateCSSClassName=function(){var t=function(t){return-1<t.indexOf("highcharts-no-tooltip")},e=this.chart.legend,e=e.group&&e.group.div,e=t(e&&e.className||""),t=t(this.getTargetAttr(this.target.click,"class")||"");this.buttonElement.className=e||t?"highcharts-a11y-proxy-button highcharts-no-tooltip":"highcharts-a11y-proxy-button"},t.prototype.addProxyEventsToButton=function(e,o){var r=this;["click","touchstart","touchend","touchcancel","touchmove","mouseover","mouseenter","mouseleave","mouseout"].forEach(function(t){var i=0===t.indexOf("touch");r.eventProvider.addEvent(e,t,function(t){var e=(i?cloneTouchEvent:cloneMouseEvent)(t);o&&fireEventOnWrappedOrUnwrappedElement(o,e),t.stopPropagation(),i||t.preventDefault()},{passive:!1})})},t.prototype.hideButtonVisually=function(t){css(t,{borderWidth:0,backgroundColor:"transparent",cursor:"pointer",outline:"none",opacity:.001,filter:"alpha(opacity=1)",zIndex:999,overflow:"hidden",padding:0,margin:0,display:"block",position:"absolute","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=1)"})},t.prototype.getTargetPosition=function(){var t=this.target.click,e=t.element||t,t=this.target.visual||e,e=this.chart.renderTo;if(e&&t&&t.getBoundingClientRect){t=t.getBoundingClientRect(),e=e.getBoundingClientRect();return{x:t.left-e.left,y:t.top-e.top,width:t.right-t.left,height:t.bottom-t.top}}return{x:0,y:0,width:1,height:1}},t.prototype.getTargetAttr=function(t,e){return(t.element||t).getAttribute(e)},t}();export default ProxyElement;