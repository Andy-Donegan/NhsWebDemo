"use strict";import Chart from"../Core/Chart/Chart.js";import H from"../Core/Globals.js";var doc=H.doc;import U from"../Core/Utilities.js";var addEvent=U.addEvent,extend=U.extend,isNumber=U.isNumber,merge=U.merge,objectEach=U.objectEach,pick=U.pick;import"./MapNavigationOptionsDefault.js";function stopEvent(t){t&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)}function MapNavigation(t){this.init(t)}MapNavigation.prototype.init=function(t){(this.chart=t).mapNavButtons=[]},MapNavigation.prototype.update=function(t){function n(t){this.handler.call(r,t),stopEvent(t)}var a,s,h,r=this.chart,l=r.options.mapNavigation,d=r.mapNavButtons;for(t&&(l=r.options.mapNavigation=merge(r.options.mapNavigation,t));d.length;)d.pop().destroy();pick(l.enableButtons,l.enabled)&&!r.renderer.forExport&&objectEach(l.buttons,function(t,e){t=merge(l.buttonOptions,t),!r.styledMode&&t.theme&&((a=t.theme).style=merge(t.theme.style,t.style),h=a.states,s=h&&h.hover,h=h&&h.select,delete a.states);var o,i=r.renderer.button(t.text||"",0,0,n,a,s,h,void 0,"zoomIn"===e?"topbutton":"bottombutton").addClass("highcharts-map-navigation highcharts-"+{zoomIn:"zoom-in",zoomOut:"zoom-out"}[e]).attr({width:t.width,height:t.height,title:r.options.lang[e],padding:t.padding,zIndex:5}).add();i.handler=t.onclick,addEvent(i.element,"dblclick",stopEvent),d.push(i),extend(t,{width:i.width,height:2*i.height}),r.hasLoaded?i.align(t,!1,t.alignTo):o=addEvent(r,"load",function(){i.element&&i.align(t,!1,t.alignTo),o()})}),this.updateEvents(l)},MapNavigation.prototype.updateEvents=function(t){var e=this.chart;pick(t.enableDoubleClickZoom,t.enabled)||t.enableDoubleClickZoomTo?this.unbindDblClick=this.unbindDblClick||addEvent(e.container,"dblclick",function(t){e.pointer.onContainerDblClick(t)}):this.unbindDblClick&&(this.unbindDblClick=this.unbindDblClick()),pick(t.enableMouseWheelZoom,t.enabled)?this.unbindMouseWheel=this.unbindMouseWheel||addEvent(e.container,void 0!==doc.onwheel?"wheel":void 0!==doc.onmousewheel?"mousewheel":"DOMMouseScroll",function(t){return e.pointer.inClass(t.target,"highcharts-no-mousewheel")||(e.pointer.onContainerMouseWheel(t),stopEvent(t)),!1}):this.unbindMouseWheel&&(this.unbindMouseWheel=this.unbindMouseWheel())},extend(Chart.prototype,{fitToBox:function(o,i){return[["x","width"],["y","height"]].forEach(function(t){var e=t[0],t=t[1];o[e]+o[t]>i[e]+i[t]&&(o[t]>i[t]?(o[t]=i[t],o[e]=i[e]):o[e]=i[e]+i[t]-o[t]),o[t]>i[t]&&(o[t]=i[t]),o[e]<i[e]&&(o[e]=i[e])}),o},mapZoom:function(t,e,o,i,n){this.mapView&&(isNumber(t)&&(t=Math.log(t)/Math.log(.5)),this.mapView.zoomBy(t,isNumber(e)&&isNumber(o)?this.mapView.projection.inverse([e,o]):void 0,isNumber(i)&&isNumber(n)?[i,n]:void 0))}}),addEvent(Chart,"beforeRender",function(){this.mapNavigation=new MapNavigation(this),this.mapNavigation.update()}),H.MapNavigation=MapNavigation;