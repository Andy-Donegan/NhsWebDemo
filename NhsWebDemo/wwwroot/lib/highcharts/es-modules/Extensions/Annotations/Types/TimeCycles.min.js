"use strict";var __extends=this&&this.__extends||function(){var n=function(t,o){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)o.hasOwnProperty(i)&&(t[i]=o[i])})(t,o)};return function(t,o){function i(){this.constructor=t}n(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();import Annotation from"../Annotations.js";import CrookedLine from"./CrookedLine.js";import ControlPoint from"../ControlPoint.js";import U from"../../../Core/Utilities.js";var merge=U.merge,isNumber=U.isNumber,defined=U.defined;function getStartingPath(t,o){return["M",t,o]}function getCirclePath(t,o,i,n){for(var e=[],r=1;r<=o;r++)e.push(["A",t/2,t/2,0,1,1,i+r*t,n]);return e}var TimeCycles=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.init=function(t,o,i){defined(o.yAxis)&&o.points.forEach(function(t){t.yAxis=o.yAxis}),defined(o.xAxis)&&o.points.forEach(function(t){t.xAxis=o.xAxis}),n.prototype.init.call(this,t,o,i)},t.prototype.setPath=function(){this.shapes[0].options.d=this.getPath()},t.prototype.getPath=function(){return[getStartingPath(this.startX,this.y)].concat(getCirclePath(this.pixelInterval,this.numberOfCircles,this.startX,this.y))},t.prototype.addShapes=function(){var t=this.options.typeOptions;this.setPathProperties();var o=this.initShape(merge(t.line,{type:"path",d:this.getPath(),points:this.options.points}),0);t.line=o.options},t.prototype.addControlPoints=function(){var o=this,i=this.options,t=i.typeOptions;i.controlPointOptions.style.cursor=this.chart.inverted?"ns-resize":"ew-resize",t.controlPointOptions.forEach(function(t){t=merge(i.controlPointOptions,t),t=new ControlPoint(o.chart,o,t,0);o.controlPoints.push(t)})},t.prototype.setPathProperties=function(){var t,o,i,n=this.options.typeOptions,e=n.points;e&&(t=e[0],i=e[1],o=n.xAxis||0,e=n.yAxis||0,n=this.chart.xAxis[o],o=this.chart.yAxis[e],e=t.x,t=t.y,i=i.x,e&&i&&(t=isNumber(t)?o.toPixels(t):o.top+o.height,o=isNumber(e)?n.toPixels(e):n.left,e=isNumber(i)?n.toPixels(i):n.left+30,i=n.len,e=Math.round(Math.max(Math.abs(e-o),2)),i=Math.floor(i/e)+2,n=(Math.floor((o-n.left)/e)+1)*e,this.startX=o-n,this.y=t,this.pixelInterval=e,this.numberOfCircles=i))},t.prototype.redraw=function(t){this.setPathProperties(),this.setPath(),n.prototype.redraw.call(this,t)},t}(CrookedLine);TimeCycles.prototype.defaultOptions=merge(CrookedLine.prototype.defaultOptions,{typeOptions:{controlPointOptions:[{positioner:function(t){var o=t.points[0];return{x:t.anchor(o).absolutePosition.x-this.graphic.width/2,y:t.y-this.graphic.height}},events:{drag:function(t,o){var i=o.anchor(o.points[0]).absolutePosition;o.translatePoint(t.chartX-i.x,0,0),o.redraw(!1)}}},{positioner:function(t){var o=t.points[1];return{x:t.anchor(o).absolutePosition.x-this.graphic.width/2,y:t.y-this.graphic.height}},events:{drag:function(t,o){var i=o.anchor(o.points[1]).absolutePosition;o.translatePoint(t.chartX-i.x,0,1),o.redraw(!1)}}}]}});export default Annotation.types.timeCycles=TimeCycles;