"use strict";import A from"../Core/Animation/AnimationUtilities.js";var stop=A.stop;import Axis from"../Core/Axis/Axis.js";import Chart from"../Core/Chart/Chart.js";import Series from"../Core/Series/Series.js";import RendererRegistry from"../Core/Renderer/RendererRegistry.js";import U from"../Core/Utilities.js";var addEvent=U.addEvent,createElement=U.createElement,merge=U.merge,pick=U.pick;addEvent(Chart,"afterSetChartSize",function(t){var h,i=this.options.chart.scrollablePlotArea,e=i&&i.minWidth,i=i&&i.minHeight;this.renderer.forExport||(e?(this.scrollablePixelsX=e=Math.max(0,e-this.chartWidth),e&&(this.scrollablePlotBox=this.renderer.scrollablePlotBox=merge(this.plotBox),this.plotBox.width=this.plotWidth+=e,this.inverted?this.clipBox.height+=e:this.clipBox.width+=e,h={1:{name:"right",value:e}})):i&&(this.scrollablePixelsY=i=Math.max(0,i-this.chartHeight),i&&(this.scrollablePlotBox=this.renderer.scrollablePlotBox=merge(this.plotBox),this.plotBox.height=this.plotHeight+=i,this.inverted?this.clipBox.width+=i:this.clipBox.height+=i,h={2:{name:"bottom",value:i}})),h&&!t.skipAxes&&this.axes.forEach(function(s){h[s.side]?s.getPlotLinePath=function(){var t=h[s.side].name,i=h[s.side].value,e=this[t];return this[t]=e-i,i=Axis.prototype.getPlotLinePath.apply(this,arguments),this[t]=e,i}:(s.setAxisSize(),s.setAxisTranslation())}))}),addEvent(Chart,"render",function(){this.scrollablePixelsX||this.scrollablePixelsY?(this.setUpScrolling&&this.setUpScrolling(),this.applyFixed()):this.fixedDiv&&this.applyFixed()}),Chart.prototype.setUpScrolling=function(){var t=this,i={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};this.scrollablePixelsX&&(i.overflowX="auto"),this.scrollablePixelsY&&(i.overflowY="auto"),this.scrollingParent=createElement("div",{className:"highcharts-scrolling-parent"},{position:"relative"},this.renderTo),this.scrollingContainer=createElement("div",{className:"highcharts-scrolling"},i,this.scrollingParent),addEvent(this.scrollingContainer,"scroll",function(){t.pointer&&delete t.pointer.chartPosition}),this.innerContainer=createElement("div",{className:"highcharts-inner-container"},null,this.scrollingContainer),this.innerContainer.appendChild(this.container),this.setUpScrolling=null},Chart.prototype.moveFixedElements=function(){var t,i=this.container,e=this.fixedRenderer,s=[".highcharts-contextbutton",".highcharts-credits",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-reset-zoom",".highcharts-drillup-button",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];this.scrollablePixelsX&&!this.inverted?t=".highcharts-yaxis":this.scrollablePixelsX&&this.inverted||this.scrollablePixelsY&&!this.inverted?t=".highcharts-xaxis":this.scrollablePixelsY&&this.inverted&&(t=".highcharts-yaxis"),t&&s.push(t+":not(.highcharts-radial-axis)",t+"-labels:not(.highcharts-radial-axis-labels)"),s.forEach(function(t){[].forEach.call(i.querySelectorAll(t),function(t){(t.namespaceURI===e.SVG_NS?e.box:e.box.parentNode).appendChild(t),t.style.pointerEvents="auto"})})},Chart.prototype.applyFixed=function(){var t=!this.fixedDiv,i=this.options.chart,e=i.scrollablePlotArea,s=RendererRegistry.getRendererType();t?(this.fixedDiv=createElement("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(i.style&&i.style.zIndex||0)+2,top:0},null,!0),this.scrollingContainer&&this.scrollingContainer.parentNode.insertBefore(this.fixedDiv,this.scrollingContainer),this.renderTo.style.overflow="visible",this.fixedRenderer=h=new s(this.fixedDiv,this.chartWidth,this.chartHeight,this.options.chart.style),this.scrollableMask=h.path().attr({fill:this.options.chart.backgroundColor||"#fff","fill-opacity":pick(e.opacity,.85),zIndex:-1}).addClass("highcharts-scrollable-mask").add(),addEvent(this,"afterShowResetZoom",this.moveFixedElements),addEvent(this,"afterDrilldown",this.moveFixedElements),addEvent(this,"afterLayOutTitles",this.moveFixedElements)):this.fixedRenderer.setSize(this.chartWidth,this.chartHeight),(this.scrollableDirty||t)&&(this.scrollableDirty=!1,this.moveFixedElements()),r=this.chartWidth+(this.scrollablePixelsX||0),i=this.chartHeight+(this.scrollablePixelsY||0),stop(this.container),this.container.style.width=r+"px",this.container.style.height=i+"px",this.renderer.boxWrapper.attr({width:r,height:i,viewBox:[0,0,r,i].join(" ")}),this.chartBackground.attr({width:r,height:i}),this.scrollingContainer.style.height=this.chartHeight+"px",t&&(e.scrollPositionX&&(this.scrollingContainer.scrollLeft=this.scrollablePixelsX*e.scrollPositionX),e.scrollPositionY&&(this.scrollingContainer.scrollTop=this.scrollablePixelsY*e.scrollPositionY));var s=this.axisOffset,h=this.plotTop-s[0]-1,r=this.plotLeft-s[3]-1,i=this.plotTop+this.plotHeight+s[2]+1,t=this.plotLeft+this.plotWidth+s[1]+1,e=this.plotLeft+this.plotWidth-(this.scrollablePixelsX||0),s=this.plotTop+this.plotHeight-(this.scrollablePixelsY||0),s=this.scrollablePixelsX?[["M",0,h],["L",this.plotLeft-1,h],["L",this.plotLeft-1,i],["L",0,i],["Z"],["M",e,h],["L",this.chartWidth,h],["L",this.chartWidth,i],["L",e,i],["Z"]]:this.scrollablePixelsY?[["M",r,0],["L",r,this.plotTop-1],["L",t,this.plotTop-1],["L",t,0],["Z"],["M",r,s],["L",r,this.chartHeight],["L",t,this.chartHeight],["L",t,s],["Z"]]:[["M",0,0]];"adjustHeight"!==this.redrawTrigger&&this.scrollableMask.attr({d:s})},addEvent(Axis,"afterInit",function(){this.chart.scrollableDirty=!0}),addEvent(Series,"show",function(){this.chart.scrollableDirty=!0});