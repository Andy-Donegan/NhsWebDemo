"use strict";import Axis from"../Core/Axis/Axis.js";import Chart from"../Core/Chart/Chart.js";import H from"../Core/Globals.js";import D from"../Core/DefaultOptions.js";var defaultOptions=D.defaultOptions;import SVGElement from"../Core/Renderer/SVG/SVGElement.js";import U from"../Core/Utilities.js";var addEvent=U.addEvent,createElement=U.createElement,css=U.css,defined=U.defined,destroyObjectProperties=U.destroyObjectProperties,discardElement=U.discardElement,extend=U.extend,find=U.find,fireEvent=U.fireEvent,isNumber=U.isNumber,merge=U.merge,objectEach=U.objectEach,pad=U.pad,pick=U.pick,pInt=U.pInt,splat=U.splat;extend(defaultOptions,{rangeSelector:{allButtonsEnabled:!1,buttons:void 0,buttonSpacing:5,dropdown:"responsive",enabled:void 0,verticalAlign:"top",buttonTheme:{width:28,height:18,padding:2,zIndex:7},floating:!1,x:0,y:0,height:void 0,inputBoxBorderColor:"none",inputBoxHeight:17,inputBoxWidth:void 0,inputDateFormat:"%b %e, %Y",inputDateParser:void 0,inputEditDateFormat:"%Y-%m-%d",inputEnabled:!0,inputPosition:{align:"right",x:0,y:0},inputSpacing:5,selected:void 0,buttonPosition:{align:"left",x:0,y:0},inputStyle:{color:"#335cad",cursor:"pointer"},labelStyle:{color:"#666666"}}}),extend(defaultOptions.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"",rangeSelectorTo:"→"});var chartDestroyEvents_1,initRangeSelector_1,RangeSelector=function(){function n(t){this.buttons=void 0,this.buttonOptions=n.prototype.defaultButtons,this.initialButtonGroupWidth=0,this.options=void 0,this.chart=t,this.init(t)}return n.prototype.clickButton=function(t,e){var i,n,o,a,r,s=this,p=s.chart,h=s.buttonOptions[t],d=p.xAxis[0],u=p.scroller&&p.scroller.getUnionExtremes()||d||{},l=u.dataMin,c=u.dataMax,g=d&&Math.round(Math.min(d.max,pick(c,d.max))),m=h.type,x=h._range,u=h.dataGrouping;if(null!==l&&null!==c){if(p.fixedRange=x,s.setSelected(t),u&&(this.forcedDataGrouping=!0,Axis.prototype.setDataGrouping.call(d||{chart:this.chart},u,!1),this.frozenStates=h.preserveDataGrouping),"month"===m||"year"===m)d?(u={range:h,max:g,chart:p,dataMin:l,dataMax:c},i=d.minFromRange.call(u),isNumber(u.newMax)&&(g=u.newMax)):x=h;else if(x)i=Math.max(g-x,l),g=Math.min(i+x,c);else if("ytd"===m){if(!d)return void(s.deferredYTDClick=t);void 0===c&&(l=Number.MAX_VALUE,c=Number.MIN_VALUE,p.series.forEach(function(t){t=t.xData;l=Math.min(t[0],l),c=Math.max(t[t.length-1],c)}),e=!1),i=o=(s=s.getYTDExtremes(c,l,p.time.useUTC)).min,g=s.max}else"all"===m&&d&&(p.navigator&&p.navigator.baseSeries[0]&&(p.navigator.baseSeries[0].xAxis.options.range=void 0),i=l,g=c);defined(i)&&(i+=h._offsetMin),defined(g)&&(g+=h._offsetMax),this.dropdown&&(this.dropdown.selectedIndex=t+1),d?d.setExtremes(i,g,pick(e,!0),void 0,{trigger:"rangeSelectorButton",rangeSelectorButton:h}):(n=splat(p.options.xAxis)[0],r=n.range,n.range=x,a=n.min,n.min=o,addEvent(p,"load",function(){n.range=r,n.min=a})),fireEvent(this,"afterBtnClick")}},n.prototype.setSelected=function(t){this.selected=this.options.selected=t},n.prototype.init=function(e){function t(){var t=i.minInput,e=i.maxInput;t&&t.blur&&fireEvent(t,"blur"),e&&e.blur&&fireEvent(e,"blur")}var i=this,n=e.options.rangeSelector,o=n.buttons||i.defaultButtons.slice(),a=n.selected;i.chart=e,i.options=n,i.buttons=[],i.buttonOptions=o,this.eventsToUnbind=[],this.eventsToUnbind.push(addEvent(e.container,"mousedown",t)),this.eventsToUnbind.push(addEvent(e,"resize",t)),o.forEach(i.computeButtonRange),void 0!==a&&o[a]&&this.clickButton(a,!1),this.eventsToUnbind.push(addEvent(e,"load",function(){e.xAxis&&e.xAxis[0]&&addEvent(e.xAxis[0],"setExtremes",function(t){this.max-this.min!==e.fixedRange&&"rangeSelectorButton"!==t.trigger&&"updatedData"!==t.trigger&&i.forcedDataGrouping&&!i.frozenStates&&this.setDataGrouping(!1,!1)})}))},n.prototype.updateButtonStates=function(){var l=this,t=this.chart,c=this.dropdown,g=t.xAxis[0],m=Math.round(g.max-g.min),x=!g.hasVisibleSeries,e=t.scroller&&t.scroller.getUnionExtremes()||g,f=e.dataMin,b=e.dataMax,t=l.getYTDExtremes(b,f,t.time.useUTC),v=t.min,y=t.max,B=l.selected,E=isNumber(B),S=l.options.allButtonsEnabled,w=l.buttons;l.buttonOptions.forEach(function(t,e){var i=t._range,n=t.type,o=t.count||1,a=w[e],r=0,s=t._offsetMax-t._offsetMin,p=e===B,h=i<g.minRange,d=!1,u=!1,t=i===m;("month"===n||"year"===n)&&864e5*{month:28,year:365}[n]*o-s<=m+36e5&&m-36e5<=864e5*{month:31,year:366}[n]*o+s?t=!0:"ytd"===n?(t=y-v+s===m,d=!p):"all"===n&&(t=g.max-g.min>=b-f,u=!p&&E&&t),p=p&&t||t&&!E&&!d||p&&l.frozenStates,(u=!S&&(b-f<i||h||u||x))?r=3:p&&(E=!0,r=2),a.state!==r&&(a.setState(r),c&&(c.options[e+1].disabled=u,2===r&&(c.selectedIndex=e+1)),0===r&&B===e&&l.setSelected())})},n.prototype.computeButtonRange=function(t){var e=t.type,i=t.count||1,n={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5};n[e]?t._range=n[e]*i:"month"!==e&&"year"!==e||(t._range=24*{month:30,year:365}[e]*36e5*i),t._offsetMin=pick(t.offsetMin,0),t._offsetMax=pick(t.offsetMax,0),t._range+=t._offsetMax-t._offsetMin},n.prototype.getInputValue=function(t){var e="min"===t?this.minInput:this.maxInput,i=this.chart.options.rangeSelector,t=this.chart.time;return e?("text"===e.type&&i.inputDateParser||this.defaultInputDateParser)(e.value,t.useUTC,t):0},n.prototype.setInputValue=function(t,e){var i,n=this.options,o=this.chart.time,a="min"===t?this.minInput:this.maxInput,r="min"===t?this.minDateBox:this.maxDateBox;a&&(i=a.getAttribute("data-hc-time"),t=defined(i)?Number(i):void 0,defined(e)&&(defined(i=t)&&a.setAttribute("data-hc-time-previous",i),a.setAttribute("data-hc-time",e),t=e),a.value=o.dateFormat(this.inputTypeFormats[a.type]||n.inputEditDateFormat,t),r&&r.attr({text:o.dateFormat(n.inputDateFormat,t)}))},n.prototype.setInputExtremes=function(t,e,i){var n,o="min"===t?this.minInput:this.maxInput;o&&(n=this.inputTypeFormats[o.type],t=this.chart.time,n&&(e=t.dateFormat(n,e),o.min!==e&&(o.min=e),i=t.dateFormat(n,i),o.max!==i&&(o.max=i)))},n.prototype.showInput=function(t){var e,i,n,o="min"===t?this.minDateBox:this.maxDateBox,a="min"===t?this.minInput:this.maxInput;a&&o&&this.inputGroup&&(e="text"===a.type,i=(n=this.inputGroup).translateX,t=n.translateY,n=this.options.inputBoxWidth,css(a,{width:e?o.width+(n?-2:20)+"px":"auto",height:e?o.height-2+"px":"auto",border:"2px solid silver"}),css(a,e&&n?{left:i+o.x+"px",top:t+"px"}:{left:Math.min(Math.round(o.x+i-(a.offsetWidth-o.width)/2),this.chart.chartWidth-a.offsetWidth)+"px",top:t-(a.offsetHeight-o.height)/2+"px"}))},n.prototype.hideInput=function(t){t="min"===t?this.minInput:this.maxInput;t&&css(t,{top:"-9999em",border:0,width:"1px",height:"1px"})},n.prototype.defaultInputDateParser=function(t,e,i){var n,o=t.split("/").join("-").split(" ").join("T");-1===o.indexOf("T")&&(o+="T00:00"),e?o+="Z":!H.isSafari||6<(n=o).length&&(n.lastIndexOf("-")===n.length-6||n.lastIndexOf("+")===n.length-6)||(o+=(a=new Date(o).getTimezoneOffset()/60)<=0?"+"+pad(-a)+":00":"-"+pad(a)+":00");var a=Date.parse(o);return isNumber(a)||(t=t.split("-"),a=Date.UTC(pInt(t[0]),pInt(t[1])-1,pInt(t[2]))),i&&e&&isNumber(a)&&(a+=i.getTimezoneOffset(a)),a},n.prototype.drawInput=function(r){var s=this.chart,t=this.div,e=this.inputGroup,p=this,i=s.renderer.style||{},n=s.renderer,o=s.options.rangeSelector,a=defaultOptions.lang,h="min"===r;function d(){var t=p.getInputValue(r),e=s.xAxis[0],i=s.scroller&&s.scroller.xAxis?s.scroller.xAxis:e,n=i.dataMin,o=i.dataMax,a=p.maxInput,i=p.minInput;t!==Number(u.getAttribute("data-hc-time-previous"))&&isNumber(t)&&(u.setAttribute("data-hc-time-previous",t),h&&a&&isNumber(n)?t>Number(a.getAttribute("data-hc-time"))?t=void 0:t<n&&(t=n):i&&isNumber(o)&&(t<Number(i.getAttribute("data-hc-time"))?t=void 0:o<t&&(t=o)),void 0!==t&&e.setExtremes(h?t:e.min,h?e.max:t,void 0,void 0,{trigger:"rangeSelectorInput"}))}a=a[h?"rangeSelectorFrom":"rangeSelectorTo"]||"",a=n.label(a,0).addClass("highcharts-range-label").attr({padding:a?2:0,height:a?o.inputBoxHeight:0}).add(e),n=n.label("",0).addClass("highcharts-range-input").attr({padding:2,width:o.inputBoxWidth,height:o.inputBoxHeight,"text-align":"center"}).on("click",function(){p.showInput(r),p[r+"Input"].focus()});s.styledMode||n.attr({stroke:o.inputBoxBorderColor,"stroke-width":1}),n.add(e);var u=createElement("input",{name:r,className:"highcharts-range-selector"},void 0,t);u.setAttribute("type",preferredInputType(o.inputDateFormat||"%b %e, %Y")),s.styledMode||(a.css(merge(i,o.labelStyle)),n.css(merge({color:"#333333"},i,o.inputStyle)),css(u,extend({position:"absolute",border:0,boxShadow:"0 0 15px rgba(0,0,0,0.3)",width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:i.fontSize,fontFamily:i.fontFamily,top:"-9999em"},o.inputStyle))),u.onfocus=function(){p.showInput(r)};var l=!(u.onblur=function(){u===H.doc.activeElement&&d(),p.hideInput(r),p.setInputValue(r),u.blur()});return u.onchange=function(){l||(d(),p.hideInput(r),u.blur())},u.onkeypress=function(t){13===t.keyCode&&d()},u.onkeydown=function(t){l=!0,38!==t.keyCode&&40!==t.keyCode||d()},u.onkeyup=function(){l=!1},{dateBox:n,input:u,label:a}},n.prototype.getPosition=function(){var t=this.chart,e=t.options.rangeSelector,t="top"===e.verticalAlign?t.plotTop-t.axisOffset[0]:0;return{buttonTop:t+e.buttonPosition.y,inputTop:t+e.inputPosition.y-10}},n.prototype.getYTDExtremes=function(t,e,i){var n=this.chart.time,o=new n.Date(t),a=n.get("FullYear",o),a=i?n.Date.UTC(a,0,1):+new n.Date(a,0,1),a=Math.max(e,a),o=o.getTime();return{max:Math.min(t||o,o),min:a}},n.prototype.render=function(t,e){var i,n=this.chart,o=n.renderer,a=n.container,r=n.options,s=r.rangeSelector,p=pick(r.chart.style&&r.chart.style.zIndex,0)+1,h=s.inputEnabled,r=this.rendered;!1!==s.enabled&&(r||(this.group=o.g("range-selector-group").attr({zIndex:7}).add(),this.div=createElement("div",void 0,{position:"relative",height:0,zIndex:p}),this.buttonOptions.length&&this.renderButtons(),a.parentNode&&a.parentNode.insertBefore(this.div,a),h&&(this.inputGroup=o.g("input-group").add(this.group),o=this.drawInput("min"),this.minDateBox=o.dateBox,this.minLabel=o.label,this.minInput=o.input,o=this.drawInput("max"),this.maxDateBox=o.dateBox,this.maxLabel=o.label,this.maxInput=o.input)),h&&(this.setInputValue("min",t),this.setInputValue("max",e),e=n.scroller&&n.scroller.getUnionExtremes()||n.xAxis[0]||{},defined(e.dataMin)&&defined(e.dataMax)&&(n=n.xAxis[0].minRange||0,this.setInputExtremes("min",e.dataMin,Math.min(e.dataMax,this.getInputValue("max"))-n),this.setInputExtremes("max",Math.max(e.dataMin,this.getInputValue("min"))+n,e.dataMax)),this.inputGroup&&(i=0,[this.minLabel,this.minDateBox,this.maxLabel,this.maxDateBox].forEach(function(t){var e;!t||(e=t.getBBox().width)&&(t.attr({x:i}),i+=e+s.inputSpacing)}))),this.alignElements(),this.rendered=!0)},n.prototype.renderButtons=function(){var a=this,r=this.buttons,t=this.chart,e=this.options,i=defaultOptions.lang,s=t.renderer,p=merge(e.buttonTheme),h=p&&p.states,d=p.width||28;delete p.width,delete p.states,this.buttonGroup=s.g("range-selector-buttons").add(this.group);var u=this.dropdown=createElement("select",void 0,{position:"absolute",width:"1px",height:"1px",padding:0,border:0,top:"-9999em",cursor:"pointer",opacity:1e-4},this.div);addEvent(u,"touchstart",function(){u.style.fontSize="16px"}),[[H.isMS?"mouseover":"mouseenter"],[H.isMS?"mouseout":"mouseleave"],["change","click"]].forEach(function(t){var e=t[0],i=t[1];addEvent(u,e,function(){var t=r[a.currentButtonIndex()];t&&fireEvent(t.element,i||e)})}),this.zoomText=s.label(i&&i.rangeSelectorZoom||"",0).attr({padding:e.buttonTheme.padding,height:e.buttonTheme.height,paddingLeft:0,paddingRight:0}).add(this.buttonGroup),this.chart.styledMode||(this.zoomText.css(e.labelStyle),p["stroke-width"]=pick(p["stroke-width"],0)),createElement("option",{textContent:this.zoomText.textStr,disabled:!0},void 0,u),this.buttonOptions.forEach(function(n,o){createElement("option",{textContent:n.title||n.text},void 0,u),r[o]=s.button(n.text,0,0,function(t){var e,i=n.events&&n.events.click;!1!==(e=i?i.call(n,t):e)&&a.clickButton(o),a.isActive=!0},p,h&&h.hover,h&&h.select,h&&h.disabled).attr({"text-align":"center",width:d}).add(a.buttonGroup),n.title&&r[o].attr("title",n.title)})},n.prototype.alignElements=function(){function t(t,e){return l&&n.titleCollision(r)&&"top"===m&&"right"===e.align&&e.y-t.getBBox().height-12<(l.y||0)+(l.height||0)+r.spacing[0]?-40:0}var i,n=this,e=this,o=e.buttonGroup,a=e.buttons,r=e.chart,s=e.group,p=e.inputGroup,h=e.options,d=e.zoomText,u=r.options,l=u.exporting&&!1!==u.exporting.enabled&&u.navigation&&u.navigation.buttonOptions,c=h.buttonPosition,g=h.inputPosition,m=h.verticalAlign,e=r.plotLeft;s&&c&&g&&(u=c.x-r.spacing[3],o&&(this.positionButtons(),this.initialButtonGroupWidth||(i=0,d&&(i+=d.getBBox().width+5),a.forEach(function(t,e){i+=t.width,e!==a.length-1&&(i+=h.buttonSpacing)}),this.initialButtonGroupWidth=i),e-=r.spacing[3],this.updateButtonStates(),d=t(o,c),this.alignButtonGroup(d),s.placed=o.placed=r.hasLoaded),o=0,p&&(o=t(p,g),"left"===g.align?u=e:"right"===g.align&&(u=-Math.max(r.axisOffset[1],-o)),p.align({y:g.y,width:p.getBBox().width,align:g.align,x:g.x+u-2},!0,r.spacingBox),p.placed=r.hasLoaded),this.handleCollision(o),s.align({verticalAlign:m},!0,r.spacingBox),e=s.alignAttr.translateY,u=s.getBBox().height+20,p=0,"bottom"===m&&(p=e-(u=u+((o=r.legend&&r.legend.options)&&"bottom"===o.verticalAlign&&o.enabled&&!o.floating?r.legend.legendHeight+pick(o.margin,10):0)-20)-(h.floating?0:h.y)-(r.titleOffset?r.titleOffset[2]:0)-10),"top"===m?(h.floating&&(p=0),r.titleOffset&&r.titleOffset[0]&&(p=r.titleOffset[0]),p+=r.margin[0]-r.spacing[0]||0):"middle"===m&&(g.y===c.y?p=e:(g.y||c.y)&&(g.y<0||c.y<0?p-=Math.min(g.y,c.y):p=e-u)),s.translate(h.x,h.y+Math.floor(p)),e=this.minInput,u=this.maxInput,p=this.dropdown,h.inputEnabled&&e&&u&&(e.style.marginTop=s.translateY+"px",u.style.marginTop=s.translateY+"px"),p&&(p.style.marginTop=s.translateY+"px"))},n.prototype.alignButtonGroup=function(t,e){var i=this.chart,n=this.options,o=this.buttonGroup,a=(this.buttons,n.buttonPosition),r=i.plotLeft-i.spacing[3],n=a.x-i.spacing[3];"right"===a.align?n+=t-r:"center"===a.align&&(n-=r/2),o&&o.align({y:a.y,width:pick(e,this.initialButtonGroupWidth),align:a.align,x:n},!0,i.spacingBox)},n.prototype.positionButtons=function(){var i=this.buttons,t=this.chart,n=this.options,e=this.zoomText,o=t.hasLoaded?"animate":"attr",a=n.buttonPosition,r=t.plotLeft,s=r;e&&"hidden"!==e.visibility&&(e[o]({x:pick(r+a.x,r)}),s+=a.x+e.getBBox().width+5),this.buttonOptions.forEach(function(t,e){"hidden"!==i[e].visibility?(i[e][o]({x:s}),s+=i[e].width+n.buttonSpacing):i[e][o]({x:r})})},n.prototype.handleCollision=function(o){function t(){var e=0;return i.buttons.forEach(function(t){t=t.getBBox();t.width>e&&(e=t.width)}),e}function e(t){if(r&&a){var e=r.alignAttr.translateX+r.alignOptions.x-o+r.getBBox().x+2,i=r.alignOptions.width,n=a.alignAttr.translateX+a.getBBox().x;return e<n+t&&n<e+i&&p.y<d.y+r.getBBox().height}}var i=this,n=this.chart,a=this.buttonGroup,r=this.inputGroup,s=this.options,p=s.buttonPosition,h=s.dropdown,d=s.inputPosition,s=function(){r&&a&&r.attr({translateX:r.alignAttr.translateX+(n.axisOffset[1]>=-o?0:-o),translateY:r.alignAttr.translateY+a.getBBox().height+10})};if(a){if("always"===h)return this.collapseButtons(o),void(e(t())&&s());"never"===h&&this.expandButtons()}r&&a?d.align===p.align||e(this.initialButtonGroupWidth+20)?"responsive"===h?(this.collapseButtons(o),e(t())&&s()):s():"responsive"===h&&this.expandButtons():a&&"responsive"===h&&(this.initialButtonGroupWidth>n.plotWidth?this.collapseButtons(o):this.expandButtons())},n.prototype.collapseButtons=function(t){function i(t){return{text:t?t+" ▾":"▾",width:"auto",paddingLeft:pick(s.buttonTheme.paddingLeft,p.padding,8),paddingRight:pick(s.buttonTheme.paddingRight,p.padding,8)}}var e=this,n=e.buttons,o=e.buttonOptions,a=e.chart,r=e.dropdown,s=e.options,e=e.zoomText,p=a.userOptions.rangeSelector&&a.userOptions.rangeSelector.buttonTheme||{};e&&e.hide();var h=!1;o.forEach(function(t,e){e=n[e];2!==e.state?e.hide():(e.show(),e.attr(i(t.text)),h=!0)}),h||(r&&(r.selectedIndex=0),n[0].show(),n[0].attr(i(this.zoomText&&this.zoomText.textStr)));r=s.buttonPosition.align;this.positionButtons(),"right"!==r&&"center"!==r||this.alignButtonGroup(t,n[this.currentButtonIndex()].getBBox().width),this.showDropdown()},n.prototype.expandButtons=function(){var i=this.buttons,t=this.buttonOptions,n=this.options,e=this.zoomText;this.hideDropdown(),e&&e.show(),t.forEach(function(t,e){e=i[e];e.show(),e.attr({text:t.text,width:n.buttonTheme.width||28,paddingLeft:pick(n.buttonTheme.paddingLeft,"unset"),paddingRight:pick(n.buttonTheme.paddingRight,"unset")}),e.state<2&&e.setState(0)}),this.positionButtons()},n.prototype.currentButtonIndex=function(){var t=this.dropdown;return t&&0<t.selectedIndex?t.selectedIndex-1:0},n.prototype.showDropdown=function(){var t,e=this.buttonGroup,i=this.buttons,n=this.chart,o=this.dropdown;e&&o&&(t=e.translateX,e=e.translateY,i=i[this.currentButtonIndex()].getBBox(),css(o,{left:n.plotLeft+t+"px",top:e+.5+"px",width:i.width+"px",height:i.height+"px"}),this.hasVisibleDropdown=!0)},n.prototype.hideDropdown=function(){var t=this.dropdown;t&&(css(t,{top:"-9999em",width:"1px",height:"1px"}),this.hasVisibleDropdown=!1)},n.prototype.getHeight=function(){var t=this.options,e=this.group,i=t.inputPosition,n=t.buttonPosition,o=t.y,a=n.y,n=i.y,i=0;return t.height||(this.alignElements(),i=e?e.getBBox(!0).height+13+o:0,o=Math.min(n,a),(n<0&&a<0||0<n&&0<a)&&(i+=Math.abs(o)),i)},n.prototype.titleCollision=function(t){return!(t.options.title.text||t.options.subtitle.text)},n.prototype.update=function(t){var e=this.chart;merge(!0,e.options.rangeSelector,t),this.destroy(),this.init(e),this.render()},n.prototype.destroy=function(){var i=this,t=i.minInput,e=i.maxInput;i.eventsToUnbind&&(i.eventsToUnbind.forEach(function(t){return t()}),i.eventsToUnbind=void 0),destroyObjectProperties(i.buttons),t&&(t.onfocus=t.onblur=t.onchange=null),e&&(e.onfocus=e.onblur=e.onchange=null),objectEach(i,function(t,e){t&&"chart"!==e&&(t instanceof SVGElement?t.destroy():t instanceof window.HTMLElement&&discardElement(t)),t!==n.prototype[e]&&(i[e]=null)},this)},n}();function preferredInputType(e){if(-1!==e.indexOf("%L"))return"text";var t=["a","A","d","e","w","b","B","m","o","y","Y"].some(function(t){return-1!==e.indexOf("%"+t)}),i=["H","k","I","l","M","S"].some(function(t){return-1!==e.indexOf("%"+t)});return t&&i?"datetime-local":t?"date":i?"time":"text"}RangeSelector.prototype.defaultButtons=[{type:"month",count:1,text:"1m",title:"View 1 month"},{type:"month",count:3,text:"3m",title:"View 3 months"},{type:"month",count:6,text:"6m",title:"View 6 months"},{type:"ytd",text:"YTD",title:"View year to date"},{type:"year",count:1,text:"1y",title:"View 1 year"},{type:"all",text:"All",title:"View all"}],RangeSelector.prototype.inputTypeFormats={"datetime-local":"%Y-%m-%dT%H:%M:%S",date:"%Y-%m-%d",time:"%H:%M:%S"},Axis.prototype.minFromRange=function(){function t(t,e){var i="year"===a?"FullYear":"Month",n=new s.Date(t),o=s.get(i,n);return s.set(i,n,o+e),o===s.get(i,n)&&s.set("Date",n,0),n.getTime()-t}var e,i,n,o=this.range,a=o.type,r=this.max,s=this.chart.time;return isNumber(o)?(e=r-o,n=o):(e=r+t(r,-o.count),this.chart&&(this.chart.fixedRange=r-e)),i=pick(this.dataMin,Number.MIN_VALUE),(e=!isNumber(e)?i:e)<=i&&(e=i,void 0===n&&(n=t(e,o.count)),this.newMax=Math.min(e+n,this.dataMax)),e=!isNumber(r)?void 0:e},H.RangeSelector||(chartDestroyEvents_1=[],initRangeSelector_1=function(e){var t,i,n,o=e.rangeSelector;function a(){o&&(t=e.xAxis[0].getExtremes(),i=e.legend,n=o&&o.options.verticalAlign,isNumber(t.min)&&o.render(t.min,t.max),i.display&&"top"===n&&n===i.options.verticalAlign&&(n=merge(e.spacingBox),"vertical"===i.options.layout?n.y=e.plotTop:n.y+=o.getHeight(),i.group.placed=!1,i.align(n)))}o&&(find(chartDestroyEvents_1,function(t){return t[0]===e})||chartDestroyEvents_1.push([e,[addEvent(e.xAxis[0],"afterSetExtremes",function(t){o&&o.render(t.min,t.max)}),addEvent(e,"redraw",a)]]),a())},addEvent(Chart,"afterGetContainer",function(){this.options.rangeSelector&&this.options.rangeSelector.enabled&&(this.rangeSelector=new RangeSelector(this))}),addEvent(Chart,"beforeRender",function(){var t=this.axes,e=this.rangeSelector;e&&(isNumber(e.deferredYTDClick)&&(e.clickButton(e.deferredYTDClick),delete e.deferredYTDClick),t.forEach(function(t){t.updateNames(),t.setScale()}),this.getAxisMargins(),e.render(),t=e.options.verticalAlign,e.options.floating||("bottom"===t?this.extraBottomMargin=!0:"middle"!==t&&(this.extraTopMargin=!0)))}),addEvent(Chart,"update",function(t){var e=t.options.rangeSelector,i=this.rangeSelector,n=this.extraBottomMargin,t=this.extraTopMargin;e&&e.enabled&&!defined(i)&&this.options.rangeSelector&&(this.options.rangeSelector.enabled=!0,this.rangeSelector=i=new RangeSelector(this)),this.extraBottomMargin=!1,this.extraTopMargin=!1,i&&(initRangeSelector_1(this),e=e&&e.verticalAlign||i.options&&i.options.verticalAlign,i.options.floating||("bottom"===e?this.extraBottomMargin=!0:"middle"!==e&&(this.extraTopMargin=!0)),this.extraBottomMargin===n&&this.extraTopMargin===t||(this.isDirtyBox=!0))}),addEvent(Chart,"render",function(){var t=this.rangeSelector;t&&!t.options.floating&&(t.render(),"bottom"===(t=t.options.verticalAlign)?this.extraBottomMargin=!0:"middle"!==t&&(this.extraTopMargin=!0))}),addEvent(Chart,"getMargins",function(){var t=this.rangeSelector;t&&(t=t.getHeight(),this.extraTopMargin&&(this.plotTop+=t),this.extraBottomMargin&&(this.marginBottom+=t))}),Chart.prototype.callbacks.push(initRangeSelector_1),addEvent(Chart,"destroy",function(){for(var t=0;t<chartDestroyEvents_1.length;t++){var e=chartDestroyEvents_1[t];if(e[0]===this)return e[1].forEach(function(t){return t()}),void chartDestroyEvents_1.splice(t,1)}}),H.RangeSelector=RangeSelector);export default RangeSelector;