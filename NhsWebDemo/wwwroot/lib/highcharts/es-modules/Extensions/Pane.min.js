"use strict";import Chart from"../Core/Chart/Chart.js";import CU from"../Series/CenteredUtilities.js";import H from"../Core/Globals.js";import Pointer from"../Core/Pointer.js";import U from"../Core/Utilities.js";var addEvent=U.addEvent,extend=U.extend,merge=U.merge,pick=U.pick,splat=U.splat;Chart.prototype.collectionsWithUpdate.push("pane");var Pane=function(){function t(t,e){this.background=void 0,this.center=void 0,this.chart=void 0,this.options=void 0,this.coll="pane",this.defaultOptions={center:["50%","50%"],size:"85%",innerSize:"0%",startAngle:0},this.defaultBackgroundOptions={shape:"circle",borderWidth:1,borderColor:"#cccccc",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#ffffff"],[1,"#e6e6e6"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"},this.init(t,e)}return t.prototype.init=function(t,e){this.chart=e,this.background=[],e.pane.push(this),this.setOptions(t)},t.prototype.setOptions=function(t){this.options=t=merge(this.defaultOptions,this.chart.angular?{background:{}}:void 0,t)},t.prototype.render=function(){var t,e,r=this.options,o=this.options.background,i=this.chart.renderer;if(this.group||(this.group=i.g("pane-group").attr({zIndex:r.zIndex||0}).add()),this.updateCenter(),o)for(o=splat(o),t=Math.max(o.length,this.background.length||0),e=0;e<t;e++)o[e]&&this.axis?this.renderBackground(merge(this.defaultBackgroundOptions,o[e]),e):this.background[e]&&(this.background[e]=this.background[e].destroy(),this.background.splice(e,1))},t.prototype.renderBackground=function(t,e){var r="animate",o={class:"highcharts-pane "+(t.className||"")};this.chart.styledMode||extend(o,{fill:t.backgroundColor,stroke:t.borderColor,"stroke-width":t.borderWidth}),this.background[e]||(this.background[e]=this.chart.renderer.path().add(this.group),r="attr"),this.background[e][r]({d:this.axis.getPlotBandPath(t.from,t.to,t)}).attr(o)},t.prototype.updateCenter=function(t){this.center=(t||this.axis||{}).center=CU.getCenter.call(this)},t.prototype.update=function(t,e){merge(!0,this.options,t),this.setOptions(this.options),this.render(),this.chart.axes.forEach(function(t){t.pane===this&&(t.pane=null,t.update({},e))},this)},t}();function isInsidePane(t,e,r){return Math.sqrt(Math.pow(t-r[0],2)+Math.pow(e-r[1],2))<=r[2]/2}Chart.prototype.getHoverPane=function(o){var i,n=this;return o&&n.pane.forEach(function(t){var e=o.chartX-n.plotLeft,r=o.chartY-n.plotTop;isInsidePane(n.inverted?r:e,n.inverted?e:r,t.center)&&(i=t)}),i},addEvent(Chart,"afterIsInsidePlot",function(e){this.polar&&(e.isInsidePlot=this.pane.some(function(t){return isInsidePane(e.x,e.y,t.center)}))}),addEvent(Pointer,"beforeGetHoverData",function(e){var r=this.chart;r.polar?(r.hoverPane=r.getHoverPane(e),e.filter=function(t){return t.visible&&!(!e.shared&&t.directTouch)&&pick(t.options.enableMouseTracking,!0)&&(!r.hoverPane||t.xAxis.pane===r.hoverPane)}):r.hoverPane=void 0}),addEvent(Pointer,"afterGetHoverData",function(t){var e=this.chart;t.hoverPoint&&t.hoverPoint.plotX&&t.hoverPoint.plotY&&e.hoverPane&&!isInsidePane(t.hoverPoint.plotX,t.hoverPoint.plotY,e.hoverPane.center)&&(t.hoverPoint=void 0)}),H.Pane=Pane;export default H.Pane;