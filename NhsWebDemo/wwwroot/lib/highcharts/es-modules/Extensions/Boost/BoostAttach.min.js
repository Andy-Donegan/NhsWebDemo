"use strict";import Chart from"../../Core/Chart/Chart.js";import GLRenderer from"./WGLRenderer.js";import H from"../../Core/Globals.js";var doc=H.doc;import U from"../../Core/Utilities.js";var mainCanvas,error=U.error;function createAndAttachRenderer(e,r){var t=e.chartWidth,o=e.chartHeight,a=e,n=e.seriesGroup||r.group,a=(doc.implementation.hasFeature("www.http://w3.org/TR/SVG11/feature#Extensibility","1.1"),e.isChartSeriesBoosting()?e:r);return mainCanvas=mainCanvas||doc.createElement("canvas"),a.renderTarget||(a.canvas=mainCanvas,e.renderer.forExport,a.renderTarget=e.renderer.image("",0,0,t,o).addClass("highcharts-boost-canvas").add(n),a.boostClear=function(){a.renderTarget.attr({href:""})},a.boostCopy=function(){a.boostResizeTarget(),a.renderTarget.attr({href:a.canvas.toDataURL("image/png")})},a.boostResizeTarget=function(){t=e.chartWidth,o=e.chartHeight,(a.renderTargetFo||a.renderTarget).attr({x:0,y:0,width:t,height:o}).css({pointerEvents:"none",mixedBlendMode:"normal",opacity:1}),a instanceof Chart&&a.markerGroup.translate(e.plotLeft,e.plotTop)},a.boostClipRect=e.renderer.clipRect(),(a.renderTargetFo||a.renderTarget).clip(a.boostClipRect),a instanceof Chart&&(a.markerGroup=a.renderer.g().add(n),a.markerGroup.translate(r.xAxis.pos,r.yAxis.pos))),a.canvas.width=t,a.canvas.height=o,a.boostClipRect.attr(e.getBoostClipRect(a)),a.boostResizeTarget(),a.boostClear(),a.ogl||(a.ogl=GLRenderer(function(){a.ogl.settings.debug.timeBufferCopy&&console.time("buffer copy"),a.boostCopy(),a.ogl.settings.debug.timeBufferCopy&&console.timeEnd("buffer copy")}),a.ogl.init(a.canvas)||error("[highcharts boost] - unable to init WebGL renderer"),a.ogl.setOptions(e.options.boost||{}),a instanceof Chart&&a.ogl.allocateBuffer(e)),a.ogl.setSize(t,o),a.ogl}export default createAndAttachRenderer;