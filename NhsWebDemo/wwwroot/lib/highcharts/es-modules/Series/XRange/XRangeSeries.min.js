"use strict";var __extends=this&&this.__extends||function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();import H from"../../Core/Globals.js";import Color from"../../Core/Color/Color.js";var color=Color.parse;import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";var Series=SeriesRegistry.series,ColumnSeries=SeriesRegistry.seriesTypes.column,columnProto=ColumnSeries.prototype;import U from"../../Core/Utilities.js";var clamp=U.clamp,correctFloat=U.correctFloat,defined=U.defined,extend=U.extend,find=U.find,isNumber=U.isNumber,isObject=U.isObject,merge=U.merge,pick=U.pick;import XRangePoint from"./XRangePoint.js";import"./XRangeComposition.js";var XRangeSeries=function(o){function t(){var t=null!==o&&o.apply(this,arguments)||this;return t.data=void 0,t.options=void 0,t.points=void 0,t}return __extends(t,o),t.prototype.init=function(){ColumnSeries.prototype.init.apply(this,arguments),this.options.stacking=void 0},t.prototype.getColumnMetrics=function(){var t,e=this.chart;function i(){e.series.forEach(function(t){var e=t.xAxis;t.xAxis=t.yAxis,t.yAxis=e})}return i(),t=columnProto.getColumnMetrics.call(this),i(),t},t.prototype.cropData=function(t,e,i,o){o=Series.prototype.cropData.call(this,this.x2Data,e,i,o);return o.xData=t.slice(o.start,o.end),o},t.prototype.findPointIndex=function(e){var t,i,o=this,r=o.cropped,n=o.cropStart,o=o.points,a=e.id;return void 0===(t=a?(i=find(o,function(t){return t.id===a}))?i.index:void 0:t)&&(t=(i=find(o,function(t){return t.x===e.x&&t.x2===e.x2&&!t.touched}))?i.index:void 0),r&&isNumber(t)&&isNumber(n)&&n<=t&&(t-=n),t},t.prototype.translatePoint=function(t){var e=this,i=e.xAxis,o=e.yAxis,r=e.columnMetrics,n=e.options,a=n.minPointLength||0,s=(t.shapeArgs&&t.shapeArgs.width||0)/2,p=e.pointXOffset=r.offset,l=t.plotX,c=pick(t.x2,t.x+(t.len||0)),d=i.translate(c,0,0,0,1),h=Math.abs(d-l),u=this.chart.inverted,m=pick(n.borderWidth,1)%2/2,f=r.offset,c=Math.round(r.width);a&&(l-=(a=(a=a-h)<0?0:a)/2,d+=a/2),l=Math.max(l,-10),d=clamp(d,-10,i.len+10),defined(t.options.pointWidth)&&(f-=(Math.ceil(t.options.pointWidth)-c)/2,c=Math.ceil(t.options.pointWidth)),n.pointPlacement&&isNumber(t.plotY)&&o.categories&&(t.plotY=o.translate(t.y,0,1,0,1,n.pointPlacement));n=Math.floor(Math.min(l,d))+m,d=Math.floor(Math.max(l,d))+m,c={x:n,y:Math.floor(t.plotY+f)+m,width:d-n,height:c,r:e.options.borderRadius};t.shapeArgs=c,u?t.tooltipPos[1]+=p+s:t.tooltipPos[0]-=s+p-c.width/2,p=(s=c.x)+c.width,s<0||p>i.len?(s=clamp(s,0,i.len),p=clamp(p,0,i.len),t.dlBox=merge(c,{x:s,width:g=p-s,centerX:g?g/2:null})):t.dlBox=null;var p=t.tooltipPos,s=u?1:0,g=u?0:1,r=e.columnMetrics?e.columnMetrics.offset:-r.width/2;p[s]+=u?c.width/2:(i.reversed?-1:0)*c.width,p[g]=clamp(p[g]+(u?-1:1)*r,0,o.len-1),(o=t.partialFill)&&(isObject(o)&&(o=o.amount),isNumber(o)||(o=0),t.partShapeArgs=merge(c,{r:e.options.borderRadius}),l=Math.max(Math.round(h*o+t.plotX-l),0),t.clipRectArgs={x:i.reversed?c.x+h-l:c.x,y:c.y,width:l,height:c.height})},t.prototype.translate=function(){columnProto.translate.apply(this,arguments),this.points.forEach(function(t){this.translatePoint(t)},this)},t.prototype.drawPoint=function(t,e){var i=this,o=i.options,r=i.chart.renderer,n=t.graphic,a=t.shapeType,s=t.shapeArgs,p=t.partShapeArgs,l=t.clipRectArgs,c=t.partialFill,d=o.stacking&&!o.borderRadius,h=t.state,u=o.states[h||"normal"]||{},m=void 0===h?"attr":e,h=i.pointAttribs(t,h),u=pick(i.chart.options.chart.animation,u.animation);t.isNull||!1===t.visible?n&&(t.graphic=n.destroy()):(n?n.rect[e](s):(t.graphic=n=r.g("point").addClass(t.getClassName()).add(t.group||i.group),n.rect=r[a](merge(s)).addClass(t.getClassName()).addClass("highcharts-partfill-original").add(n)),p&&(n.partRect?(n.partRect[e](merge(p)),n.partialClipRect[e](merge(l))):(n.partialClipRect=r.clipRect(l.x,l.y,l.width,l.height),n.partRect=r[a](p).addClass("highcharts-partfill-overlay").add(n).clip(n.partialClipRect))),i.chart.styledMode||(n.rect[e](h,u).shadow(o.shadow,null,d),p&&(isObject(c)||(c={}),i=(c=isObject(o.partialFill)?merge(o.partialFill,c):c).fill||color(h.fill).brighten(-.3).get()||color(t.color||i.color).brighten(-.3).get(),h.fill=i,n.partRect[m](h,u).shadow(o.shadow,null,d))))},t.prototype.drawPoints=function(){var e=this,i=e.getAnimationVerb();e.points.forEach(function(t){e.drawPoint(t,i)})},t.prototype.getAnimationVerb=function(){return this.chart.pointCount<(this.options.animationLimit||250)?"animate":"attr"},t.prototype.isPointInside=function(t){var e=t.shapeArgs,i=t.plotX,t=t.plotY;return e?void 0!==i&&void 0!==t&&0<=t&&t<=this.yAxis.len&&0<=(e.x||0)+(e.width||0)&&i<=this.xAxis.len:o.prototype.isPointInside.apply(this,arguments)},t.defaultOptions=merge(ColumnSeries.defaultOptions,{colorByPoint:!0,dataLabels:{formatter:function(){var t=this.point.partialFill;if(isObject(t)&&(t=t.amount),isNumber(t)&&0<t)return correctFloat(100*t)+"%"},inside:!0,verticalAlign:"middle"},tooltip:{headerFormat:'<span style="font-size: 10px">{point.x} - {point.x2}</span><br/>',pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.yCategory}</b><br/>'},borderRadius:3,pointRange:0}),t}(ColumnSeries);extend(XRangeSeries.prototype,{type:"xrange",parallelArrays:["x","x2","y"],requireSorting:!1,animate:Series.prototype.animate,cropShoulder:1,getExtremesFromAll:!0,autoIncrement:H.noop,buildKDTree:H.noop,pointClass:XRangePoint}),SeriesRegistry.registerSeriesType("xrange",XRangeSeries);export default XRangeSeries;