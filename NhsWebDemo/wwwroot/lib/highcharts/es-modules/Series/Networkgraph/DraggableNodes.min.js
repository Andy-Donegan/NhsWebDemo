"use strict";import Chart from"../../Core/Chart/Chart.js";import H from"../../Core/Globals.js";import U from"../../Core/Utilities.js";var addEvent=U.addEvent;H.dragNodesMixin={onMouseDown:function(o,t){t=this.chart.pointer.normalize(t);o.fixedPosition={chartX:t.chartX,chartY:t.chartY,plotX:o.plotX,plotY:o.plotY},o.inDragMode=!0},onMouseMove:function(o,t){var e,i,a,r,n;o.fixedPosition&&o.inDragMode&&(n=(e=this.chart).pointer.normalize(t),i=o.fixedPosition.chartX-n.chartX,a=o.fixedPosition.chartY-n.chartY,t=r=void 0,n=e.graphLayoutsLookup,(5<Math.abs(i)||5<Math.abs(a))&&(r=o.fixedPosition.plotX-i,t=o.fixedPosition.plotY-a,e.isInsidePlot(r,t)&&(o.plotX=r,o.plotY=t,o.hasDragged=!0,this.redrawHalo(o),n.forEach(function(o){o.restartSimulation()}))))},onMouseUp:function(o,t){o.fixedPosition&&(o.hasDragged&&(this.layout.enableSimulation?this.layout.start():this.chart.redraw()),o.inDragMode=o.hasDragged=!1,this.options.fixedDraggable||delete o.fixedPosition)},redrawHalo:function(o){o&&this.halo&&this.halo.attr({d:o.haloPath(this.options.states.hover.halo.size)})}},addEvent(Chart,"load",function(){var o,e,i,a=this;a.container&&(o=addEvent(a.container,"mousedown",function(o){var t=a.hoverPoint;t&&t.series&&t.series.hasDraggableNodes&&t.series.options.draggable&&(t.series.onMouseDown(t,o),e=addEvent(a.container,"mousemove",function(o){return t&&t.series&&t.series.onMouseMove(t,o)}),i=addEvent(a.container.ownerDocument,"mouseup",function(o){return e(),i(),t&&t.series&&t.series.onMouseUp(t,o)}))})),addEvent(a,"destroy",function(){o()})});