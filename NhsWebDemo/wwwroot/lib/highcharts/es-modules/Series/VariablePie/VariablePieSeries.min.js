"use strict";var __extends=this&&this.__extends||function(){var a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";var PieSeries=SeriesRegistry.seriesTypes.pie;import U from"../../Core/Utilities.js";var arrayMax=U.arrayMax,arrayMin=U.arrayMin,clamp=U.clamp,extend=U.extend,fireEvent=U.fireEvent,merge=U.merge,pick=U.pick,VariablePieSeries=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=void 0,t.options=void 0,t.points=void 0,t.radii=void 0,t}return __extends(t,e),t.prototype.calculateExtremes=function(){var t=this,e=t.chart,i=e.plotWidth,a=e.plotHeight,r=t.options,n=2*(r.slicedOffset||0),e=t.zData,o=Math.min(i,a)-n,s={},n=t.center||t.getCenter();["minPointSize","maxPointSize"].forEach(function(t){var e=r[t],i=/%$/.test(e),e=parseInt(e,10);s[t]=i?o*e/100:2*e}),t.minPxSize=n[3]+s.minPointSize,t.maxPxSize=clamp(n[2],n[3]+s.minPointSize,s.maxPointSize),e.length&&(n=pick(r.zMin,arrayMin(e.filter(t.zValEval))),e=pick(r.zMax,arrayMax(e.filter(t.zValEval))),this.getRadii(n,e,t.minPxSize,t.maxPxSize))},t.prototype.getRadii=function(t,e,i,a){for(var r,n,o=0,s=this.zData,l=s.length,p=[],c="radius"!==this.options.sizeBy,h=e-t;o<l;o++)n=(r=this.zValEval(s[o])?s[o]:t)<=t?i/2:e<=r?a/2:(n=0<h?(r-t)/h:.5,c&&(n=Math.sqrt(n)),Math.ceil(i+n*(a-i))/2),p.push(n);this.radii=p},t.prototype.redraw=function(){this.center=null,e.prototype.redraw.apply(this,arguments)},t.prototype.translate=function(t){this.generatePoints();var e,i,a,r,n,o,s,l=this,p=0,c=1e3,h=l.options,d=h.slicedOffset,y=d+(h.borderWidth||0),f=h.startAngle||0,u=Math.PI/180*(f-90),f=Math.PI/180*(pick(h.endAngle,f+360)-90),M=f-u,P=l.points,m=h.dataLabels.distance,x=h.ignoreHiddenPoint,g=P.length;for(l.startAngleRad=u,l.endAngleRad=f,l.calculateExtremes(),t||(l.center=t=l.getCenter()),r=0;r<g;r++)n=P[r],s=l.radii[r],n.labelDistance=pick(n.options.dataLabels&&n.options.dataLabels.distance,m),l.maxLabelDistance=Math.max(l.maxLabelDistance||0,n.labelDistance),o=u+p*M,x&&!n.visible||(p+=n.percentage/100),a=u+p*M,n.shapeType="arc",n.shapeArgs={x:t[0],y:t[1],r:s,innerR:t[3]/2,start:Math.round(o*c)/c,end:Math.round(a*c)/c},(e=(a+o)/2)>1.5*Math.PI?e-=2*Math.PI:e<-Math.PI/2&&(e+=2*Math.PI),n.slicedTranslation={translateX:Math.round(Math.cos(e)*d),translateY:Math.round(Math.sin(e)*d)},i=Math.cos(e)*t[2]/2,a=Math.sin(e)*t[2]/2,o=Math.cos(e)*s,s=Math.sin(e)*s,n.tooltipPos=[t[0]+.7*i,t[1]+.7*a],n.half=e<-Math.PI/2||e>Math.PI/2?1:0,n.angle=e,a=Math.min(y,n.labelDistance/5),n.labelPosition={natural:{x:t[0]+o+Math.cos(e)*n.labelDistance,y:t[1]+s+Math.sin(e)*n.labelDistance},final:{},alignment:n.half?"right":"left",connectorPosition:{breakAt:{x:t[0]+o+Math.cos(e)*a,y:t[1]+s+Math.sin(e)*a},touchingSliceAt:{x:t[0]+o,y:t[1]+s}}};fireEvent(l,"afterTranslate")},t.prototype.zValEval=function(t){return"number"==typeof t&&!isNaN(t)||null},t.defaultOptions=merge(PieSeries.defaultOptions,{minPointSize:"10%",maxPointSize:"100%",zMin:void 0,zMax:void 0,sizeBy:"area",tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}<br/>Value: {point.y}<br/>Size: {point.z}<br/>'}}),t}(PieSeries);extend(VariablePieSeries.prototype,{pointArrayMap:["y","z"],parallelArrays:["x","y","z"]}),SeriesRegistry.registerSeriesType("variablepie",VariablePieSeries);export default VariablePieSeries;