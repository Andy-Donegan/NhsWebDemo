"use strict";var __extends=this&&this.__extends||function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])})(i,t)};return function(i,t){function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}}();import HeikinAshiPoint from"./HeikinAshiPoint.js";import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";import U from"../../Core/Utilities.js";import Axis from"../../Core/Axis/Axis.js";var CandlestickSeries=SeriesRegistry.seriesTypes.candlestick,addEvent=U.addEvent,merge=U.merge,HeikinAshiSeries=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.data=void 0,i.heikiashiData=[],i.options=void 0,i.points=void 0,i.yData=void 0,i.processedYData=void 0,i}return __extends(i,t),i.prototype.getHeikinashiData=function(){var i=this,t=i.allGroupedData||i.yData,e=i.heikiashiData;if(!e.length&&t&&t.length){var s=t[0];this.modifyFirstPointValue(s);for(var a=1;a<t.length;a++){var o=t[a],n=e[a-1];this.modifyDataPoint(o,n)}}i.heikiashiData=e},i.prototype.init=function(){t.prototype.init.apply(this,arguments),this.heikiashiData=[]},i.prototype.modifyFirstPointValue=function(i){var t=(i[0]+i[1]+i[2]+i[3])/4,e=(i[0]+i[3])/2;this.heikiashiData.push([t,i[1],i[2],e])},i.prototype.modifyDataPoint=function(i,t){var e=(t[0]+t[3])/2,s=(i[0]+i[1]+i[2]+i[3])/4,t=Math.max(i[1],s,e),i=Math.min(i[2],s,e);this.heikiashiData.push([e,t,i,s])},i.defaultOptions=merge(CandlestickSeries.defaultOptions,{dataGrouping:{groupAll:!0}}),i}(CandlestickSeries);addEvent(HeikinAshiSeries,"afterTranslate",function(){for(var i=this,t=i.points,e=i.heikiashiData,s=i.cropStart||0,a=i.processedYData.length=0;a<t.length;a++){var o=t[a],n=e[a+s];o.open=n[0],o.high=n[1],o.low=n[2],o.close=n[3],i.processedYData.push([o.open,o.high,o.low,o.close])}}),addEvent(HeikinAshiSeries,"updatedData",function(){this.heikiashiData.length&&(this.heikiashiData.length=0)}),addEvent(Axis,"postProcessData",function(){this.series.forEach(function(i){i.is("heikinashi")&&((i=i).heikiashiData.length=0,i.getHeikinashiData())})}),HeikinAshiSeries.prototype.pointClass=HeikinAshiPoint,SeriesRegistry.registerSeriesType("heikinashi",HeikinAshiSeries);export default HeikinAshiSeries;