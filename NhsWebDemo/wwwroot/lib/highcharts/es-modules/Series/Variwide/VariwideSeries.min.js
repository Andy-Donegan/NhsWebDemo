"use strict";var __extends=this&&this.__extends||function(){var s=function(t,i){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)};return function(t,i){function e(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}();import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";var ColumnSeries=SeriesRegistry.seriesTypes.column;import VariwidePoint from"./VariwidePoint.js";import U from"../../Core/Utilities.js";var extend=U.extend,merge=U.merge,pick=U.pick;import"./VariwideComposition.js";var VariwideSeries=function(i){function t(){var t=null!==i&&i.apply(this,arguments)||this;return t.data=void 0,t.options=void 0,t.points=void 0,t.relZ=void 0,t.totalZ=void 0,t.zData=void 0,t}return __extends(t,i),t.prototype.processData=function(t){this.totalZ=0,this.relZ=[],SeriesRegistry.seriesTypes.column.prototype.processData.call(this,t),(this.xAxis.reversed?this.zData.slice().reverse():this.zData).forEach(function(t,i){this.relZ[i]=this.totalZ,this.totalZ+=t},this),this.xAxis.categories&&(this.xAxis.variwide=!0,this.xAxis.zData=this.zData)},t.prototype.postTranslate=function(t,i,e){var s=this.xAxis,r=this.relZ,o=s.reversed?r.length-t:t,a=s.reversed?-1:1,n=s.toPixels(s.reversed?(s.dataMax||0)+s.pointRange:s.dataMin||0),p=s.toPixels(s.reversed?s.dataMin||0:(s.dataMax||0)+s.pointRange),h=Math.abs(p-n),d=this.totalZ,t=this.chart.inverted?p-(this.chart.plotTop-a*s.minPixelPadding):n-this.chart.plotLeft-a*s.minPixelPadding,p=o/r.length*h,n=(o+a)/r.length*h,s=pick(r[o],d)/d*h,h=pick(r[o+a],d)/d*h,i=i-(t+p);return e&&(e.crosshairWidth=h-s),t+s+i*(h-s)/(n-p)},t.prototype.translate=function(){var t=this.options.crisp,s=this.xAxis;this.options.crisp=!1,SeriesRegistry.seriesTypes.column.prototype.translate.call(this),this.options.crisp=t;var r=this.chart.inverted,o=this.borderWidth%2/2;this.points.forEach(function(t,i){var e,i=s.variwide?(e=this.postTranslate(i,t.shapeArgs.x,t),this.postTranslate(i,t.shapeArgs.x+t.shapeArgs.width)):(e=t.plotX,s.translate(t.x+t.z,0,0,0,1));this.options.crisp&&(e=Math.round(e)-o,i=Math.round(i)-o),t.shapeArgs.x=e,t.shapeArgs.width=Math.max(i-e,1),t.plotX=(e+i)/2,r?t.tooltipPos[1]=s.len-t.shapeArgs.x-t.shapeArgs.width/2:t.tooltipPos[0]=t.shapeArgs.x+t.shapeArgs.width/2},this),this.options.stacking&&this.correctStackLabels()},t.prototype.correctStackLabels=function(){var i,e,s,r,o=this,a=o.options,n=o.yAxis;o.points.forEach(function(t){r=t.x,e=t.shapeArgs.width,(s=n.stacking.stacks[(o.negStacks&&t.y<(a.startFromThreshold?0:a.threshold)?"-":"")+o.stackKey])&&(i=s[r])&&!t.isNull&&i.setOffset(-e/2||0,e||0,void 0,void 0,t.plotX)})},t.defaultOptions=merge(ColumnSeries.defaultOptions,{pointPadding:0,groupPadding:0}),t}(ColumnSeries);extend(VariwideSeries.prototype,{irregularWidths:!0,pointArrayMap:["y","z"],parallelArrays:["x","y","z"],pointClass:VariwidePoint}),SeriesRegistry.registerSeriesType("variwide",VariwideSeries);export default VariwideSeries;