"use strict";var __extends=this&&this.__extends||function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();import DerivedComposition from"../DerivedComposition.js";import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";var ColumnSeries=SeriesRegistry.seriesTypes.column;import U from"../../Core/Utilities.js";var arrayMax=U.arrayMax,arrayMin=U.arrayMin,correctFloat=U.correctFloat,extend=U.extend,isNumber=U.isNumber,merge=U.merge,objectEach=U.objectEach,binsNumberFormulas={"square-root":function(t){return Math.ceil(Math.sqrt(t.options.data.length))},sturges:function(t){return Math.ceil(Math.log(t.options.data.length)*Math.LOG2E)},rice:function(t){return Math.ceil(2*Math.pow(t.options.data.length,1/3))}};function fitToBinLeftClosed(r){return function(t){for(var e=1;r[e]<=t;)e++;return r[--e]}}var HistogramSeries=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=void 0,t.options=void 0,t.points=void 0,t.userOptions=void 0,t}return __extends(t,e),t.prototype.binsNumber=function(){var t=this.options.binsNumber,e=binsNumberFormulas[t]||"function"==typeof t&&t;return Math.ceil(e&&e(this.baseSeries)||(isNumber(t)?t:binsNumberFormulas["square-root"](this.baseSeries)))},t.prototype.derivedData=function(t,e,r){var o,i,n=this,s=correctFloat(arrayMax(t)),a=correctFloat(arrayMin(t)),u=[],c={},p=[];for(r=n.binWidth=correctFloat(isNumber(r)?r||1:(s-a)/e),n.options.pointRange=Math.max(r,0),o=a;o<s&&(n.userOptions.binWidth||correctFloat(s-o)>=r||correctFloat(correctFloat(a+u.length*r)-o)<=0);o=correctFloat(o+r))u.push(o),c[o]=0;return 0!==c[a]&&(u.push(a),c[a]=0),i=fitToBinLeftClosed(u.map(function(t){return parseFloat(t)})),t.forEach(function(t){t=correctFloat(i(t));c[t]++}),objectEach(c,function(t,e){p.push({x:Number(e),y:t,x2:correctFloat(Number(e)+r)})}),p.sort(function(t,e){return t.x-e.x}),p[p.length-1].x2=s,p},t.prototype.setDerivedData=function(){var t=this.baseSeries.yData;t.length?(t=this.derivedData(t,this.binsNumber(),this.options.binWidth),this.setData(t,!1)):this.setData([])},t.defaultOptions=merge(ColumnSeries.defaultOptions,{binsNumber:"square-root",binWidth:void 0,pointPadding:0,groupPadding:0,grouping:!1,pointPlacement:"between",tooltip:{headerFormat:"",pointFormat:'<span style="font-size: 10px">{point.x} - {point.x2}</span><br/><span style="color:{point.color}">‚óè</span> {series.name} <b>{point.y}</b><br/>'}}),t}(ColumnSeries);extend(HistogramSeries.prototype,{hasDerivedData:DerivedComposition.hasDerivedData}),DerivedComposition.compose(HistogramSeries),SeriesRegistry.registerSeriesType("histogram",HistogramSeries);export default HistogramSeries;