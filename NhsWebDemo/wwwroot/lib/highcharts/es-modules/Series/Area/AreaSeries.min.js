"use strict";var __extends=this&&this.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();import Color from"../../Core/Color/Color.js";var color=Color.parse;import LegendSymbol from"../../Core/Legend/LegendSymbol.js";import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";var LineSeries=SeriesRegistry.seriesTypes.line;import U from"../../Core/Utilities.js";var extend=U.extend,merge=U.merge,objectEach=U.objectEach,pick=U.pick,AreaSeries=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=void 0,t.options=void 0,t.points=void 0,t}return __extends(t,e),t.prototype.drawGraph=function(){this.areaPath=[],e.prototype.drawGraph.apply(this);var s=this,a=this.areaPath,n=this.options,t=this.zones,r=[["area","highcharts-area",this.color,n.fillColor]];t.forEach(function(t,e){r.push(["zone-area-"+e,"highcharts-area highcharts-zone-area-"+e+" "+t.className,t.color||s.color,t.fillColor||n.fillColor])}),r.forEach(function(t){var e=t[0],r=s[e],i=r?"animate":"attr",o={};r?(r.endX=s.preventGraphAnimation?null:a.xMap,r.animate({d:a})):(o.zIndex=0,(r=s[e]=s.chart.renderer.path(a).addClass(t[1]).add(s.group)).isArea=!0),s.chart.styledMode||(o.fill=pick(t[3],color(t[2]).setOpacity(pick(n.fillOpacity,.75)).get())),r[i](o),r.startX=a.xMap,r.shiftUnit=n.step?2:1})},t.prototype.getGraphPath=function(n){function t(t,e,r){var i,o,s=n[t],a=h&&d[s.x].points[u],t=s[r+"Null"]||0,s=s[r+"Cliff"]||0,r=!0;s||t?(i=(t?a[0]:a[1])+s,o=a[0]+s,r=!!t):!h&&n[e]&&n[e].isNull&&(i=o=g),void 0!==i&&(f.push({plotX:l,plotY:null===i?y:p.getThreshold(i),isNull:r,isCliff:!0}),c.push({plotX:l,plotY:null===o?y:p.getThreshold(o),doCurve:!1}))}var e,r,l,i,o,s=LineSeries.prototype.getGraphPath,a=this.options,h=a.stacking,p=this.yAxis,c=[],f=[],u=this.index,d=p.stacking.stacks[this.stackKey],g=a.threshold,y=Math.round(p.getThreshold(a.threshold)),v=pick(a.connectNulls,"percent"===h);for(n=n||this.points,h&&(n=this.getStackPoints(n)),r=0;r<n.length;r++)h||(n[r].leftCliff=n[r].rightCliff=n[r].leftNull=n[r].rightNull=void 0),i=n[r].isNull,l=pick(n[r].rectPlotX,n[r].plotX),o=h?pick(n[r].yBottom,y):y,i&&!v||(v||t(r,r-1,"left"),i&&!h&&v||(f.push(n[r]),c.push({x:r,plotX:l,plotY:o})),v||t(r,r+1,"right"));e=s.call(this,f,!0,!0),c.reversed=!0;var x,a=(x=s.call(this,c,!0,!0))[0];return a&&"M"===a[0]&&(x[0]=["L",a[1],a[2]]),(x=e.concat(x)).length&&x.push(["Z"]),s=s.call(this,f,!1,v),x.xMap=e.xMap,this.areaPath=x,s},t.prototype.getStackPoints=function(t){var c=this,i=[],f=[],o=this.xAxis,s=this.yAxis,u=s.stacking.stacks[this.stackKey],d={},g=s.series,y=g.length,v=s.options.reversedStacks?1:-1,x=g.indexOf(c);if(t=t||this.points,this.options.stacking){for(var e=0;e<t.length;e++)t[e].leftNull=t[e].rightNull=void 0,d[t[e].x]=t[e];objectEach(u,function(t,e){null!==t.total&&f.push(e)}),f.sort(function(t,e){return t-e});var m=g.map(function(t){return t.visible});f.forEach(function(n,l){var h,t=0;if(d[n]&&!d[n].isNull)i.push(d[n]),[-1,1].forEach(function(t){var e=1===t?"rightNull":"leftNull",r=1===t?"rightCliff":"leftCliff",i=0,o=u[f[l+t]];if(o)for(var s=x;0<=s&&s<y;){var a=g[s].index;(p=o.points[a])||(a===c.index?d[n][e]=!0:m[s]&&(h=u[n].points[a])&&(i-=h[1]-h[0])),s+=v}d[n][r]=i});else{for(var e=x;0<=e&&e<y;){var p,r=g[e].index;if(p=u[n].points[r]){t=p[1];break}e+=v}t=pick(t,0),t=s.translate(t,0,1,0,1),i.push({isNull:!0,plotX:o.translate(n,0,0,0,1),x:n,plotY:t,yBottom:t})}})}return i},t.defaultOptions=merge(LineSeries.defaultOptions,{threshold:0}),t}(LineSeries);extend(AreaSeries.prototype,{singleStacks:!1,drawLegendSymbol:LegendSymbol.drawRectangle}),SeriesRegistry.registerSeriesType("area",AreaSeries);export default AreaSeries;