"use strict";import Color from"../Core/Color/Color.js";import U from"../Core/Utilities.js";var extend=U.extend,isArray=U.isArray,isNumber=U.isNumber,isObject=U.isObject,merge=U.merge,pick=U.pick;function getColor(e,o){var t,i,r,l,s,n,c=o.index,a=o.mapOptionsToLevel,d=o.parentColor,p=o.parentColorIndex,u=o.series,v=o.colors,b=o.siblings,m=u.points,f=u.chart.options.chart;return e&&(m=m[e.i],t=a[e.level]||{},m&&t.colorByPoint&&(l=m.index%(v?v.length:f.colorCount),i=v&&v[l]),u.chart.styledMode||(r=pick(m&&m.options.color,t&&t.color,i,d&&(s=d,(n=t&&t.colorVariation)&&"brightness"===n.key&&c&&b?Color.parse(s).brighten(n.to*(c/b)).get():s),u.color)),l=pick(m&&m.options.colorIndex,t&&t.colorIndex,l,p,o.colorIndex)),{color:r,colorIndex:l}}function getLevelOptions(e){var r,o,t,l,i,s,n=null;if(isObject(e))for(n={},l=isNumber(e.from)?e.from:1,s=e.levels,o={},r=isObject(e.defaults)?e.defaults:{},isArray(s)&&(o=s.reduce(function(e,o){var t,i;return isObject(o)&&isNumber(o.level)&&(i=merge({},o),t=pick(i.levelIsConstant,r.levelIsConstant),delete i.levelIsConstant,delete i.level,t=o.level+(t?0:l-1),isObject(e[t])?merge(!0,e[t],i):e[t]=i),e},{})),i=isNumber(e.to)?e.to:1,t=0;t<=i;t++)n[t]=merge({},r,isObject(o[t])?o[t]:{});return n}function setTreeValues(i,r){var e=r.before,o=r.idRoot,t=r.mapIdToNode[o],l=!1!==r.levelIsConstant,s=r.points[i.i],n=s&&s.options||{},c=[],a=0;i.levelDynamic=i.level-(l?0:t.level),i.name=pick(s&&s.name,""),i.visible=o===i.id||!0===r.visible,(i="function"==typeof e?e(i,r):i).children.forEach(function(e,o){var t=extend({},r);extend(t,{index:o,siblings:i.children.length,visible:i.visible}),e=setTreeValues(e,t),c.push(e),e.visible&&(a+=e.val)});n=pick(n.value,a);return i.visible=0<=n&&(0<a||i.visible),i.children=c,i.childrenTotal=a,i.isLeaf=i.visible&&!a,i.val=n,i}function updateRootId(e){var o;return isObject(e)&&(o=isObject(e.options)?e.options:{},o=pick(e.rootNode,o.rootId,""),isObject(e.userOptions)&&(e.userOptions.rootId=o),e.rootNode=o),o}var TreeUtilities={getColor:getColor,getLevelOptions:getLevelOptions,setTreeValues:setTreeValues,updateRootId:updateRootId};export default TreeUtilities;