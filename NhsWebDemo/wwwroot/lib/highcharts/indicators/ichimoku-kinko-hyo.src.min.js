"use strict";!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/indicators/ichimoku-kinko-hyo",["highcharts","highcharts/modules/stock"],function(o){return t(o),t.Highcharts=o,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){o=o?o._modules:{};function t(o,t,n,e){o.hasOwnProperty(t)||(o[t]=e.apply(null,n))}t(o,"Stock/Indicators/IKH/IKHIndicator.js",[o["Core/Color/Color.js"],o["Core/Globals.js"],o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"]],function(o,i,X,t){var e,n=this&&this.__extends||(e=function(o,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var n in t)t.hasOwnProperty(n)&&(o[n]=t[n])})(o,t)},function(o,t){function n(){this.constructor=o}e(o,t),o.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),p=o.parse,s=X.seriesTypes.sma,E=t.defined,o=t.extend,P=t.isArray,r=t.isNumber,_=t.merge,w=t.objectEach;function Y(o){return{high:o.reduce(function(o,t){return Math.max(o,t[1])},-1/0),low:o.reduce(function(o,t){return Math.min(o,t[2])},1/0)}}function L(o){var t=o.indicator;t.points=o.points,t.nextPoints=o.nextPoints,t.color=o.color,t.options=_(o.options.senkouSpan.styles,o.gap),t.graph=o.graph,t.fillGraph=!0,X.seriesTypes.sma.prototype.drawGraph.call(t)}i.approximations["ichimoku-averages"]=function(){var n,e=[];return[].forEach.call(arguments,function(o,t){e.push(i.approximations.average(o)),n=!n&&void 0===e[t]}),n?void 0:e};var a,s=(n(l,a=s),l.prototype.init=function(){X.seriesTypes.sma.prototype.init.apply(this,arguments),this.options=_({tenkanLine:{styles:{lineColor:this.color}},kijunLine:{styles:{lineColor:this.color}},chikouLine:{styles:{lineColor:this.color}},senkouSpanA:{styles:{lineColor:this.color,fill:p(this.color).setOpacity(.5).get()}},senkouSpanB:{styles:{lineColor:this.color,fill:p(this.color).setOpacity(.5).get()}},senkouSpan:{styles:{fill:p(this.color).setOpacity(.2).get()}}},this.options)},l.prototype.toYData=function(o){return[o.tenkanSen,o.kijunSen,o.chikouSpan,o.senkouSpanA,o.senkouSpanB]},l.prototype.translate=function(){var e=this;X.seriesTypes.sma.prototype.translate.apply(e),e.points.forEach(function(n){e.pointArrayMap.forEach(function(o){var t=n[o];r(t)&&(n["plot"+o]=e.yAxis.toPixels(t,!0),n.plotY=n["plot"+o],n.tooltipPos=[n.plotX,n["plot"+o]],n.isNull=!1)})})},l.prototype.drawGraph=function(){var o,t,n,e,i,p,s,r,a,l,h,u,c,f,d,k=this,g=k.points,y=g.length,S=k.options,v=k.graph,m=k.color,x={options:{gapSize:S.gapSize}},A=k.pointArrayMap.length,C=[[],[],[],[],[],[]],P={tenkanLine:C[0],kijunLine:C[1],chikouLine:C[2],senkouSpanA:C[3],senkouSpanB:C[4],senkouSpan:C[5]},Y=[],B=k.options.senkouSpan,b=B.color||B.styles.fill,j=B.negativeColor,N=[[],[]],G=[[],[]],O=0;for(k.ikhMap=P;y--;){for(t=g[y],n=0;n<A;n++)o=k.pointArrayMap[n],E(t[o])&&C[n].push({plotX:t.plotX,plotY:t["plot"+o],isNull:!1});j&&y!==g.length-1&&(c=P.senkouSpanB.length-1,d={plotX:(f=function(o,t,n,e){if(o&&t&&n&&e){var i=t.plotX-o.plotX,p=t.plotY-o.plotY,s=e.plotX-n.plotX,r=e.plotY-n.plotY,a=o.plotX-n.plotX,t=o.plotY-n.plotY,e=void 0,n=void 0,n=(s*t-r*a)/(-s*p+i*r);if(0<=(e=(-p*a+i*t)/(-s*p+i*r))&&e<=1&&0<=n&&n<=1)return{plotX:o.plotX+n*i,plotY:o.plotY+n*p}}return!1}(P.senkouSpanA[c-1],P.senkouSpanA[c],P.senkouSpanB[c-1],P.senkouSpanB[c])).plotX,plotY:f.plotY,isNull:!1,intersectPoint:!0},f&&(P.senkouSpanA.splice(c,0,d),P.senkouSpanB.splice(c,0,d),Y.push(c)))}if(w(P,function(o,t){S[t]&&"senkouSpan"!==t&&(k.points=C[O],k.options=_(S[t].styles,x),k.graph=k["graph"+t],k.fillGraph=!1,k.color=m,X.seriesTypes.sma.prototype.drawGraph.call(k),k["graph"+t]=k.graph),O++}),k.graphCollection&&k.graphCollection.forEach(function(o){k[o].destroy(),delete k[o]}),k.graphCollection=[],j&&P.senkouSpanA[0]&&P.senkouSpanB[0]){for(Y.unshift(0),Y.push(P.senkouSpanA.length-1),h=0;h<Y.length-1;h++)if(e=Y[h],T=Y[h+1],i=P.senkouSpanB.slice(e,T+1),p=P.senkouSpanA.slice(e,T+1),1<=Math.floor(i.length/2)){var T=Math.floor(i.length/2);if(i[T].plotY===p[T].plotY){for(u=r=s=0;u<i.length;u++)s+=i[u].plotY,r+=p[u].plotY;N[l=r<s?0:1]=N[l].concat(i),G[l]=G[l].concat(p)}else l=i[T].plotY>p[T].plotY?0:1,N[l]=N[l].concat(i),G[l]=G[l].concat(p)}else l=i[0].plotY>p[0].plotY?0:1,N[l]=N[l].concat(i),G[l]=G[l].concat(p);["graphsenkouSpanColor","graphsenkouSpanNegativeColor"].forEach(function(o,t){N[t].length&&G[t].length&&(a=0===t?b:j,L({indicator:k,points:N[t],nextPoints:G[t],color:a,options:S,gap:x,graph:k[o]}),k[o]=k.graph,k.graphCollection.push(o))})}else L({indicator:k,points:P.senkouSpanB,nextPoints:P.senkouSpanA,color:b,options:S,gap:x,graph:k.graphsenkouSpan}),k.graphsenkouSpan=k.graph;delete k.nextPoints,delete k.fillGraph,k.points=g,k.options=S,k.graph=v,k.color=m},l.prototype.getGraphPath=function(o){var t,n=this,e=[],i=[];if(o=o||this.points,n.fillGraph&&n.nextPoints){if((t=X.seriesTypes.sma.prototype.getGraphPath.call(n,n.nextPoints))&&t.length){t[0][0]="L";for(var e=X.seriesTypes.sma.prototype.getGraphPath.call(n,o),p=(i=t.slice(0,e.length)).length-1;0<=p;p--)e.push(i[p])}}else e=X.seriesTypes.sma.prototype.getGraphPath.apply(n,arguments);return e},l.prototype.getValues=function(o,t){var n,e,i,p,s,r,a,l,h,u,c,f,d,k=t.period,g=t.periodTenkan,y=t.periodSenkouSpanB,S=o.xData,v=o.yData,o=o.xAxis,m=v&&v.length||0,x=(o.series.forEach(function(o){if(o.xData)for(f=o.xData,u=o.xIncrement?1:f.length-1,d=u;0<d;d--)c=f[d]-f[d-1],(void 0===h||c<h)&&(h=c)}),h),A=[],C=[];if(!(S.length<=k)&&P(v[0])&&4===v[0].length){for(n=S[0]-k*x,i=0;i<k;i++)C.push(n+i*x);for(i=0;i<m;i++)g<=i&&(p=((p=Y(v.slice(i-g,i))).high+p.low)/2),k<=i&&(a=(p+(s=((a=Y(v.slice(i-k,i))).high+a.low)/2))/2),y<=i&&(l=((r=Y(v.slice(i-y,i))).high+r.low)/2),r=v[i][3],e=S[i],void 0===A[i]&&(A[i]=[]),void 0===A[i+k]&&(A[i+k]=[]),A[i+k][0]=p,A[i+k][1]=s,A[i+k][2]=void 0,A[i][2]=r,i<=k&&(A[i+k][3]=void 0,A[i+k][4]=void 0),void 0===A[i+2*k]&&(A[i+2*k]=[]),A[i+2*k][3]=a,A[i+2*k][4]=l,C.push(e);for(i=1;i<=k;i++)C.push(e+i*x);return{values:A,xData:C,yData:A}}},l.defaultOptions=_(s.defaultOptions,{params:{index:void 0,period:26,periodTenkan:9,periodSenkouSpanB:52},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> <b> {series.name}</b><br/>TENKAN SEN: {point.tenkanSen:.3f}<br/>KIJUN SEN: {point.kijunSen:.3f}<br/>CHIKOU SPAN: {point.chikouSpan:.3f}<br/>SENKOU SPAN A: {point.senkouSpanA:.3f}<br/>SENKOU SPAN B: {point.senkouSpanB:.3f}<br/>'},tenkanLine:{styles:{lineWidth:1,lineColor:void 0}},kijunLine:{styles:{lineWidth:1,lineColor:void 0}},chikouLine:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanA:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanB:{styles:{lineWidth:1,lineColor:void 0}},senkouSpan:{styles:{fill:"rgba(255, 0, 0, 0.5)"}},dataGrouping:{approximation:"ichimoku-averages"}}),l);function l(){var o=null!==a&&a.apply(this,arguments)||this;return o.data=void 0,o.options=void 0,o.points=void 0,o.graphCollection=void 0,o.graphsenkouSpan=void 0,o.ikhMap=void 0,o.nextPoints=void 0,o}return o(s.prototype,{pointArrayMap:["tenkanSen","kijunSen","chikouSpan","senkouSpanA","senkouSpanB"],pointValKey:"tenkanSen",nameComponents:["periodSenkouSpanB","period","periodTenkan"]}),X.registerSeriesType("ikh",s),s}),t(o,"masters/indicators/ichimoku-kinko-hyo.src.js",[],function(){})});