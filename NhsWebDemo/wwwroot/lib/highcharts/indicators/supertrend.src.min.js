"use strict";!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/indicators/supertrend",["highcharts","highcharts/modules/stock"],function(o){return t(o),t.Highcharts=o,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){o=o?o._modules:{};function t(o,t,e,r){o.hasOwnProperty(t)||(o[t]=r.apply(null,e))}t(o,"Stock/Indicators/Supertrend/SupertrendIndicator.js",[o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"],o["Core/Chart/StockChart.js"]],function(o,t,n){var r,e=this&&this.__extends||(r=function(o,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(o,t)},function(o,t){function e(){this.constructor=o}r(o,t),o.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),i=o.seriesTypes,S=i.atr,T=i.sma,l=t.addEvent,D=t.correctFloat,b=t.isArray,i=t.extend,v=t.merge,_=t.objectEach;function j(o,t,e){return{index:t,close:o.yData[t][e],x:o.xData[t]}}var s,e=(e(p,s=T),p.prototype.init=function(){var t;T.prototype.init.apply(this,arguments);var e=this,r=l(n,"afterLinkSeries",function(){var o;e.options&&(o=e.options,t=e.linkedParent.options,o.cropThreshold=t.cropThreshold-(o.params.period-1)),r()},{order:1})},p.prototype.drawGraph=function(){for(var o,t,e,r,n,i,l,s,p=this,a=p.options,c=p.linkedParent,d=c?c.points:[],h=p.points,u=p.graph,y=h.length,f=d.length-y,g=0<f?f:0,x={options:{gapSize:a.gapSize}},m={top:[],bottom:[],intersect:[]},C={top:{styles:{lineWidth:a.lineWidth,lineColor:a.fallingTrendColor||a.color,dashStyle:a.dashStyle}},bottom:{styles:{lineWidth:a.lineWidth,lineColor:a.risingTrendColor||a.color,dashStyle:a.dashStyle}},intersect:a.changeTrendLine};y--;)o=h[y],t=h[y-1],e=d[y-1+g],r=d[y-2+g],s=d[y+g],n=d[y+g+1],i=o.options.color,l={x:o.x,plotX:o.plotX,plotY:o.plotY,isNull:!1},!r&&e&&c.yData[e.index-1]&&(r=j(c,e.index-1,3)),!n&&s&&c.yData[s.index+1]&&(n=j(c,s.index+1,3)),!e&&r&&c.yData[r.index+1]?e=j(c,r.index+1,3):!e&&s&&c.yData[s.index-1]&&(e=j(c,s.index-1,3)),o&&e&&s&&r&&o.x!==e.x&&(o.x===s.x?(r=e,e=s):o.x===r.x?(e=r,r={close:c.yData[e.index-1][3],x:c.xData[e.index-1]}):n&&o.x===n.x&&(e=n,r=s)),t&&r&&e?(s={x:t.x,plotX:t.plotX,plotY:t.plotY,isNull:!1},o.y>=e.close&&t.y>=r.close?(o.color=i||a.fallingTrendColor||a.color,m.top.push(l)):o.y<e.close&&t.y<r.close?(o.color=i||a.risingTrendColor||a.color,m.bottom.push(l)):(m.intersect.push(l),m.intersect.push(s),m.intersect.push(v(s,{isNull:!0})),o.y>=e.close&&t.y<r.close?(o.color=i||a.fallingTrendColor||a.color,t.color=i||a.risingTrendColor||a.color,m.top.push(l),m.top.push(v(s,{isNull:!0}))):o.y<e.close&&t.y>=r.close&&(o.color=i||a.risingTrendColor||a.color,t.color=i||a.fallingTrendColor||a.color,m.bottom.push(l),m.bottom.push(v(s,{isNull:!0}))))):e&&(o.y>=e.close?(o.color=i||a.fallingTrendColor||a.color,m.top.push(l)):(o.color=i||a.risingTrendColor||a.color,m.bottom.push(l)));_(m,function(o,t){p.points=o,p.options=v(C[t].styles,x),p.graph=p["graph"+t+"Line"],T.prototype.drawGraph.call(p),p["graph"+t+"Line"]=p.graph}),p.points=h,p.options=a,p.graph=u},p.prototype.getValues=function(o,t){var e,r,n,i,l,s,p,a,c,d,h=t.period,u=t.multiplier,y=o.xData,f=o.yData,g=[],x=[],m=[],C=0===h?0:h-1,T=[],v=[];if(!(y.length<=h||!b(f[0])||4!==f[0].length||h<0)){for(e=S.prototype.getValues.call(this,o,{period:h}).yData,d=0;d<e.length;d++)c=f[C+d],a=f[C+d-1]||[],l=T[d-1],s=v[d-1],p=m[d-1],0===d&&(l=s=p=0),r=D((c[1]+c[2])/2+u*e[d]),n=D((c[1]+c[2])/2-u*e[d]),r<l||a[3]>l?T[d]=r:T[d]=l,s<n||a[3]<s?v[d]=n:v[d]=s,p===l&&c[3]<T[d]||p===s&&c[3]<v[d]?i=T[d]:(p===l&&c[3]>T[d]||p===s&&c[3]>v[d])&&(i=v[d]),g.push([y[C+d],i]),x.push(y[C+d]),m.push(i);return{values:g,xData:x,yData:m}}},p.defaultOptions=v(T.defaultOptions,{params:{index:void 0,multiplier:3,period:10},risingTrendColor:"#06b535",fallingTrendColor:"#f21313",changeTrendLine:{styles:{lineWidth:1,lineColor:"#333333",dashStyle:"LongDash"}}}),p);function p(){var o=null!==s&&s.apply(this,arguments)||this;return o.data=void 0,o.linkedParent=void 0,o.options=void 0,o.points=void 0,o}return i(e.prototype,{nameBase:"Supertrend",nameComponents:["multiplier","period"]}),o.registerSeriesType("supertrend",e),e}),t(o,"masters/indicators/supertrend.src.js",[],function(){})});