"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/funnel3d",["highcharts","highcharts/highcharts-3d","highcharts/modules/cylinder"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){t=t?t._modules:{};function e(t,e,r,i){t.hasOwnProperty(e)||(t[e]=i.apply(null,r))}e(t,"Series/Funnel3D/Funnel3DComposition.js",[t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Renderer/SVG/SVGRenderer3D.js"],t["Core/Utilities.js"]],function(t,o,r,e){var i,a=t.parse,x=o.charts,w=e.error,n=e.extend,m=e.merge;return(i||(i={})).compose=function(t){var e,y;r.compose(t),(e=t.prototype.elements3d).funnel3d=m(e.cuboid,{parts:["top","bottom","frontUpper","backUpper","frontLower","backLower","rightUpper","rightLower"],mainParts:["top","bottom"],sideGroups:["upperGroup","lowerGroup"],sideParts:{upperGroup:["frontUpper","backUpper","rightUpper"],lowerGroup:["frontLower","backLower","rightLower"]},pathType:"funnel3d",opacitySetter:function(t){var e=this,r=e.parts,i=o.charts[e.renderer.chartIndex],n="group-opacity-"+t+"-"+i.index;return e.parts=e.mainParts,e.singleSetterForParts("opacity",t),e.parts=r,i.renderer.filterId||(i.renderer.definition({tagName:"filter",attributes:{id:n},children:[{tagName:"feComponentTransfer",children:[{tagName:"feFuncA",attributes:{type:"table",tableValues:"0 "+t}}]}]}),e.sideGroups.forEach(function(t){e[t].attr({filter:"url(#"+n+")"})}),e.renderer.styledMode&&(i.renderer.definition({tagName:"style",textContent:".highcharts-"+n+" {filter:url(#"+n+")}"}),e.sideGroups.forEach(function(t){t.addClass("highcharts-"+n)}))),e},fillSetter:function(t){var o=this,n=a(t),e=n.rgba[3],d={top:a(t).brighten(.1).get(),bottom:a(t).brighten(-.2).get()};return e<1?(n.rgba[3]=1,n=n.get("rgb"),o.attr({opacity:e})):n=t,(n=!n.linearGradient&&!n.radialGradient&&o.gradientForSides?{linearGradient:{x1:0,x2:1,y1:1,y2:1},stops:[[0,a(t).brighten(-.2).get()],[.5,t],[1,a(t).brighten(-.2).get()]]}:n).linearGradient?o.sideGroups.forEach(function(t){var e=o[t].gradientBox,r=n.linearGradient,i=m(n,{linearGradient:{x1:e.x+r.x1*e.width,y1:e.y+r.y1*e.height,x2:e.x+r.x2*e.width,y2:e.y+r.y2*e.height}});o.sideParts[t].forEach(function(t){d[t]=i})}):(m(!0,d,{frontUpper:n,backUpper:n,rightUpper:n,frontLower:n,backLower:n,rightLower:n}),n.radialGradient&&o.sideGroups.forEach(function(t){var e=o[t].gradientBox,r=e.x+e.width/2,i=e.y+e.height/2,n=Math.min(e.width,e.height);o.sideParts[t].forEach(function(t){o[t].setRadialReference([r,i,n])})})),o.singleSetterForParts("fill",null,d),o.color=o.fill=t,n.linearGradient&&[o.frontLower,o.frontUpper].forEach(function(t){t=t.element,t=t&&o.renderer.gradients[t.gradient];t&&"userSpaceOnUse"!==t.attr("gradientUnits")&&t.attr({gradientUnits:"userSpaceOnUse"})}),o},adjustForGradient:function(){var i,n=this;n.sideGroups.forEach(function(t){var e={x:Number.MAX_VALUE,y:Number.MAX_VALUE},r={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE};n.sideParts[t].forEach(function(t){t=n[t];i=t.getBBox(!0),e={x:Math.min(e.x,i.x),y:Math.min(e.y,i.y)},r={x:Math.max(r.x,i.x+i.width),y:Math.max(r.y,i.y+i.height)}}),n[t].gradientBox={x:e.x,width:r.x-e.x,y:e.y,height:r.y-e.y}})},zIndexSetter:function(){return this.finishedOnAdd&&this.adjustForGradient(),this.renderer.Element.prototype.zIndexSetter.apply(this,arguments)},onAdd:function(){this.adjustForGradient(),this.finishedOnAdd=!0}}),y=t.prototype,n(y,{funnel3d:function(t){var e=this.element3d("funnel3d",t),r=this.styledMode,i={"stroke-width":1,stroke:"none"};return e.upperGroup=this.g("funnel3d-upper-group").attr({zIndex:e.frontUpper.zIndex}).add(e),[e.frontUpper,e.backUpper,e.rightUpper].forEach(function(t){r||t.attr(i),t.add(e.upperGroup)}),e.lowerGroup=this.g("funnel3d-lower-group").attr({zIndex:e.frontLower.zIndex}).add(e),[e.frontLower,e.backLower,e.rightLower].forEach(function(t){r||t.attr(i),t.add(e.lowerGroup)}),e.gradientForSides=t.gradientForSides,e},funnel3dPath:function(t){this.getCylinderEnd||w("A required Highcharts module is missing: cylinder.js",!0,x[this.chartIndex]);var e=this,r=x[e.chartIndex],i=t.alphaCorrection=90-Math.abs(r.options.chart.options3d.alpha%180-90),n=y.cuboidPath.call(e,m(t,{depth:t.width,width:(t.width+t.bottom.width)/2})),o=n.isTop,d=!n.isFront,a=!!t.middle,s=e.getCylinderEnd(r,m(t,{x:t.x-t.width/2,z:t.z-t.width/2,alphaCorrection:i})),h=t.bottom.width,p=m(t,{width:h,x:t.x-h/2,z:t.z-h/2,alphaCorrection:i}),l=e.getCylinderEnd(r,p,!0),c=h,u=p,g=l,f=l;return a&&(c=t.middle.width,u=m(t,{y:t.y+t.middle.fraction*t.height,width:c,x:t.x-c/2,z:t.z-c/2}),g=e.getCylinderEnd(r,u,!1),f=e.getCylinderEnd(r,u,!1)),(o={top:s,bottom:l,frontUpper:e.getCylinderFront(s,g),zIndexes:{group:n.zIndexes.group,top:0!==o?0:3,bottom:1!==o?0:3,frontUpper:d?2:1,backUpper:d?1:2,rightUpper:d?2:1}}).backUpper=e.getCylinderBack(s,g),g=Math.min(c,t.width)/Math.max(c,t.width)!=1,o.rightUpper=e.getCylinderFront(e.getCylinderEnd(r,m(t,{x:t.x-t.width/2,z:t.z-t.width/2,alphaCorrection:g?-i:0}),!1),e.getCylinderEnd(r,m(u,{alphaCorrection:g?-i:0}),!a)),a&&(g=Math.min(c,h)/Math.max(c,h)!=1,m(!0,o,{frontLower:e.getCylinderFront(f,l),backLower:e.getCylinderBack(f,l),rightLower:e.getCylinderFront(e.getCylinderEnd(r,m(p,{alphaCorrection:g?-i:0}),!0),e.getCylinderEnd(r,m(u,{alphaCorrection:g?-i:0}),!1)),zIndexes:{frontLower:d?2:1,backLower:d?1:2,rightLower:d?1:2}})),o}})},i}),e(t,"Series/Funnel3D/Funnel3DPoint.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e){var i,r,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),t=t.seriesTypes.column,e=e.extend,n=(r=t.prototype.pointClass,n(o,r),o);function o(){var t=null!==r&&r.apply(this,arguments)||this;return t.dlBoxRaw=void 0,t.options=void 0,t.series=void 0,t.y=void 0,t}return e(n.prototype,{shapeType:"funnel3d"}),n}),e(t,"Series/Funnel3D/Funnel3DSeries.js",[t["Series/Funnel3D/Funnel3DComposition.js"],t["Series/Funnel3D/Funnel3DPoint.js"],t["Core/Globals.js"],t["Extensions/Math3D.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e,r,i,n,o){var d,a,s=this&&this.__extends||(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),r=r.noop,U=i.perspective,F=n.series,h=n.seriesTypes.column,G=o.extend,p=o.merge,A=o.pick,E=o.relativeLength,t=(s(l,a=h),l.prototype.alignDataLabel=function(t,e,r){var i=this,n=t.dlBoxRaw,o=i.chart.inverted,d=t.plotY>A(i.translatedThreshold,i.yAxis.len),a=A(r.inside,!!i.options.stacking),s={x:n.x,y:n.y,height:0};r.align=A(r.align,!o||a?"center":d?"right":"left"),r.verticalAlign=A(r.verticalAlign,o||a?"middle":d?"top":"bottom"),"top"!==r.verticalAlign&&(s.y+=n.bottom/("bottom"===r.verticalAlign?1:2)),s.width=i.getWidthAt(s.y),i.options.reversed&&(s.width=n.fullWidth-s.width),a?s.x-=s.width/2:"left"===r.align?(r.align="right",s.x-=1.5*s.width):"right"===r.align?(r.align="left",s.x+=s.width/2):s.x-=s.width/2,t.dlBox=s,h.prototype.alignDataLabel.apply(i,arguments)},l.prototype.bindAxes=function(){F.prototype.bindAxes.apply(this,arguments),G(this.xAxis.options,{gridLineWidth:0,lineWidth:0,title:void 0,tickPositions:[]}),p(!0,this.yAxis.options,{gridLineWidth:0,title:void 0,labels:{enabled:!1}})},l.prototype.translate=function(){F.prototype.translate.apply(this,arguments);var e,r,i,n,o,d,a,s,h=0,t=this,p=t.chart,l=t.options,c=l.reversed,u=l.ignoreHiddenPoint,g=p.plotWidth,f=p.plotHeight,y=0,x=l.center,w=E(x[0],g),m=E(x[1],f),b=E(l.width,g),v=E(l.height,f),C=E(l.neckWidth,g),L=E(l.neckHeight,f),S=m-v/2+v-L,f=t.data;t.getWidthAt=r=function(t){return S<t||v===L?C:C+(b-C)*(1-(t-(m-v/2))/(v-L))},t.center=[w,m,v],t.centerX=w,f.forEach(function(t){u&&!1===t.visible||(h+=t.y)}),f.forEach(function(t){d=null,i=h?t.y/h:0,e=r(n=m-v/2+y*v),a=(o=n+i*v)-n,s={gradientForSides:A(t.options.gradientForSides,l.gradientForSides),x:w,y:n,height:a,width:e,z:1,top:{width:e}},e=r(o),s.bottom={fraction:i,width:e},S<=n?s.isCylinder=!0:S<o&&(d=o,e=r(S),o=S,s.bottom.width=e,s.middle={fraction:a?(S-n)/a:0,width:e}),c&&(s.y=n=m+v/2-(y+i)*v,s.middle&&(s.middle.fraction=1-(a?s.middle.fraction:0)),e=s.width,s.width=s.bottom.width,s.bottom.width=e),t.shapeArgs=G(t.shapeArgs,s),t.percentage=100*i,t.plotX=w,t.plotY=c?m+v/2-(y+i/2)*v:(n+(d||o))/2,o=U([{x:w,y:t.plotY,z:c?-(b-r(t.plotY))/2:-r(t.plotY)/2}],p,!0)[0],t.tooltipPos=[o.x,o.y],t.dlBoxRaw={x:w,width:r(t.plotY),y:n,bottom:s.height||0,fullWidth:b},u&&!1===t.visible||(y+=i)})},l.compose=t.compose,l.defaultOptions=p(h.defaultOptions,{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,gradientForSides:!0,animation:!1,edgeWidth:0,colorByPoint:!0,showInLegend:!1,dataLabels:{align:"right",crop:!1,inside:!1,overflow:"allow"}}),l);function l(){var t=null!==a&&a.apply(this,arguments)||this;return t.center=void 0,t.data=void 0,t.options=void 0,t.points=void 0,t}return G(t.prototype,{pointClass:e,translate3dShapes:r}),n.registerSeriesType("funnel3d",t),t}),e(t,"masters/modules/funnel3d.src.js",[t["Core/Renderer/RendererRegistry.js"],t["Series/Funnel3D/Funnel3DSeries.js"]],function(t,e){return e.compose(t.getRendererType()),e})});