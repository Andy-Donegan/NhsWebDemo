"use strict";!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/drilldown",["highcharts"],function(i){return t(i),t.Highcharts=i,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(i){i=i?i._modules:{};function t(i,t,e,o){i.hasOwnProperty(t)||(i[t]=o.apply(null,e))}t(i,"Extensions/Drilldown.js",[i["Core/Animation/AnimationUtilities.js"],i["Core/Axis/Axis.js"],i["Core/Chart/Chart.js"],i["Core/Color/Color.js"],i["Series/Column/ColumnSeries.js"],i["Core/FormatUtilities.js"],i["Core/Globals.js"],i["Core/DefaultOptions.js"],i["Core/Series/Point.js"],i["Core/Series/Series.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Renderer/SVG/SVGRenderer.js"],i["Core/Axis/Tick.js"],i["Core/Utilities.js"]],function(i,t,e,h,o,r,n,l,s,d,a,p,c,u){var f=i.animObject,m=r.format,w=n.noop,l=l.defaultOptions,a=a.seriesTypes,v=u.addEvent,g=u.removeEvent,x=u.extend,y=u.fireEvent,D=u.merge,b=u.objectEach,S=u.pick,B=u.syncTimeout,a=a.pie,C=1;x(l.lang,{drillUpText:"‚óÅ Back to {series.name}"}),l.drilldown={activeAxisLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},activeDataLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},animation:{duration:500},drillUpButton:{position:{align:"right",x:-10,y:10}}},p.prototype.Element.prototype.fadeIn=function(i){this.attr({opacity:.1,visibility:"inherit"}).animate({opacity:S(this.newOpacity,1)},i||{duration:250})},e.prototype.addSeriesAsDrilldown=function(i,t){this.addSingleSeriesAsDrilldown(i,t),this.applyDrilldown()},e.prototype.addSingleSeriesAsDrilldown=function(i,t){var e,o,r,n=i.series,l=n.xAxis,s=n.yAxis,d=[],a=[],p=this.styledMode?{colorIndex:S(i.colorIndex,n.colorIndex)}:{color:i.color||n.color};this.drilldownLevels||(this.drilldownLevels=[]),o=n.options._levelNumber||0,(r=this.drilldownLevels[this.drilldownLevels.length-1])&&r.levelNumber!==o&&(r=void 0),t=x(x({_ddSeriesId:C++},p),t),e=n.points.indexOf(i),n.chart.series.forEach(function(i){i.xAxis!==l||i.isDrilling||(i.options._ddSeriesId=i.options._ddSeriesId||C++,i.options._colorIndex=i.userOptions._colorIndex,i.options._levelNumber=i.options._levelNumber||o,r?(d=r.levelSeries,a=r.levelSeriesOptions):(d.push(i),i.purgedOptions=D({_ddSeriesId:i.options._ddSeriesId,_levelNumber:i.options._levelNumber,selected:i.options.selected},i.userOptions),a.push(i.purgedOptions)))}),p=x({levelNumber:o,seriesOptions:n.options,seriesPurgedOptions:n.purgedOptions,levelSeriesOptions:a,levelSeries:d,shapeArgs:i.shapeArgs,bBox:i.graphic?i.graphic.getBBox():{},color:i.isNull?h.parse(p.color).setOpacity(0).get():p.color,lowerSeriesOptions:t,pointOptions:n.options.data[e],pointIndex:e,oldExtremes:{xMin:l&&l.userMin,xMax:l&&l.userMax,yMin:s&&s.userMin,yMax:s&&s.userMax},resetZoomButton:this.resetZoomButton},p),this.drilldownLevels.push(p),l&&l.names&&(l.names.length=0),(t=p.lowerSeries=this.addSeries(t,!1)).options._levelNumber=o+1,l&&(l.oldPos=l.pos,l.userMin=l.userMax=null,s.userMin=s.userMax=null),n.type===t.type&&(t.animate=t.animateDrilldown||w,t.options.animation=!0)},e.prototype.applyDrilldown=function(){var t,i=this.drilldownLevels;i&&0<i.length&&(t=i[i.length-1].levelNumber,this.drilldownLevels.forEach(function(i){i.levelNumber===t&&i.levelSeries.forEach(function(i){i.options&&i.options._levelNumber===t&&i.remove(!1)})})),this.resetZoomButton&&(this.resetZoomButton.hide(),delete this.resetZoomButton),this.pointer.reset(),this.redraw(),this.showDrillUpButton(),y(this,"afterDrilldown")},e.prototype.getDrilldownBackText=function(){var i=this.drilldownLevels;if(i&&0<i.length)return(i=i[i.length-1]).series=i.seriesOptions,m(this.options.lang.drillUpText||"",i)},e.prototype.showDrillUpButton=function(){var i,t,e=this,o=this.getDrilldownBackText(),r=e.options.drilldown.drillUpButton,n="chart"===r.relativeTo||"spacingBox"===r.relativeTo?null:"scrollablePlotBox";this.drillUpButton?this.drillUpButton.attr({text:o}).align():(t=(i=r.theme)&&i.states,this.drillUpButton=this.renderer.button(o,null,null,function(){e.drillUp()},i,t&&t.hover,t&&t.select).addClass("highcharts-drillup-button").attr({align:r.position.align,zIndex:7}).add().align(r.position,!1,n))},e.prototype.drillUp=function(){if(this.drilldownLevels&&0!==this.drilldownLevels.length){for(var i,o,r,n,t,l=this,e=l.drilldownLevels,s=e[e.length-1].levelNumber,d=e.length,a=l.series,p=function(t){var e;a.forEach(function(i){i.options._ddSeriesId===t._ddSeriesId&&(e=i)}),(e=e||l.addSeries(t,!1)).type===r.type&&e.animateDrillupTo&&(e.animate=e.animateDrillupTo),t===o.seriesPurgedOptions&&(n=e)};d--;)if((o=e[d]).levelNumber===s){if(e.pop(),!(r=o.lowerSeries).chart)for(i=a.length;i--;)if(a[i].options.id===o.lowerSeriesOptions.id&&a[i].options._levelNumber===s+1){r=a[i];break}r.xData=[],o.levelSeriesOptions.forEach(p),y(l,"drillup",{seriesOptions:o.seriesPurgedOptions||o.seriesOptions}),this.resetZoomButton&&this.resetZoomButton.destroy(),n.type===r.type&&(n.drilldownLevel=o,n.options.animation=l.options.drilldown.animation,r.animateDrillupFrom&&r.chart&&r.animateDrillupFrom(o)),n.options._levelNumber=s,r.remove(!1),n.xAxis&&(t=o.oldExtremes,n.xAxis.setExtremes(t.xMin,t.xMax,!1),n.yAxis.setExtremes(t.yMin,t.yMax,!1)),o.resetZoomButton&&(l.resetZoomButton=o.resetZoomButton,l.resetZoomButton.show())}this.redraw(),0===this.drilldownLevels.length?this.drillUpButton=this.drillUpButton.destroy():this.drillUpButton.attr({text:this.getDrilldownBackText()}).align(),this.ddDupes.length=[],y(l,"drillupall")}},v(e,"afterInit",function(){var e=this;e.drilldown={update:function(i,t){D(!0,e.options.drilldown,i),S(t,!0)&&e.redraw()}}}),v(e,"afterShowResetZoom",function(){var i=this.resetZoomButton&&this.resetZoomButton.getBBox(),t=this.options.drilldown&&this.options.drilldown.drillUpButton;this.drillUpButton&&i&&t&&t.position&&t.position.x&&this.drillUpButton.align({x:t.position.x-i.width-10,y:t.position.y,align:t.position.align},!1,t.relativeTo||"plotBox")}),v(e,"render",function(){(this.xAxis||[]).forEach(function(n){n.ddPoints={},n.series.forEach(function(i){for(var t,e=i.xData||[],o=i.points,r=0;r<e.length;r++)"number"!=typeof(t=i.options.data[r])&&(t=i.pointClass.prototype.optionsToObject.call({series:i},t)).drilldown&&(n.ddPoints[e[r]]||(n.ddPoints[e[r]]=[]),t=r-(i.cropStart||0),n.ddPoints[e[r]].push(!(o&&0<=t&&t<o.length)||o[t]))}),b(n.ticks,c.prototype.drillable)})}),o.prototype.animateDrillupTo=function(i){var e,o;i||(o=(e=this).drilldownLevel,this.points.forEach(function(i){var t=i.dataLabel;i.graphic&&i.graphic.hide(),t&&(t.hidden="hidden"===t.attr("visibility"),t.hidden||(t.hide(),i.connector&&i.connector.hide()))}),B(function(){var t;e.points&&(t=[],e.data.forEach(function(i){t.push(i)}),(t=e.nodes?t.concat(e.nodes):t).forEach(function(i,t){var e=t===(o&&o.pointIndex)?"show":"fadeIn",t=i.dataLabel;i.graphic&&i.graphic[e]("show"==e||void 0),t&&!t.hidden&&(t.fadeIn(),i.connector&&i.connector.fadeIn())}))},Math.max(this.chart.options.drilldown.animation.duration-50,0)),delete this.animate)},o.prototype.animateDrilldown=function(i){var e,o=this,t=this.chart,r=t.drilldownLevels,n=f(t.options.drilldown.animation),l=this.xAxis,s=t.styledMode;i||(r.forEach(function(i){o.options._ddSeriesId===i.lowerSeriesOptions._ddSeriesId&&(e=i.shapeArgs,s||(e.fill=i.color))}),e.x+=S(l.oldPos,l.pos)-l.pos,this.points.forEach(function(i){var t=i.shapeArgs;s||(t.fill=i.color),i.graphic&&i.graphic.attr(e).animate(x(i.shapeArgs,{fill:i.color||o.color}),n),i.dataLabel&&i.dataLabel.fadeIn(n)}),delete this.animate)},o.prototype.animateDrillupFrom=function(r){var n=f(this.chart.options.drilldown.animation),l=this.group,s=l!==this.chart.columnGroup,d=this;d.trackerGroups.forEach(function(i){d[i]&&d[i].on("mouseover")}),s&&delete this.group,this.points.forEach(function(i){function t(){e.destroy(),l&&s&&(l=l.destroy())}var e=i.graphic,o=r.shapeArgs;e&&o&&(delete i.graphic,d.chart.styledMode||(o.fill=r.color),n.duration?e.animate(o,D(n,{complete:t})):(e.attr(o),t()))})},a&&x(a.prototype,{animateDrillupTo:o.prototype.animateDrillupTo,animateDrillupFrom:o.prototype.animateDrillupFrom,animateDrilldown:function(i){var o,r,n,l,s=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1],d=this.chart.options.drilldown.animation;this.is("item")&&(d.duration=0),this.center&&(o=s.shapeArgs,r=o.start,n=(o.end-r)/this.points.length,l=this.chart.styledMode,i||(this.points.forEach(function(i,t){var e=i.shapeArgs;l||(o.fill=s.color,e.fill=i.color),i.graphic&&i.graphic.attr(D(o,{start:r+t*n,end:r+(t+1)*n}))[d?"animate":"attr"](e,d)}),delete this.animate))}}),s.prototype.doDrilldown=function(){this.runDrilldown()},s.prototype.runDrilldown=function(o,i,t){var e,r=this.series.chart,n=r.options.drilldown,l=(n.series||[]).length;for(r.ddDupes||(r.ddDupes=[]);l--&&!e;)n.series[l].id===this.drilldown&&-1===r.ddDupes.indexOf(this.drilldown)&&(e=n.series[l],r.ddDupes.push(this.drilldown));y(r,"drilldown",{point:this,seriesOptions:e,category:i,originalEvent:t,points:void 0!==i&&this.series.xAxis.getDDPoints(i).slice(0)},function(i){var t=i.point.series&&i.point.series.chart,e=i.seriesOptions;t&&e&&(o?t.addSingleSeriesAsDrilldown(i.point,e):t.addSeriesAsDrilldown(i.point,e))})},t.prototype.drilldownCategory=function(t,e){this.getDDPoints(t).forEach(function(i){i&&i.series&&i.series.visible&&i.runDrilldown&&i.runDrilldown(!0,t,e)}),this.chart.applyDrilldown()},t.prototype.getDDPoints=function(i){return this.ddPoints&&this.ddPoints[i]||[]},c.prototype.drillable=function(){var t=this.pos,i=this.label,e=this.axis,o="xAxis"===e.coll&&e.getDDPoints,r=o&&e.getDDPoints(t),n=e.chart.styledMode;o&&(i&&r&&r.length?(i.drillable=!0,i.basicStyles||n||(i.basicStyles=D(i.styles)),i.addClass("highcharts-drilldown-axis-label"),i.removeOnDrillableClick&&g(i.element,"click"),i.removeOnDrillableClick=v(i.element,"click",function(i){i.preventDefault(),e.drilldownCategory(t,i)}),n||i.css(e.chart.options.drilldown.activeAxisLabelStyle)):i&&i.drillable&&i.removeOnDrillableClick&&(n||(i.styles={},i.css(i.basicStyles)),i.removeOnDrillableClick(),i.removeClass("highcharts-drilldown-axis-label")))},v(s,"afterInit",function(){var i=this;return i.drilldown&&!i.unbindDrilldownClick&&(i.unbindDrilldownClick=v(i,"click",O)),i}),v(s,"update",function(i){var t=this,i=i.options||{};i.drilldown&&!t.unbindDrilldownClick?t.unbindDrilldownClick=v(t,"click",O):!i.drilldown&&void 0!==i.drilldown&&t.unbindDrilldownClick&&(t.unbindDrilldownClick=t.unbindDrilldownClick())});var O=function(i){var t=this.series;t.xAxis&&!1===t.chart.options.drilldown.allowPointDrilldown?t.xAxis.drilldownCategory(this.x,i):this.runDrilldown(void 0,void 0,i)};v(d,"afterDrawDataLabels",function(){var o=this.chart.options.drilldown.activeDataLabelStyle,r=this.chart.renderer,n=this.chart.styledMode;this.points.forEach(function(i){var t=i.options.dataLabels,e=S(i.dlOptions,t&&t.style,{});i.drilldown&&i.dataLabel&&("contrast"!==o.color||n||(e.color=r.getContrast(i.color||this.color)),t&&t.color&&(e.color=t.color),i.dataLabel.addClass("highcharts-drilldown-data-label"),n||i.dataLabel.css(o).css(e))},this)});function A(i,t,e,o){i[e?"addClass":"removeClass"]("highcharts-drilldown-point"),o||i.css({cursor:t})}v(d,"afterDrawTracker",function(){var t=this.chart.styledMode;this.points.forEach(function(i){i.drilldown&&i.graphic&&A(i.graphic,"pointer",!0,t)})}),v(s,"afterSetState",function(){var i=this.series.chart.styledMode;this.drilldown&&this.series.halo&&"hover"===this.state?A(this.series.halo,"pointer",!0,i):this.series.halo&&A(this.series.halo,"auto",!1,i)}),v(e,"selection",function(i){!0!==i.resetSelection||!this.drillUpButton||(i=this.options.drilldown&&this.options.drilldown.drillUpButton)&&i.position&&this.drillUpButton.align({x:i.position.x,y:i.position.y,align:i.position.align},!1,i.relativeTo||"plotBox")}),v(e,"drillup",function(){this.resetZoomButton&&(this.resetZoomButton=this.resetZoomButton.destroy())})}),t(i,"masters/modules/drilldown.src.js",[],function(){})});