"use strict";!function(n){"object"==typeof module&&module.exports?module.exports=n.default=n:"function"==typeof define&&define.amd?define("highcharts/modules/pathfinder",["highcharts"],function(t){return n(t),n.Highcharts=t,n}):n("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){t=t?t._modules:{};function n(t,n,i,r){t.hasOwnProperty(n)||(t[n]=r.apply(null,i))}n(t,"Extensions/ArrowSymbols.js",[t["Core/Renderer/SVG/SVGRenderer.js"]],function(t){t=t.prototype.symbols;function e(t,n,i,r){return[["M",t,n+r/2],["L",t+i,n],["L",t,n+r/2],["L",t+i,n+r]]}function a(t,n,i,r){return[["M",t+i,n],["L",t,n+r/2],["L",t+i,n+r],["Z"]]}function n(t,n,i,r){return a(t,n,i/2,r)}return t.arrow=e,t["arrow-filled"]=a,t["arrow-filled-half"]=n,t["arrow-half"]=function(t,n,i,r){return e(t,n,i/2,r)},t["triangle-left"]=a,t["triangle-left-half"]=n,t}),n(t,"Gantt/Connection.js",[t["Core/Globals.js"],t["Core/DefaultOptions.js"],t["Core/Series/Point.js"],t["Core/Utilities.js"]],function(t,n,i,r){var e=n.defaultOptions,s=(r.addEvent,r.defined),a=r.error,n=r.extend,h=r.merge,o=r.objectEach,M=(r.pick,r.splat,t.deg2rad),c=Math.max,x=Math.min;function p(t){var n=t.shapeArgs;return n?{xMin:n.x||0,xMax:(n.x||0)+(n.width||0),yMin:n.y||0,yMax:(n.y||0)+(n.height||0)}:(n=t.graphic&&t.graphic.getBBox())?{xMin:t.plotX-n.width/2,xMax:t.plotX+n.width/2,yMin:t.plotY-n.height/2,yMax:t.plotY+n.height/2}:null}n(e,{connectors:{type:"straight",lineWidth:1,marker:{enabled:!1,align:"center",verticalAlign:"middle",inside:!1,lineWidth:1},startMarker:{symbol:"diamond"},endMarker:{symbol:"arrow-filled"}}});d.prototype.init=function(t,n,i){this.fromPoint=t,this.toPoint=n,this.options=i,this.chart=t.series.chart,this.pathfinder=this.chart.pathfinder},d.prototype.renderPath=function(t,n,i){var r=this.chart,e=r.styledMode,a=r.pathfinder,o=!r.options.chart.forExport&&!1!==i,s=this.graphics&&this.graphics.path;a.group||(a.group=r.renderer.g().addClass("highcharts-pathfinder-group").attr({zIndex:-1}).add(r.seriesGroup)),a.group.translate(r.plotLeft,r.plotTop),s&&s.renderer||(s=r.renderer.path().add(a.group),e||s.attr({opacity:0})),s.attr(n),t={d:t},e||(t.opacity=1),s[o?"animate":"attr"](t,i),this.graphics=this.graphics||{},this.graphics.path=s},d.prototype.addMarker=function(t,n,i){var r,e,a,o=this,s=o.fromPoint.series.chart,h=s.pathfinder,c=s.renderer,x="start"===t?o.fromPoint:o.toPoint,s=x.getPathfinderAnchorPoint(n);n.enabled&&((a="start"===t?i[1]:i[i.length-2])&&"M"===a[0]||"L"===a[0])&&(a={x:a[1],y:a[2]},a=x.getRadiansToVector(a,s),s=x.getMarkerVector(a,n.radius,s),a=-a/M,n.width&&n.height?(r=n.width,e=n.height):r=e=2*n.radius,o.graphics=o.graphics||{},s={x:s.x-r/2,y:s.y-e/2,width:r,height:e,rotation:a,rotationOriginX:s.x,rotationOriginY:s.y},o.graphics[t]?o.graphics[t].animate(s):(o.graphics[t]=c.symbol(n.symbol).addClass("highcharts-point-connecting-path-"+t+"-marker").attr(s).add(h.group),c.styledMode||o.graphics[t].attr({fill:n.color||o.fromPoint.color,stroke:n.lineColor,"stroke-width":n.lineWidth,opacity:0}).animate({opacity:1},x.series.options.animation)))},d.prototype.getPath=function(t){var n=this.pathfinder,i=this.chart,r=n.algorithms[t.type],e=n.chartObstacles;return"function"!=typeof r?(a('"'+t.type+'" is not a Pathfinder algorithm.'),{path:[],obstacles:[]}):(r.requiresObstacles&&!e&&(e=n.chartObstacles=n.getChartObstacles(t),i.options.connectors.algorithmMargin=t.algorithmMargin,n.chartObstacleMetrics=n.getObstacleMetrics(e)),r(this.fromPoint.getPathfinderAnchorPoint(t.startMarker),this.toPoint.getPathfinderAnchorPoint(t.endMarker),h({chartObstacles:e,lineObstacles:n.lineObstacles||[],obstacleMetrics:n.chartObstacleMetrics,hardBounds:{xMin:0,xMax:i.plotWidth,yMin:0,yMax:i.plotHeight},obstacleOptions:{margin:t.algorithmMargin},startDirectionX:n.getAlgorithmStartDirection(t.startMarker)},t)))},d.prototype.render=function(){var t=this,n=t.fromPoint,i=n.series,r=i.chart,e=r.pathfinder,a=h(r.options.connectors,i.options.connectors,n.options.connectors,t.options),o={};r.styledMode||(o.stroke=a.lineColor||n.color,o["stroke-width"]=a.lineWidth,a.dashStyle&&(o.dashstyle=a.dashStyle)),o.class="highcharts-point-connecting-path highcharts-color-"+n.colorIndex,a=h(o,a),s(a.marker.radius)||(a.marker.radius=x(c(Math.ceil((a.algorithmMargin||8)/2)-1,1),5)),n=(r=t.getPath(a)).path,r.obstacles&&(e.lineObstacles=e.lineObstacles||[],e.lineObstacles=e.lineObstacles.concat(r.obstacles)),t.renderPath(n,o,i.options.animation),t.addMarker("start",h(a.marker,a.startMarker),n),t.addMarker("end",h(a.marker,a.endMarker),n)},d.prototype.destroy=function(){this.graphics&&(o(this.graphics,function(t){t.destroy()}),delete this.graphics)},e=d;function d(t,n,i){this.chart=void 0,this.fromPoint=void 0,this.graphics=void 0,this.pathfinder=void 0,this.toPoint=void 0,this.init(t,n,i)}return t.Connection=e,n(i.prototype,{getPathfinderAnchorPoint:function(t){var n,i,r=p(this);switch(t.align){case"right":n="xMax";break;case"left":n="xMin"}switch(t.verticalAlign){case"top":i="yMin";break;case"bottom":i="yMax"}return{x:n?r[n]:(r.xMin+r.xMax)/2,y:i?r[i]:(r.yMin+r.yMax)/2}},getRadiansToVector:function(t,n){var i;return s(n)||(i=p(this))&&(n={x:(i.xMin+i.xMax)/2,y:(i.yMin+i.yMax)/2}),Math.atan2(n.y-t.y,t.x-n.x)},getMarkerVector:function(t,n,i){for(var r,e=2*Math.PI,a=t,o=p(this),s=o.xMax-o.xMin,h=o.yMax-o.yMin,c=Math.atan2(h,s),x=!1,M=s/2,d=h/2,l=o.xMin+M,y=o.yMin+d,t={x:l,y:y},s=1,o=1;a<-Math.PI;)a+=e;for(;a>Math.PI;)a-=e;return r=Math.tan(a),-c<a&&a<=c?(o=-1,x=!0):c<a&&a<=Math.PI-c?o=-1:a>Math.PI-c||a<=-(Math.PI-c)?(s=-1,x=!0):s=-1,x?(t.x+=s*M,t.y+=o*M*r):(t.x+=s*(h/(2*r)),t.y+=o*d),i.x!==l&&(t.x=i.x),i.y!==y&&(t.y=i.y),{x:t.x+n*Math.cos(a),y:t.y-n*Math.sin(a)}}}),e}),n(t,"Gantt/PathfinderAlgorithms.js",[t["Core/Utilities.js"]],function(t){t.extend;var P=t.pick,k=Math.min,O=Math.max,w=Math.abs;function C(t,n,i){for(var r,e,a=i||0,o=t.length-1,s=n-1e-7;a<=o;)if(0<(e=s-t[r=o+a>>1].xMin))a=1+r;else{if(!(e<0))return r;o=r-1}return 0<a?a-1:0}function j(t,n){for(var i,r,e=C(t,n.x+1)+1;e--;)if(t[e].xMax>=n.x&&(i=t[e],(r=n).x<=i.xMax&&r.x>=i.xMin&&r.y<=i.yMax&&r.y>=i.yMin))return e;return-1}function A(t){var n=[];if(t.length){n.push(["M",t[0].start.x,t[0].start.y]);for(var i=0;i<t.length;++i)n.push(["L",t[i].end.x,t[i].end.y])}return n}function I(t,n){t.yMin=O(t.yMin,n.yMin),t.yMax=k(t.yMax,n.yMax),t.xMin=O(t.xMin,n.xMin),t.xMax=k(t.xMax,n.xMax)}function n(t,n,i){var r,e,a=[],o=P(i.startDirectionX,w(n.x-t.x)>w(n.y-t.y))?"x":"y",s=i.chartObstacles,h=j(s,t);function c(t,n,i,r,e){t={x:t.x,y:t.y};return t[n]=i[r||n]+(e||0),t}function x(t,n,i){var r=w(n[i]-t[i+"Min"])>w(n[i]-t[i+"Max"]);return c(n,i,t,i+(r?"Max":"Min"),r?1:-1)}return i=-1<(i=j(s,n))?(r={start:e=x(s[i],n,o),end:n},e):n,-1<h&&(e=x(h=s[h],t,o),a.push({start:t,end:e}),e[o]>=t[o]==e[o]>=i[o]&&(n=t[o="y"===o?"x":"y"]<n[o],a.push({start:e,end:c(e,o,h,o+(n?"Max":"Min"),n?1:-1)}),o="y"===o?"x":"y")),e=c(t=a.length?a[a.length-1].end:t,o,i),a.push({start:t,end:e}),i=c(e,o="y"===o?"x":"y",i),a.push({start:e,end:i}),a.push(r),{path:A(a),obstacles:a}}t=function(t,n,M){var i,r,e,a,o,s,h=P(M.startDirectionX,w(n.x-t.x)>w(n.y-t.y)),c=h?"x":"y",x=[],d=!1,l=M.obstacleMetrics,y=k(t.x,n.x)-l.maxWidth-10,p=O(t.x,n.x)+l.maxWidth+10,f=k(t.y,n.y)-l.maxHeight-10,u=O(t.y,n.y)+l.maxHeight+10,g=M.chartObstacles,l=C(g,y),m=C(g,p);function v(t,n,i){for(var r,e,a=t.x<n.x?1:-1,o=t.x<n.x?(r=t,n):(r=n,t),s=t.y<n.y?(e=t,n):(e=n,t),h=a<0?k(C(g,o.x),g.length-1):0;g[h]&&(0<a&&g[h].xMin<=o.x||a<0&&g[h].xMax>=r.x);){if(g[h].xMin<=o.x&&g[h].xMax>=r.x&&g[h].yMin<=s.y&&g[h].yMax>=e.y)return i?{y:t.y,x:t.x<n.x?g[h].xMin-1:g[h].xMax+1,obstacle:g[h]}:{x:t.x,y:t.y<n.y?g[h].yMin-1:g[h].yMax+1,obstacle:g[h]};h+=a}return n}function b(t,n,i,r,e){var a=e.soft,o=e.hard,s=r?"x":"y",h={x:n.x,y:n.y},c={x:n.x,y:n.y},x=t[s+"Max"]>=a[s+"Max"],M=t[s+"Min"]<=a[s+"Min"],d=t[s+"Max"]>=o[s+"Max"],e=t[s+"Min"]<=o[s+"Min"],a=w(t[s+"Min"]-n[s]),o=w(t[s+"Max"]-n[s]),a=w(a-o)<10?n[s]<i[s]:o<a;return c[s]=t[s+"Min"],h[s]=t[s+"Max"],c=v(n,c,r)[s]!==c[s],s=v(n,h,r)[s]!==h[s],a=c?!s||a:!s&&a,a=M?!x||a:!x&&a,a=e?!d||a:!d&&a}for(-1<(m=j(g=g.slice(l,m+1),n))&&(e=g[m],a=n,o=t,s=k(e.xMax-a.x,a.x-e.xMin)<k(e.yMax-a.y,a.y-e.yMin),o=b(e,a,o,s,{soft:M.hardBounds,hard:M.hardBounds}),r=s?{y:a.y,x:e[o?"xMax":"xMin"]+(o?1:-1)}:{x:a.x,y:e[o?"yMax":"yMin"]+(o?1:-1)},x.push({end:n,start:r}),n=r);-1<(m=j(g,n));)i=n[c]-t[c]<0,(r={x:n.x,y:n.y})[c]=g[m][i?c+"Max":c+"Min"]+(i?1:-1),x.push({end:n,start:r}),n=r;return{path:A(h=(h=function t(n,i,r){if(n.x===i.x&&n.y===i.y)return[];var e,a,o,s=r?"x":"y",h=M.obstacleOptions.margin,c={soft:{xMin:y,xMax:p,yMin:f,yMax:u},hard:M.hardBounds},x=j(g,n);return-1<x?(e=b(x=g[x],n,i,r,c),I(x,M.hardBounds),o=r?{y:n.y,x:x[e?"xMax":"xMin"]+(e?1:-1)}:{x:n.x,y:x[e?"yMax":"yMin"]+(e?1:-1)},-1<(a=j(g,o))&&(I(a=g[a],M.hardBounds),o[s]=e?O(x[s+"Max"]-h+1,(a[s+"Min"]+x[s+"Max"])/2):k(x[s+"Min"]+h-1,(a[s+"Max"]+x[s+"Min"])/2),d=n.x===o.x&&n.y===o.y&&(d&&(o[s]=e?O(x[s+"Max"],a[s+"Max"])+1:k(x[s+"Min"],a[s+"Min"])-1),!d)),o=[{start:n,end:o}]):(o=[{start:n,end:{x:(n=v(n,{x:(r?i:n).x,y:(r?n:i).y},r)).x,y:n.y}}],n[r?"x":"y"]!==i[r?"x":"y"]&&(e=b(n.obstacle,n,i,!r,c),I(n.obstacle,M.hardBounds),e={x:r?n.x:n.obstacle[e?"xMax":"xMin"]+(e?1:-1),y:r?n.obstacle[e?"yMax":"yMin"]+(e?1:-1):n.y},o=o.concat(t({x:n.x,y:n.y},e,r=!r)))),o=o.concat(t(o[o.length-1].end,i,!r))}(t,n,h)).concat(x.reverse())),obstacles:h}};return t.requiresObstacles=n.requiresObstacles=!0,{fastAvoid:t,straight:function(t,n){return{path:[["M",t.x,t.y],["L",n.x,n.y]],obstacles:[{start:t,end:n}]}},simpleConnect:n}}),n(t,"Gantt/Pathfinder.js",[t["Gantt/Connection.js"],t["Core/Chart/Chart.js"],t["Core/Globals.js"],t["Core/DefaultOptions.js"],t["Core/Series/Point.js"],t["Core/Utilities.js"],t["Gantt/PathfinderAlgorithms.js"]],function(c,t,n,i,x,r,e){var a=i.defaultOptions,o=r.addEvent,M=r.defined,s=r.error,i=r.extend,h=r.merge,d=(r.objectEach,r.pick),l=r.splat,y=(n.deg2rad,Math.max),p=Math.min;function f(t){var n=t.shapeArgs;return n?{xMin:n.x||0,xMax:(n.x||0)+(n.width||0),yMin:n.y||0,yMax:(n.y||0)+(n.height||0)}:(n=t.graphic&&t.graphic.getBBox())?{xMin:t.plotX-n.width/2,xMax:t.plotX+n.width/2,yMin:t.plotY-n.height/2,yMax:t.plotY+n.height/2}:null}i(a,{connectors:{type:"straight",lineWidth:1,marker:{enabled:!1,align:"center",verticalAlign:"middle",inside:!1,lineWidth:1},startMarker:{symbol:"diamond"},endMarker:{symbol:"arrow-filled"}}});var u=(g.prototype.init=function(t){this.chart=t,this.connections=[],o(t,"redraw",function(){this.pathfinder.update()})},g.prototype.update=function(t){var r=this.chart,e=this,n=e.connections;e.connections=[],r.series.forEach(function(t){t.visible&&!t.options.isInternal&&t.points.forEach(function(n){var t=n.options;t&&t.dependency&&(t.connect=t.dependency);var i,t=n.options&&n.options.connect&&l(n.options.connect);n.visible&&!1!==n.isInside&&t&&t.forEach(function(t){(i=r.get("string"==typeof t?t:t.to))instanceof x&&i.series.visible&&i.visible&&!1!==i.isInside&&e.connections.push(new c(n,i,"string"==typeof t?{}:t))})})});for(var i=0,a=void 0,o=void 0,s=n.length,h=e.connections.length;i<s;++i){for(o=!1,a=0;a<h;++a)if(n[i].fromPoint===e.connections[a].fromPoint&&n[i].toPoint===e.connections[a].toPoint){e.connections[a].graphics=n[i].graphics,o=!0;break}o||n[i].destroy()}delete this.chartObstacles,delete this.lineObstacles,e.renderConnections(t)},g.prototype.renderConnections=function(t){t?this.chart.series.forEach(function(n){function t(){var t=n.chart.pathfinder;(t&&t.connections||[]).forEach(function(t){t.fromPoint&&t.fromPoint.series===n&&t.render()}),n.pathfinderRemoveRenderEvent&&(n.pathfinderRemoveRenderEvent(),delete n.pathfinderRemoveRenderEvent)}!1===n.options.animation?t():n.pathfinderRemoveRenderEvent=o(n,"afterAnimate",t)}):this.connections.forEach(function(t){t.render()})},g.prototype.getChartObstacles=function(t){for(var n,i=[],r=this.chart.series,e=d(t.algorithmMargin,0),a=0,o=r.length;a<o;++a)if(r[a].visible&&!r[a].options.isInternal)for(var s,h,c=0,x=r[a].points.length;c<x;++c)(h=r[a].points[c]).visible&&(s=f(h))&&i.push({xMin:s.xMin-e,xMax:s.xMax+e,yMin:s.yMin-e,yMax:s.yMax+e});return i=i.sort(function(t,n){return t.xMin-n.xMin}),M(t.algorithmMargin)||(n=t.algorithmMargin=function(t){for(var n,i,r=t.length,e=0,a=[],s=function(t,n,i){var r=d(i,10),e=t.yMax+r>n.yMin-r&&t.yMin-r<n.yMax+r,a=t.xMax+r>n.xMin-r&&t.xMin-r<n.xMax+r,o=e?t.xMin>n.xMax?t.xMin-n.xMax:n.xMin-t.xMax:1/0,i=a?t.yMin>n.yMax?t.yMin-n.yMax:n.yMin-t.yMax:1/0;return a&&e?r?s(t,n,Math.floor(r/2)):1/0:p(o,i)};e<r;++e)for(n=e+1;n<r;++n)(i=s(t[e],t[n]))<80&&a.push(i);return a.push(80),y(Math.floor(a.sort(function(t,n){return t-n})[Math.floor(a.length/10)]/2-1),1)}(i),i.forEach(function(t){t.xMin-=n,t.xMax+=n,t.yMin-=n,t.yMax+=n})),i},g.prototype.getObstacleMetrics=function(t){for(var n,i=0,r=0,e=t.length;e--;)i<(n=t[e].xMax-t[e].xMin)&&(i=n),r<(n=t[e].yMax-t[e].yMin)&&(r=n);return{maxHeight:r,maxWidth:i}},g.prototype.getAlgorithmStartDirection=function(t){var n="left"!==t.align&&"right"!==t.align,t="top"!==t.verticalAlign&&"bottom"!==t.verticalAlign;return n?t&&void 0:t||void 0},g);function g(t){this.chart=void 0,this.chartObstacles=void 0,this.chartObstacleMetrics=void 0,this.connections=void 0,this.group=void 0,this.lineObstacles=void 0,this.init(t)}return u.prototype.algorithms=e,n.Pathfinder=u,i(x.prototype,{getPathfinderAnchorPoint:function(t){var n,i,r=f(this);switch(t.align){case"right":n="xMax";break;case"left":n="xMin"}switch(t.verticalAlign){case"top":i="yMin";break;case"bottom":i="yMax"}return{x:n?r[n]:(r.xMin+r.xMax)/2,y:i?r[i]:(r.yMin+r.yMax)/2}},getRadiansToVector:function(t,n){var i;return M(n)||(i=f(this))&&(n={x:(i.xMin+i.xMax)/2,y:(i.yMin+i.yMax)/2}),Math.atan2(n.y-t.y,t.x-n.x)},getMarkerVector:function(t,n,i){for(var r,e=2*Math.PI,a=t,o=f(this),s=o.xMax-o.xMin,h=o.yMax-o.yMin,c=Math.atan2(h,s),x=!1,M=s/2,d=h/2,l=o.xMin+M,y=o.yMin+d,t={x:l,y:y},s=1,o=1;a<-Math.PI;)a+=e;for(;a>Math.PI;)a-=e;return r=Math.tan(a),-c<a&&a<=c?(o=-1,x=!0):c<a&&a<=Math.PI-c?o=-1:a>Math.PI-c||a<=-(Math.PI-c)?(s=-1,x=!0):s=-1,x?(t.x+=s*M,t.y+=o*M*r):(t.x+=s*(h/(2*r)),t.y+=o*d),i.x!==l&&(t.x=i.x),i.y!==y&&(t.y=i.y),{x:t.x+n*Math.cos(a),y:t.y-n*Math.sin(a)}}}),t.prototype.callbacks.push(function(t){!1!==t.options.connectors.enabled&&(((t=t).options.pathfinder||t.series.reduce(function(t,n){return n.options&&h(!0,n.options.connectors=n.options.connectors||{},n.options.pathfinder),t||n.options&&n.options.pathfinder},!1))&&(h(!0,t.options.connectors=t.options.connectors||{},t.options.pathfinder),s('WARNING: Pathfinder options have been renamed. Use "chart.connectors" or "series.connectors" instead.')),this.pathfinder=new u(this),this.pathfinder.update(!0))}),u}),n(t,"masters/modules/pathfinder.src.js",[],function(){})});